<!doctype html>
<html lang="es" itemscope itemtype="http://schema.org/Person">
<head>
            <meta charset="utf-8">
        <!-- Site Meta Data -->
        <title>Contar palabras de un texto usando Spark con PySpark</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Ernesto Crespo">

        <link rel="shortcut icon" href="">

        <!-- schema.org -->
        <meta itemprop="name" content="Página de Seraph">
        <meta itemprop="image" content="">
        <meta itemprop="description" content="">

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
        <!-- Style Meta Data -->
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/style.css" type="text/css"/>
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/pygments.css" type="text/css"/>

        <!-- Feed Meta Data -->
            <link href="https://ecrespo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="Página de Seraph ATOM Feed"/>

        <!-- Twitter Feed -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="">
        <meta name="twitter:image" content="">

    <meta name="twitter:creator" content="">
    <meta name="twitter:url" content="https://ecrespo.github.io/contar-palabras-de-un-texto-usando-spark-con-pyspark.html">
    <meta name="twitter:title" content="Página de Seraph ~ Contar palabras de un texto usando Spark con PySpark">
    <meta name="twitter:description" content="En el artículo anterior se explicó el procedimiento de instalación de Spark usando Docker. En este artículo se usará un texto tomado de la página de la ONU, de ahí se extrae las líneas y se cuentan las palabras. A continuación el texto que se va a utilizar (lo pueden …">

    <!-- Facebook Meta Data -->
    <meta property="og:title" content="Página de Seraph ~ Contar palabras de un texto usando Spark con PySpark"/>
    <meta property="og:description" content="En el artículo anterior se explicó el procedimiento de instalación de Spark usando Docker. En este artículo se usará un texto tomado de la página de la ONU, de ahí se extrae las líneas y se cuentan las palabras. A continuación el texto que se va a utilizar (lo pueden …"/>
    <meta property="og:image" content=""/>
</head>

<body>
<!-- Sidebar -->
<aside>
    <!--<center><a href="https://ecrespo.github.io"><img id="avatar" src=""></a></center>-->
    <h1>Página de Seraph</h1>
    <br>


    <nav class="nav">
        <ul class="list-bare">

                <li><a class="nav__link" href="/archives.html">Archives</a></li>
                <li><a class="nav__link" href="/categories.html">Categories</a></li>
                <li><a class="nav__link" href="/tags.html">Tags</a></li>

                <li><a class="nav__link" href="https://ecrespo.github.io/pages/About.html">Acerca</a></li>
                <li><a class="nav__link" href="https://ecrespo.github.io/pages/Contacto.html">Contacto</a></li>

        </ul>
    </nav>

    <p class="social">
                <a href="https://medium.com/@_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/medium.png"></a>
                <a href="http://ve.linkedin.com/in/ernestocrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/linkedin.png"></a>
                <a href="https://github.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/github.png"></a>
                <a href="https://google.com/+ErnestoCrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/google.png"></a>
                <a href="https://twitter.com/_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/twitter.png"></a>
                <a href="https://www.facebook.com/ernesto.crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/facebook.png"></a>
                <a href="https://gitlab.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/gitlab.png"></a>
                <a href="https://soundcloud.com/ernesto-crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/soundcloud.png"></a>
                <a href="//www.seraph.to/feeds/all.atom.xml" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
            <a href="https://ecrespo.github.io/feeds/all.atom.xml" rel="alternate">
                <img src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
    </p>

        <h2>Categories</h2>
        <ul class="navbar">
                <li><a
                        href="https://ecrespo.github.io/category/accesibilidad.html">Accesibilidad</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncio.html">Anuncio</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncios.html">Anuncios</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/aplicacion-android.html">Aplicación Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/asterisk-debian-linux.html">Asterisk, Debian, Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla.html">Charla</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla-python.html">Charla Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-linux-mac-book.html">Debian, Linux, Mac Book</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-maemo-nokia-n810-python.html">Debian, maemo, Nokia N810, Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/demostracion-aplicacion-para-android.html">Demostración Aplicación para Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/desarrollomovil.html">Desarrollo,Movil</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/evento.html">Evento</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/general.html">General</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linux.html">Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdebian.html">Linux,Debian</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdesarrollo.html">Linux,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxempaquetado.html">Linux,Empaquetado</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxofimaticadesarrollo.html">Linux,Ofimatica,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/movil-nokia.html">Movil, Nokia</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810.html">Nokia N810</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810-debian-maemo.html">Nokia N810 Debian Maemo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/posts.html">posts</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/resumen-2010.html">Resumen 2010</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/sistemas-operativos.html">Sistemas Operativos</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial.html">Tutorial</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-android.html">Tutorial Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-arduino.html">Tutorial de Arduino</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-data-science.html">Tutorial de Data Science</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-docker.html">Tutorial de Docker</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-integracion-continua.html">Tutorial de integración continua</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-linux.html">Tutorial de Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python.html">Tutorial de Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-en-android.html">Tutorial de Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-linux.html">Tutorial de Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-pyqt.html">Tutorial de Python y PyQt</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-debian-bsd-y-python.html">Tutorial Debian BSD y Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux.html">Tutorial Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux-y-python.html">Tutorial Linux y Python</a></li>
                <li class="active"><a
                        href="https://ecrespo.github.io/category/tutorial-python.html">Tutorial Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-en-android.html">Tutorial Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-y-linux.html">Tutorial Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorialdesarrollo.html">Tutorial,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/xml-rpcpython.html">XML-RPC,Python</a></li>
        </ul>


</aside>

<!-- Content -->
<article>
    <section id="content">
        <article>
            <h2 class="post_title post_detail"><a href="https://ecrespo.github.io/contar-palabras-de-un-texto-usando-spark-con-pyspark.html" rel="bookmark"
                                                  title="Permalink to Contar palabras de un texto usando Spark con PySpark">Contar palabras de un texto usando Spark con PySpark</a></h2>
            <div class="entry-content blog-post">
                <p>En el artículo anterior se explicó el <a href="https://www.seraph.to/como-correr-apache-spark-desde-una-imagen-docker.html">procedimiento de instalación de Spark usando Docker</a>.  En este artículo se usará un texto tomado de la página de la ONU, de ahí se extrae las líneas y se cuentan las palabras.</p>
<p>A continuación el texto que se va a utilizar (lo pueden bajar desde el repositorio <a href="https://gitlab.com/mangoosta/articulos-cienciasdedatos/blob/master/datos/declaracion_onut.text">gitlab</a>):</p>
<div class="highlight"><pre><span></span><code><span class="mi">1942</span><span class="o">:</span> <span class="n">La</span> <span class="n">Declaración</span> <span class="n">de</span> <span class="n">las</span> <span class="n">Naciones</span> <span class="n">Unidas</span>
<span class="n">Representantes</span> <span class="n">de</span> <span class="mi">26</span> <span class="n">Estados</span> <span class="n">que</span> <span class="n">lucharon</span> <span class="n">contra</span> <span class="n">las</span> <span class="n">potencias</span> <span class="n">del</span> <span class="n">Eje</span> <span class="n">Roma</span><span class="o">-</span><span class="n">Berlín</span><span class="o">-</span><span class="n">Tokio</span> <span class="n">manifestaron</span> <span class="n">su</span> <span class="n">apoyo</span> <span class="n">a</span> <span class="n">la</span> <span class="n">Carta</span> <span class="n">del</span> <span class="n">Atlántico</span> <span class="n">mediante</span> <span class="n">su</span> <span class="n">firma</span> <span class="n">de</span> <span class="n">la</span> <span class="err">«</span> <span class="n">Declaración</span> <span class="n">de</span> <span class="n">las</span> <span class="n">Naciones</span> <span class="n">Unidas</span> <span class="err">»</span><span class="o">.</span> <span class="n">En</span> <span class="n">este</span> <span class="n">trascendental</span> <span class="n">documento</span><span class="o">,</span> <span class="n">los</span> <span class="n">signatarios</span> <span class="n">se</span> <span class="n">comprometían</span> <span class="n">a</span> <span class="n">poner</span> <span class="n">su</span> <span class="n">máximo</span> <span class="n">empeño</span> <span class="n">en</span> <span class="n">la</span> <span class="n">guerra</span> <span class="n">y</span> <span class="n">a</span> <span class="n">no</span> <span class="n">firmar</span> <span class="n">una</span> <span class="n">paz</span> <span class="n">por</span> <span class="n">separado</span><span class="o">.</span> 


<span class="n">Declaración</span> <span class="n">de</span> <span class="n">las</span> <span class="n">Naciones</span> <span class="n">Unidas</span> <span class="n">prometiendo</span> <span class="s2">&quot;emplear todos sus recursos, militares o económicos&quot;</span> <span class="n">en</span> <span class="s2">&quot;la lucha por la victoria sobre el hitlerismo&quot;</span><span class="o">.</span>
<span class="n">El</span> <span class="n">día</span> <span class="n">de</span> <span class="n">año</span> <span class="n">nuevo</span> <span class="n">de</span> <span class="mi">1942</span><span class="o">,</span> <span class="n">el</span> <span class="n">señor</span> <span class="n">presidente</span> <span class="n">Roosevelt</span> <span class="n">y</span> <span class="n">los</span> <span class="n">señores</span> <span class="n">Winston</span> <span class="n">Churchill</span><span class="o">,</span> <span class="n">Maxim</span> <span class="n">Litvinov</span><span class="o">,</span> <span class="n">de</span> <span class="n">la</span> <span class="n">Unión</span> <span class="n">Soviética</span><span class="o">,</span> <span class="n">y</span> <span class="n">T</span><span class="o">.</span> <span class="n">V</span><span class="o">.</span> <span class="n">Soong</span><span class="o">,</span> <span class="n">de</span> <span class="n">China</span><span class="o">,</span> <span class="n">firmaron</span> <span class="n">un</span> <span class="n">breve</span> <span class="n">documento</span> <span class="n">que</span> <span class="n">luego</span> <span class="n">se</span> <span class="n">conocería</span> <span class="n">como</span> <span class="n">la</span> <span class="n">Declaración</span> <span class="n">de</span> <span class="n">las</span> <span class="n">Naciones</span> <span class="n">Unidas</span><span class="o">.</span> <span class="n">Al</span> <span class="n">día</span> <span class="n">siguiente</span> <span class="n">se</span> <span class="n">sumaron</span> <span class="n">los</span> <span class="n">representantes</span> <span class="n">de</span> <span class="n">otras</span> <span class="mi">22</span> <span class="n">naciones</span> <span class="n">más</span><span class="o">.</span> <span class="n">En</span> <span class="n">este</span> <span class="n">trascendental</span> <span class="n">documento</span><span class="o">,</span> <span class="n">los</span> <span class="n">signatarios</span> <span class="n">se</span> <span class="n">comprometían</span> <span class="n">a</span> <span class="n">poner</span> <span class="n">su</span> <span class="n">máximo</span> <span class="n">empeño</span> <span class="n">en</span> <span class="n">la</span> <span class="n">guerra</span> <span class="n">y</span> <span class="n">a</span> <span class="n">no</span> <span class="n">firmar</span> <span class="n">una</span> <span class="n">paz</span> <span class="n">por</span> <span class="n">separado</span><span class="o">.</span>

<span class="n">La</span> <span class="n">Declaración</span> <span class="n">de</span> <span class="n">las</span> <span class="n">Naciones</span> <span class="n">Unidas</span>
<span class="n">La</span> <span class="n">alianza</span> <span class="n">completa</span> <span class="n">a</span> <span class="n">que</span> <span class="n">se</span> <span class="n">llegó</span> <span class="n">en</span> <span class="n">esta</span> <span class="n">forma</span> <span class="n">concordaba</span> <span class="n">con</span> <span class="n">los</span> <span class="n">principios</span> <span class="n">enunciados</span> <span class="n">en</span> <span class="n">la</span> <span class="n">Carta</span> <span class="n">del</span> <span class="n">Atlántico</span><span class="o">,</span> <span class="n">y</span> <span class="n">la</span> <span class="n">primera</span> <span class="n">cláusula</span> <span class="n">de</span> <span class="n">la</span> <span class="n">declaración</span> <span class="n">de</span> <span class="n">las</span> <span class="n">Naciones</span> <span class="n">Unidas</span> <span class="n">reza</span> <span class="n">que</span> <span class="n">los</span> <span class="n">países</span> <span class="n">signatarios</span> 

<span class="err">«</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">han</span> <span class="n">suscrito</span> <span class="n">un</span> <span class="n">programa</span> <span class="n">común</span> <span class="n">de</span> <span class="n">propósitos</span> <span class="n">y</span> <span class="n">principios</span> <span class="n">enunciados</span> <span class="n">en</span> <span class="n">la</span> <span class="n">declaración</span> <span class="n">conjunta</span> <span class="n">del</span> <span class="n">presidente</span> <span class="n">de</span> <span class="n">los</span> <span class="n">Estados</span> <span class="n">Unidos</span> <span class="n">de</span> <span class="n">América</span> <span class="n">y</span> <span class="n">del</span> <span class="n">primer</span> <span class="n">ministro</span> <span class="n">del</span> <span class="n">Reino</span> <span class="n">Unido</span> <span class="n">de</span> <span class="n">la</span> <span class="n">Gran</span> <span class="n">Bretaña</span> <span class="n">e</span> <span class="n">Irlanda</span> <span class="n">del</span> <span class="n">Norte</span><span class="o">,</span> <span class="n">fechada</span> <span class="n">el</span> <span class="mi">14</span> <span class="n">de</span> <span class="n">agosto</span> <span class="n">de</span> <span class="mi">1941</span><span class="o">,</span> <span class="n">y</span> <span class="n">conocida</span> <span class="n">como</span> <span class="n">la</span> <span class="n">Carta</span> <span class="n">del</span> <span class="n">Atlántico</span><span class="o">.</span> <span class="err">»</span><span class="o">.</span>

<span class="n">Cuando</span> <span class="n">tres</span> <span class="n">años</span> <span class="n">después</span> <span class="n">se</span> <span class="n">iniciaban</span> <span class="n">los</span> <span class="n">preparativos</span> <span class="n">para</span> <span class="n">la</span> <span class="n">conferencia</span> <span class="n">de</span> <span class="n">San</span> <span class="n">Francisco</span><span class="o">,</span> <span class="err">ú</span><span class="n">nicamente</span> <span class="n">se</span> <span class="n">invitó</span> <span class="n">a</span> <span class="n">participar</span> <span class="n">a</span> <span class="n">aquellos</span> <span class="n">estados</span> <span class="n">que</span><span class="o">,</span> <span class="n">en</span> <span class="n">marzo</span> <span class="n">de</span> <span class="mi">1945</span><span class="o">,</span> <span class="n">habían</span> <span class="n">declarado</span> <span class="n">la</span> <span class="n">guerra</span> <span class="n">a</span> <span class="n">Alemania</span> <span class="n">y</span> <span class="n">al</span> <span class="n">Japón</span> <span class="n">y</span> <span class="n">que</span> <span class="n">habían</span> <span class="n">firmado</span> <span class="n">la</span> <span class="n">Declaración</span> <span class="n">de</span> <span class="n">las</span> <span class="n">Naciones</span> <span class="n">Unidas</span><span class="o">.</span>

<span class="n">Signatarios</span> <span class="n">Originales</span> <span class="n">de</span> <span class="n">la</span> <span class="n">Declaración</span> <span class="n">de</span> <span class="n">la</span> <span class="n">ONU</span>
<span class="n">Los</span> <span class="mi">26</span> <span class="n">signatarios</span> <span class="n">originales</span> <span class="n">fueron</span><span class="o">:</span> <span class="n">Los</span> <span class="n">Estados</span> <span class="n">Unidos</span> <span class="n">de</span> <span class="n">América</span><span class="o">,</span> <span class="n">el</span> <span class="n">Reino</span> <span class="n">Unido</span> <span class="n">de</span> <span class="n">la</span> <span class="n">Gran</span> <span class="n">Bretaña</span> <span class="n">e</span> <span class="n">Irlanda</span> <span class="n">del</span> <span class="n">Norte</span><span class="o">,</span> <span class="n">la</span> <span class="n">Unión</span> <span class="n">de</span> <span class="n">Repúblicas</span> <span class="n">Socialistas</span> <span class="n">Soviéticas</span><span class="o">,</span> <span class="n">China</span><span class="o">,</span> <span class="n">Australia</span><span class="o">,</span> <span class="n">Bélgica</span><span class="o">,</span> <span class="n">Canadá</span><span class="o">,</span> <span class="n">Costa</span> <span class="n">Rica</span><span class="o">,</span> <span class="n">Checoeslovaquia</span><span class="o">,</span> <span class="n">El</span> <span class="n">Salvador</span><span class="o">,</span> <span class="n">Grecia</span><span class="o">,</span> <span class="n">Guatemala</span><span class="o">,</span> <span class="n">Haití</span><span class="o">,</span> <span class="n">Honduras</span><span class="o">,</span> <span class="n">India</span><span class="o">,</span> <span class="n">Luxemburgo</span><span class="o">,</span> <span class="n">Nicaragua</span><span class="o">,</span> <span class="n">Noruega</span><span class="o">,</span> <span class="n">Nueva</span> <span class="n">Zelandia</span><span class="o">,</span> <span class="n">Países</span> <span class="n">Bajos</span><span class="o">,</span> <span class="n">Panamá</span><span class="o">,</span> <span class="n">Polonia</span><span class="o">,</span> <span class="n">República</span> <span class="n">Dominicana</span><span class="o">,</span> <span class="n">Unión</span> <span class="n">Sudafricana</span><span class="o">,</span> <span class="n">Yugoeslavia</span> <span class="o">.</span>

<span class="n">Los</span> <span class="n">firmantes</span> <span class="n">posteriores</span>
<span class="n">Más</span> <span class="n">tarde</span> <span class="n">se</span> <span class="n">adhirieron</span> <span class="n">a</span> <span class="n">la</span> <span class="n">Declaración</span> <span class="n">los</span> <span class="n">siguientes</span> <span class="n">países</span> <span class="o">(</span><span class="n">en</span> <span class="n">el</span> <span class="n">orden</span> <span class="n">de</span> <span class="n">las</span> <span class="n">firmas</span><span class="o">):</span> <span class="n">México</span><span class="o">,</span> <span class="n">Colombia</span><span class="o">,</span> <span class="n">Iraq</span><span class="o">,</span> <span class="n">Irán</span><span class="o">,</span> <span class="n">Liberia</span><span class="o">,</span> <span class="n">Paraguay</span><span class="o">,</span> <span class="n">Chile</span><span class="o">,</span> <span class="n">Uruguay</span><span class="o">,</span> <span class="n">Egipto</span><span class="o">,</span> <span class="n">Siria</span><span class="o">,</span> <span class="n">Francia</span><span class="o">,</span> <span class="n">Filipinas</span><span class="o">,</span> <span class="n">Brasil</span><span class="o">,</span> <span class="n">Bolivia</span><span class="o">,</span> <span class="n">Etiopía</span><span class="o">,</span> <span class="n">Ecuador</span><span class="o">,</span> <span class="n">Perú</span><span class="o">,</span> <span class="n">Venezuela</span><span class="o">,</span> <span class="n">Turquía</span><span class="o">,</span> <span class="n">Arabia</span> <span class="n">Saudita</span><span class="o">,</span> <span class="n">Líbano</span><span class="o">.</span>
</code></pre></div>

<p>A continuación se muestra la ejecución del código (si quieren bajar el archivo <code>jupyter notebook</code> lo pueden descargar desde <a href="https://gitlab.com/mangoosta/articulos-cienciasdedatos/blob/master/spark1.ipynb">gitlab</a>):</p>
<p>In [1]:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se importa SparkContext y SparkConf</span>
<span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkContext</span><span class="p">,</span> <span class="n">SparkConf</span>
</code></pre></div>

<p>In [2]:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se crea la instancia de la configuración con el nombre de la aplicación contador</span>
<span class="n">conf1</span> <span class="o">=</span> <span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">setAppName</span><span class="p">(</span><span class="s2">&quot;contador&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="s2">&quot;local[3]&quot;</span><span class="p">)</span>
</code></pre></div>

<p>In [3]:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se crea el contexto pasando la instancia de la configuración</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">SparkContext</span><span class="p">(</span><span class="n">conf</span> <span class="o">=</span> <span class="n">conf1</span><span class="p">)</span>
</code></pre></div>

<p>In [4]:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se extrae las líneas del texto </span>
<span class="n">lineas</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">&quot;data/declaracion_onut.text&quot;</span><span class="p">)</span>
</code></pre></div>

<p>In [6]:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se extrae las palabras del texto y se cuentan</span>
<span class="n">contarPalabras</span> <span class="o">=</span> <span class="n">lineas</span><span class="o">.</span><span class="n">flatMap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">linea</span><span class="p">:</span> <span class="n">linea</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span><span class="o">.</span><span class="n">countByValue</span><span class="p">()</span>
</code></pre></div>

<p>In [7]:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se muestra las palabras con la cantidad de veces que tiene su aparición</span>
<span class="k">for</span> <span class="n">palabra</span><span class="p">,</span> <span class="n">contador</span> <span class="ow">in</span> <span class="n">contarPalabras</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">palabra</span><span class="p">,</span> <span class="n">contador</span><span class="p">))</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c">1942: : 1</span>
<span class="err">La : 3</span>
<span class="err">Declaración : 8</span>
<span class="err">de : 29</span>
<span class="err">las : 9</span>
<span class="err">Naciones : 7</span>
<span class="err">Unidas : 5</span>
<span class="err">Representantes : 1</span>
<span class="err">26 : 2</span>
<span class="err">Estados : 3</span>
<span class="err">que : 5</span>
<span class="err">lucharon : 1</span>
<span class="err">contra : 1</span>
<span class="err">potencias : 1</span>
<span class="err">del : 9</span>
<span class="err">Eje : 1</span>
<span class="err">Roma-Berlín-Tokio : 1</span>
<span class="err">manifestaron : 1</span>
<span class="err">su : 4</span>
<span class="err">apoyo : 1</span>
<span class="err">a : 10</span>
<span class="err">la : 21</span>
<span class="err">Carta : 3</span>
<span class="err">Atlántico : 1</span>
<span class="err">mediante : 1</span>
<span class="err">firma : 1</span>
<span class="err">« : 2</span>
<span class="err">». : 2</span>
<span class="err">En : 2</span>
<span class="err">este : 2</span>
<span class="err">trascendental : 2</span>
<span class="err">documento, : 2</span>
<span class="err">los : 9</span>
<span class="err">signatarios : 4</span>
<span class="err">se : 8</span>
<span class="err">comprometían : 2</span>
<span class="err">poner : 2</span>
<span class="err">máximo : 2</span>
<span class="err">empeño : 2</span>
<span class="err">en : 7</span>
<span class="err">guerra : 3</span>
<span class="err">y : 10</span>
<span class="err">no : 2</span>
<span class="err">firmar : 2</span>
<span class="err">una : 2</span>
<span class="err">paz : 2</span>
<span class="err">por : 3</span>
<span class="err">separado. : 2</span>
<span class="err"> : 9</span>
<span class="err">prometiendo : 1</span>
<span class="err">&quot;emplear : 1</span>
<span class="err">todos : 1</span>
<span class="err">sus : 1</span>
<span class="err">recursos, : 1</span>
<span class="err">militares : 1</span>
<span class="err">o : 1</span>
<span class="err">económicos&quot; : 1</span>
<span class="err">&quot;la : 1</span>
<span class="err">lucha : 1</span>
<span class="err">victoria : 1</span>
<span class="err">sobre : 1</span>
<span class="err">el : 5</span>
<span class="err">hitlerismo&quot;. : 1</span>
<span class="err">El : 2</span>
<span class="err">día : 2</span>
<span class="err">año : 1</span>
<span class="err">nuevo : 1</span>
<span class="err">1942, : 1</span>
<span class="err">señor : 1</span>
<span class="err">presidente : 2</span>
<span class="err">Roosevelt : 1</span>
<span class="err">señores : 1</span>
<span class="err">Winston : 1</span>
<span class="err">Churchill, : 1</span>
<span class="err">Maxim : 1</span>
<span class="err">Litvinov, : 1</span>
<span class="err">Unión : 3</span>
<span class="err">Soviética, : 1</span>
<span class="err">T. : 1</span>
<span class="err">V. : 1</span>
<span class="err">Soong, : 1</span>
<span class="err">China, : 2</span>
<span class="err">firmaron : 1</span>
<span class="err">un : 2</span>
<span class="err">breve : 1</span>
<span class="err">documento : 1</span>
<span class="err">luego : 1</span>
<span class="err">conocería : 1</span>
<span class="err">como : 2</span>
<span class="err">Unidas. : 2</span>
<span class="err">Al : 1</span>
<span class="err">siguiente : 1</span>
<span class="err">sumaron : 1</span>
<span class="err">representantes : 1</span>
<span class="err">otras : 1</span>
<span class="err">22 : 1</span>
<span class="err">naciones : 1</span>
<span class="err">más. : 1</span>
<span class="err">alianza : 1</span>
<span class="err">completa : 1</span>
<span class="err">llegó : 1</span>
<span class="err">esta : 1</span>
<span class="err">forma : 1</span>
<span class="err">concordaba : 1</span>
<span class="err">con : 1</span>
<span class="err">principios : 2</span>
<span class="err">enunciados : 2</span>
<span class="err">Atlántico, : 1</span>
<span class="err">primera : 1</span>
<span class="err">cláusula : 1</span>
<span class="err">declaración : 2</span>
<span class="err">reza : 1</span>
<span class="err">países : 2</span>
<span class="err">. : 4</span>
<span class="err">han : 1</span>
<span class="err">suscrito : 1</span>
<span class="err">programa : 1</span>
<span class="err">común : 1</span>
<span class="err">propósitos : 1</span>
<span class="err">conjunta : 1</span>
<span class="err">Unidos : 2</span>
<span class="err">América : 1</span>
<span class="err">primer : 1</span>
<span class="err">ministro : 1</span>
<span class="err">Reino : 2</span>
<span class="err">Unido : 2</span>
<span class="err">Gran : 2</span>
<span class="err">Bretaña : 2</span>
<span class="err">e : 2</span>
<span class="err">Irlanda : 2</span>
<span class="err">Norte, : 2</span>
<span class="err">fechada : 1</span>
<span class="err">14 : 1</span>
<span class="err">agosto : 1</span>
<span class="err">1941, : 1</span>
<span class="err">conocida : 1</span>
<span class="err">Atlántico. : 1</span>
<span class="err">Cuando : 1</span>
<span class="err">tres : 1</span>
<span class="err">años : 1</span>
<span class="err">después : 1</span>
<span class="err">iniciaban : 1</span>
<span class="err">preparativos : 1</span>
<span class="err">para : 1</span>
<span class="err">conferencia : 1</span>
<span class="err">San : 1</span>
<span class="err">Francisco, : 1</span>
<span class="err">únicamente : 1</span>
<span class="err">invitó : 1</span>
<span class="err">participar : 1</span>
<span class="err">aquellos : 1</span>
<span class="err">estados : 1</span>
<span class="err">que, : 1</span>
<span class="err">marzo : 1</span>
<span class="err">1945, : 1</span>
<span class="err">habían : 2</span>
<span class="err">declarado : 1</span>
<span class="err">Alemania : 1</span>
<span class="err">al : 1</span>
<span class="err">Japón : 1</span>
<span class="err">firmado : 1</span>
<span class="err">Signatarios : 1</span>
<span class="err">Originales : 1</span>
<span class="err">ONU : 1</span>
<span class="err">Los : 3</span>
<span class="err">originales : 1</span>
<span class="c">fueron: : 1</span>
<span class="err">América, : 1</span>
<span class="err">Repúblicas : 1</span>
<span class="err">Socialistas : 1</span>
<span class="err">Soviéticas, : 1</span>
<span class="err">Australia, : 1</span>
<span class="err">Bélgica, : 1</span>
<span class="err">Canadá, : 1</span>
<span class="err">Costa : 1</span>
<span class="err">Rica, : 1</span>
<span class="err">Checoeslovaquia, : 1</span>
<span class="err">Salvador, : 1</span>
<span class="err">Grecia, : 1</span>
<span class="err">Guatemala, : 1</span>
<span class="err">Haití, : 1</span>
<span class="err">Honduras, : 1</span>
<span class="err">India, : 1</span>
<span class="err">Luxemburgo, : 1</span>
<span class="err">Nicaragua, : 1</span>
<span class="err">Noruega, : 1</span>
<span class="err">Nueva : 1</span>
<span class="err">Zelandia, : 1</span>
<span class="err">Países : 1</span>
<span class="err">Bajos, : 1</span>
<span class="err">Panamá, : 1</span>
<span class="err">Polonia, : 1</span>
<span class="err">República : 1</span>
<span class="err">Dominicana, : 1</span>
<span class="err">Sudafricana, : 1</span>
<span class="err">Yugoeslavia : 1</span>
<span class="err">firmantes : 1</span>
<span class="err">posteriores : 1</span>
<span class="err">Más : 1</span>
<span class="err">tarde : 1</span>
<span class="err">adhirieron : 1</span>
<span class="err">siguientes : 1</span>
<span class="err">(en : 1</span>
<span class="err">orden : 1</span>
<span class="err">firmas): : 1</span>
<span class="err">México, : 1</span>
<span class="err">Colombia, : 1</span>
<span class="err">Iraq, : 1</span>
<span class="err">Irán, : 1</span>
<span class="err">Liberia, : 1</span>
<span class="err">Paraguay, : 1</span>
<span class="err">Chile, : 1</span>
<span class="err">Uruguay, : 1</span>
<span class="err">Egipto, : 1</span>
<span class="err">Siria, : 1</span>
<span class="err">Francia, : 1</span>
<span class="err">Filipinas, : 1</span>
<span class="err">Brasil, : 1</span>
<span class="err">Bolivia, : 1</span>
<span class="err">Etiopía, : 1</span>
<span class="err">Ecuador, : 1</span>
<span class="err">Perú, : 1</span>
<span class="err">Venezuela, : 1</span>
<span class="err">Turquía, : 1</span>
<span class="err">Arabia : 1</span>
<span class="err">Saudita, : 1</span>
<span class="err">Líbano. : 1</span>
</code></pre></div>

<p>Como se puede ver, se logra obtener la cantidad de veces que aparecen las palabras en el texto.</p>
<h2></h2>
<p>¡Haz tu donativo!
Si te gustó el artículo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
dirección: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el código QR desde la billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"></p>
            </div>
            <div class="post_list">
                <span>By </span>
                <a href="https://ecrespo.github.io/author/ernesto-crespo.html">@Ernesto Crespo</a>
                <span> in </span>
                <span class="post_category"><a href="https://ecrespo.github.io/category/tutorial-python.html" rel="bookmark"
                                               title="Permalink to Tutorial Python">[ Tutorial Python ]</a></span>
                <span class="post_date">mar 03 julio 2018</span>
                <div><span>Tags : </span>
                            <span><a href="https://ecrespo.github.io/tag/python.html">#Python, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/spark.html">#Spark, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/pyspark.html">#PySpark, </a></span>
                </div>

                <div class="entry-social">
                    <span class="twitter"><a target="_blank" rel="nofollow"
                                             onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;"
                                             title="Twitter"
                                             href="https://twitter.com/share?url=https://ecrespo.github.io/contar-palabras-de-un-texto-usando-spark-con-pyspark.html&text=Contar palabras de un texto usando Spark con PySpark&via="><img
                            src="https://ecrespo.github.io/theme/images/icons/twitter-s.png"></a></span>

                    <span class="gplus"><a target="_blank" title="Google +"
                                           href="https://plus.google.com/share?url=https://ecrespo.github.io/contar-palabras-de-un-texto-usando-spark-con-pyspark.html&hl=fr"
                                           rel="nofollow"
                                           onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/google-s.png"></a></span>

                    <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow"
                                              onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;"
                                              href="https://www.facebook.com/sharer.php?u=https://ecrespo.github.io/contar-palabras-de-un-texto-usando-spark-con-pyspark.html&t=Contar palabras de un texto usando Spark con PySpark"><img
                            src="https://ecrespo.github.io/theme/images/icons/facebook-s.png"></a></span>

                    <a target="_blank" title="Linkedin"
                       href="https://www.linkedin.com/shareArticle?mini=true&url=https://ecrespo.github.io/contar-palabras-de-un-texto-usando-spark-con-pyspark.html&title=Contar palabras de un texto usando Spark con PySpark"
                       rel="nofollow"
                       onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/linkedin-s.png"></a>

                    <span class="mail"><a
                            href="mailto:?subject=Contar palabras de un texto usando Spark con PySpark&amp;body=Viens découvrir un article à propos de [Contar palabras de un texto usando Spark con PySpark] sur le site de Ernesto Crespo. https://ecrespo.github.io/contar-palabras-de-un-texto-usando-spark-con-pyspark.html"
                            title="Share by Email" target="_blank"><img
                            src="https://ecrespo.github.io/theme/images/icons/mail-s.png"></a></span>
                </div>
            </div>
                <div class="comments">
                    <h2>Comments !</h2>
                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_identifier = "contar-palabras-de-un-texto-usando-spark-con-pyspark.html";
                        (function () {
                            var dsq = document.createElement('script');
                            dsq.type = 'text/javascript';
                            dsq.async = true;
                            dsq.src = 'https://https://seraphto.disqus.com.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] ||
                            document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                </div>
        </article>
    </section>
</article>

<!-- Footer -->
    <footer>
        <p>
            Blog powered by <a href="http://getpelican.com/">Pelican</a>,
            which takes great advantage of <a href="http://python.org">Python</a>.
            Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a
                href="https://parbhatpuri.com/">@parbhat</a>.
        </p>
    </footer>

    <!-- Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-131517246-1']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>

</body>
</html>