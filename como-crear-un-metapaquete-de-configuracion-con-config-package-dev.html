
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/solid.css">


    <link href="https://ecrespo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Página de Seraph Atom">



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-131517246-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">

<meta name="author" content="Ernesto Crespo" />
<meta name="description" content="Anteriormente se explicó como crear un metapaquete con equivs, se tiene también el paquete config-package-dev el cual permite crear paquetes de configuración donde se puede cambiar la configuración de otros archivos dentro del directorio /etc/ . Este artículo se basa en el tutorial del MIT sobre creación de paquetes de configuración …" />
<meta name="keywords" content="Canaima, Debian, Empaquetado, General, ssh, Ubuntu">

<meta property="og:site_name" content="Página de Seraph"/>
<meta property="og:title" content="Como crear un metapaquete de configuración con config-package-dev"/>
<meta property="og:description" content="Anteriormente se explicó como crear un metapaquete con equivs, se tiene también el paquete config-package-dev el cual permite crear paquetes de configuración donde se puede cambiar la configuración de otros archivos dentro del directorio /etc/ . Este artículo se basa en el tutorial del MIT sobre creación de paquetes de configuración …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ecrespo.github.io/como-crear-un-metapaquete-de-configuracion-con-config-package-dev.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2011-11-13 09:00:00-04:30"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://ecrespo.github.io/author/ernesto-crespo.html">
<meta property="article:section" content="Linux,Empaquetado"/>
<meta property="article:tag" content="Canaima"/>
<meta property="article:tag" content="Debian"/>
<meta property="article:tag" content="Empaquetado"/>
<meta property="article:tag" content="General"/>
<meta property="article:tag" content="ssh"/>
<meta property="article:tag" content="Ubuntu"/>
<meta property="og:image" content="//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120">

  <title>Página de Seraph &ndash; Como crear un metapaquete de configuración con config-package-dev</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://ecrespo.github.io">
        <img src="//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120" alt="Ernesto Crespo" title="Ernesto Crespo">
      </a>
      <h1><a href="https://ecrespo.github.io">Ernesto Crespo</a></h1>

<p>Data Scientist </p>
      <nav>
        <ul class="list">
          <li><a href="https://ecrespo.github.io/pages/About.html#About">Acerca</a></li>
          <li><a href="https://ecrespo.github.io/pages/Contacto.html#Contacto">Contacto</a></li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-medium" href="https://medium.com/@_seraph1" target="_blank">
            <i class="fab fa-medium">
            </i>
          </a></li>
          <li>
            <a  class="sc-linkedin" href="http://ve.linkedin.com/in/ernestocrespo" target="_blank">
            <i class="fab fa-linkedin">
            </i>
          </a></li>
          <li>
            <a  class="sc-github" href="https://github.com/ecrespo" target="_blank">
            <i class="fab fa-github">
            </i>
          </a></li>
          <li>
            <a  class="sc-google" href="https://google.com/+ErnestoCrespo" target="_blank">
            <i class="fab fa-google">
            </i>
          </a></li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/_seraph1" target="_blank">
            <i class="fab fa-twitter">
            </i>
          </a></li>
          <li>
            <a  class="sc-facebook" href="https://www.facebook.com/ernesto.crespo" target="_blank">
            <i class="fab fa-facebook">
            </i>
          </a></li>
          <li>
            <a  class="sc-gitlab" href="https://gitlab.com/ecrespo" target="_blank">
            <i class="fab fa-gitlab">
            </i>
          </a></li>
          <li>
            <a  class="sc-soundcloud" href="https://soundcloud.com/ernesto-crespo" target="_blank">
            <i class="fab fa-soundcloud">
            </i>
          </a></li>
          <li>
            <a  class="sc-rss" href="//www.seraph.to/feeds/all.atom.xml" target="_blank">
            <i class="fas fa-rss">
            </i>
          </a></li>
      </ul>
    </div>



  </aside>
  <main>

    <nav>
      <a href="https://ecrespo.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://ecrespo.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="como-crear-un-metapaquete-de-configuracion-con-config-package-dev">Como crear un metapaquete de configuración con config-package-dev</h1>
    <p>
          Posted on dom 13 noviembre 2011 in <a href="https://ecrespo.github.io/category/linuxempaquetado.html">Linux,Empaquetado</a>


        &#8226; 5 min read
    </p>
  </header>


  <div>
    <p>Anteriormente se explic&oacute; como crear un metapaquete con <code>equivs</code>, se tiene tambi&eacute;n el paquete <code>config-package-dev</code> el cual permite crear paquetes de configuraci&oacute;n donde se puede cambiar la configuraci&oacute;n de otros archivos dentro del directorio <code>/etc/</code> .</p>
<p>Este art&iacute;culo se basa en el <a href="https://debathena.mit.edu/config-package-dev/">tutorial del MIT sobre creaci&oacute;n de paquetes de configuraci&oacute;n para Debian y una gu&iacute;a en el wiki de Debian</a> y una gu&iacute;a en el <a href="https://wiki.debian.org/ConfigPackages">wiki de Debian</a>. El proceso de como adoptar un paquete y empaquetar se explica en una gu&iacute;a que se encuentra en el <a href="https://wiki.debian.org/AdoptarUnPaquete">wiki de Debian</a>.</p>
<p>Como ejemplo se usar&aacute; el paquete <code>openssh-server</code> que crea un archivo con el nombre  <code>/etc/ssh/sshd_config</code> . Este archivo contiene la configuraci&oacute;n necesaria para arrancar un servidor <code>ssh</code>.</p>
<p>Instalando <code>openssh-server</code>:  </p>
<p><code>apt-get install openssh-server config-package-dev</code></p>
<p>El contenido del archivo es el siguiente:  </p>
<p><code>Port 22
Protocol 2
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_dsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
UsePrivilegeSeparation yes
KeyRegenerationInterval 3600
ServerKeyBits 768
SyslogFacility AUTH
LogLevel INFO
LoginGraceTime 120
PermitRootLogin yes
StrictModes yes
RSAAuthentication yes
PubkeyAuthentication yes
IgnoreRhosts yes
RhostsRSAAuthentication no
HostbasedAuthentication no
PermitEmptyPasswords no
ChallengeResponseAuthentication no
X11Forwarding yes
X11DisplayOffset 10
PrintMotd no
PrintLastLog yes
TCPKeepAlive yes
AcceptEnv LANG LC_*
Subsystem sftp /usr/lib/openssh/sftp-server</code></p>
<p>Este archivo tiene el siguiente hash md5.  </p>
<p><code>8caefdd9e251b7cc1baa37874149a870  /etc/ssh/sshd_config</code></p>
<p>La idea es modificar este archivo para que no permita que el usuario <code>root</code> se conecte por <code>ssh</code> y no permitir reenv&iacute;o de aplicaciones gr&aacute;ficas.</p>
<h4 id="procedimiento para crear paquete de configuracion sshd-config:">Procedimiento para crear paquete de configuraci&oacute;n <code>sshd-config</code>:</h4>
<h5 id="1.crear el directorio de trabajo">1.Crear el directorio de trabajo</h5>
<p><code>mkdir canaima-sshd-config-0.1</code></p>
<h5 id="2. cambiarse a dicho directorio">2. Cambiarse a dicho directorio</h5>
<p><code>cd canaima-sshd-config-0.1</code></p>
<h5 id="3. crear los directorios debian y files">3. Crear los directorios debian y files</h5>
<p><code>mkdir -p debian files</code></p>
<h5 id="4. en files crear el directorio etc, luego dentro de el, el directorio ssh y copiar el archivo sshd_config de /etc/ssh/ al directorio creado.">4. En <code>files</code> crear el directorio <code>etc</code>, luego dentro de &eacute;l, el directorio <code>ssh</code> y copiar el archivo <code>sshd_config</code> de <code>/etc/ssh/</code> al directorio creado.</h5>
<p><code>mkdir -p files/etc
mkdir -p files/etc/ssh
cp /etc/ssh/sshd_config ./files/etc/ssh/sshd_config.canaima</code></p>
<h5 id="5. modificar el archivo para que el usuario root no pueda acceder al servidor ssh y que no se pueda reenviar paquetes de x11. las lineas son:">5. Modificar el archivo para que el usuario root no pueda acceder al servidor <code>ssh</code> y que no se pueda reenviar paquetes de <code>X11</code>. Las l&iacute;neas son:</h5>
<p><code>PermitRootLogin no
X11Forwarding no</code> </p>
<h5 id="6. dentro del directorio debian se creo el archivo changelog con el siguiente contenido:">6. Dentro del directorio debian se cre&oacute; el archivo <code>changelog</code> con el siguiente contenido:</h5>
<p>```
canaima-sshd-config (0.1) unstable; urgency=low</p>
<ul>
<li>Initial release.</li>
</ul>
<p>-- Ernesto Nadir Crespo Avila <a href="mailto:ecrespo@gmail.com">ecrespo@gmail.com</a>  Sun, 13 Nov 2011 10:22:48 -0430
```</p>
<h5 id="7. se crea el archivo debian/compat con el valor 7.">7. Se crea el archivo <code>debian/compat</code>  con el valor 7.</h5>
<h5 id="8. se crea el archivo debian/control y debian/control.in con la siguiente informacion:">8. Se crea el archivo <code>debian/control</code> y <code>debian/control.in</code> con la siguiente informaci&oacute;n:</h5>
<p>```
Source: canaima-sshd-config
Section: config
Priority: extra
Maintainer: Ernesto Nadir Crespo Avila <a href="mailto:ecrespo@gmail.com">ecrespo@gmail.com</a>
Build-Depends: cdbs (&gt;= 0.4.23-1.1), debhelper (&gt;= 4.2.0), config-package-dev (&gt;= 4.5~)
Standards-Version: 3.9.2</p>
<p>Package: canaima-sshd-config
Architecture: all
Pre-Depends: openssh-server
Depends: cdbs, ${misc:Depends}
Provides: ${diverted-files}
Conflicts: ${diverted-files}
Description: Archivo de configuracion de ssh
Archivo de configuracion del servidor ssh.
```</p>
<p>En este caso se coloca el par&aacute;metro <code>Pre-Depends</code> ya que se necesita tener el servidor <code>openssh</code> instalado y bien configurado para poder agregarle cambios al archivo <code>/etc/ssh/sshd_config</code> .</p>
<h5 id="9. se crea el archivo debian/copyright, en este caso se esta usando el mismo copyright de los archivos de ejemplo de config-package-dev:">9. Se crea el archivo <code>debian/copyright</code>, en este caso se est&aacute; usando el mismo copyright de los archivos de ejemplo de <code>config-package-dev</code>:</h5>
<p>```
canaima-ssh-config package.</p>
<p>Author: Ernesto Nadir Crespo Avila <a href="mailto:ecrespo@gmail.com">ecrespo@gmail.com</a></p>
<p>Copyright &copy; 2011 Ernesto Nadir Crespo Avila <a href="mailto:ecrespo@gmail.com">ecrespo@gmail.com</a></p>
<p>Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:</p>
<p>The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
```</p>
<h5 id="10. se crea el archivo debian/canaima-sshd-config.install . este archivo define donde se va a tomar los archivos de configuracion y a donde se van a copiar.">10. Se crea el archivo <code>debian/canaima-sshd-config.install</code> . Este archivo define donde se va a tomar los archivos de configuraci&oacute;n y a donde se van a copiar.</h5>
<p><code>files/* /</code></p>
<h5 id="11. se crea el archivo debian/rules. en este archivo se define la extension .canaima, la cual permite diferenciar de los paquetes base de debian de la meta distribucion canaima, ademas se define el archivo a modificar y luego los include de los cdbs:">11. Se crea el archivo <code>debian/rules</code>. En este archivo se define la extensi&oacute;n <code>.canaima</code>, la cual permite diferenciar de los paquetes base de Debian de la meta distribuci&oacute;n canaima, adem&aacute;s se define el archivo a modificar y luego los include de los <code>cdbs</code>:</h5>
<p>```</p>
<h1 id="!/usr/bin/make -f_2">!/usr/bin/make -f</h1>
<p>DEB_DIVERT_EXTENSION = .canaima</p>
<h1 id="replace some base files with simple replacements.">Replace some base files with simple replacements.</h1>
<p>DEB_DIVERT_FILES_canaima-sshd-config += \
/etc/ssh/sshd_config.canaima </p>
<h1 id="these files are installed via dh_install from the files/ directory">These files are installed via dh_install from the files/ directory</h1>
<h1 id="(see debian/canaima-sshd-config.install)">(see debian/canaima-sshd-config.install)</h1>
<p>include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/rules/config-package.mk
```</p>
<h5 id="12. crear el paquete debian y firmarlo con la llave gpg:">12. Crear el paquete debian y firmarlo con la llave <code>gpg</code>:</h5>
<p><code>dpkg-buildpackage -rfakeroot -kC97E7015</code></p>
<p>Al ejectuar un <code>ls</code>  se pueden ver los archivos creados:</p>
<p><code>ls -l canaima-sshd*
-rw-r--r-- 1 ecrespo ecrespo 3948 nov 13 16:09 canaima-sshd-config_0.1_all.deb
-rw-r--r-- 1 ecrespo ecrespo  864 nov 13 16:09 canaima-sshd-config_0.1.dsc
-rw-r--r-- 1 ecrespo ecrespo 1521 nov 13 16:09 canaima-sshd-config_0.1_i386.changes
-rw-r--r-- 1 ecrespo ecrespo 2745 nov 13 16:09 canaima-sshd-config_0.1.tar.gz</code></p>
<h5 id="13. se verifica que el paquete debian cumple con el policy de debian:">13. Se verifica que el paquete Debian cumple con el policy de Debian:</h5>
<p><code>lintian -i canaima-sshd-config_0.1.dsc</code></p>
<h5 id="14. verificar la instalacion del paquete debian.">14. Verificar la instalaci&oacute;n del paquete Debian.</h5>
<p><code>sudo dpkg -i canaima-sshd-config_0.1_all.deb 
[sudo] password for ecrespo: 
Selecting previously unselected package canaima-sshd-config.
(Leyendo la base de datos ... 418546 ficheros o directorios instalados actualmente.)
Desempaquetando canaima-sshd-config (de canaima-sshd-config_0.1_all.deb) ...
Configurando canaima-sshd-config (0.1) ...
A&ntilde;adiendo `desviaci&oacute;n de /etc/ssh/sshd_config a /etc/ssh/sshd_config.canaima-orig por canaima-sshd-config'</code></p>
<h5 id="15. al ejecutar un ls -l en el directorio /etc/ssh/sshd_config* se vera que se crea un enlace al archivo original y se muestra los archivos agregados de la extension canaima:">15. Al ejecutar un <code>ls -l</code> en el directorio <code>/etc/ssh/sshd_config*</code> se ver&aacute; que se crea un enlace al archivo original y se muestra los archivos agregados de la extensi&oacute;n canaima:</h5>
<p><code>root@jewel:/etc/ssh# ls -l sshd_config*
lrwxrwxrwx 1 root root   19 nov 13 16:16 sshd_config -&gt; sshd_config.canaima
-rw-r--r-- 1 root root 2487 nov 13 10:15 sshd_config.canaima
-rw-r--r-- 1 root root 2489 nov 13 13:20 sshd_config.canaima-orig</code></p>
<h5 id="16. al revisar el archivo se nota que el campo para permitir a root conectarse al servidor ssh se encuentra en no, igual caso para el parametro de reenvio de x11. se revisa el hash md5 del archivo y se nota que del archivo original al actual son diferentes:">16. Al revisar el archivo se nota que el campo para permitir a root conectarse al servidor ssh se encuentra en no, igual caso para el par&aacute;metro de reenv&iacute;o de <code>X11</code>. Se revisa el hash <code>md5</code> del archivo y se nota que del archivo original al actual son diferentes:</h5>
<p><code>a358d423fa6b8bf640a7fd1e06731ea3  sshd_config</code></p>
<p>Al crear paquetes de configuraci&oacute;n de esta forma (una forma limpia de modificar archivos de configuraci&oacute;n) y al eliminar el paquete de configuraci&oacute;n los archivos originales se vuelven a usar:</p>
<p>```
apt-get remove -f canaima-sshd-config</p>
<p>root@jewel:/etc/ssh# md5sum sshd_config
8caefdd9e251b7cc1baa37874149a870  sshd_config
``` </p>
<p>Se tienen varios ejemplos para usar <code>config-package-dev</code> como por ejemplo paquetes binarios, configuraci&oacute;n de cron, etc.</p>
<h2 id="_2"></h2>
<p>&iexcl;Haz tu donativo!
Si te gust&oacute; el art&iacute;culo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
direcci&oacute;n: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el c&oacute;digo QR desde la billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"/></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ecrespo.github.io/tag/canaima.html">Canaima</a>
      <a href="https://ecrespo.github.io/tag/debian.html">Debian</a>
      <a href="https://ecrespo.github.io/tag/empaquetado.html">Empaquetado</a>
      <a href="https://ecrespo.github.io/tag/general.html">General</a>
      <a href="https://ecrespo.github.io/tag/ssh.html">ssh</a>
      <a href="https://ecrespo.github.io/tag/ubuntu.html">Ubuntu</a>
    </p>
  </div>



  <div class="related-posts">
    <h4>    You might enjoy
</h4>
    <ul class="related-posts">
      <li><a href="https://ecrespo.github.io/creacion-de-paquete-debian-que-contiene-un-archivo-cron-con-config-package-dev.html">Creación de paquete Debian que contiene un archivo cron con config-package-dev</a></li>
      <li><a href="https://ecrespo.github.io/corrigiendo-los-reportes-generados-por-lintian-de-un-metapaquete.html">Corrigiendo los reportes generados por lintian de un metapaquete</a></li>
      <li><a href="https://ecrespo.github.io/como-crear-un-metapaquete-version-2.html">Como crear un metapaquete (versión 2)</a></li>
      <li><a href="https://ecrespo.github.io/reproductor-de-video-con-python-y-kivy.html">Reproductor de vídeo con python y kivy</a></li>
      <li><a href="https://ecrespo.github.io/widget-button-y-scatter-widget-de-comportamiento-en-kivy.html">Widget button y Scatter (widget de comportamiento) en kivy.</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'https://seraphto.disqus.com';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2006</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Página de Seraph ",
  "url" : "https://ecrespo.github.io",
  "image": "//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120",
  "description": " Software Libre, Ciencia de Datos y Python"
}
</script>

</body>
</html>