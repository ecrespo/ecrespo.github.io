
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/solid.css">


    <link href="https://ecrespo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Página de Seraph Atom">



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-131517246-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">

<meta name="author" content="Ernesto Crespo" />
<meta name="description" content="Pensaba escribir primero como crear opciones a un menú pero recordé que existe la posibilidad de reproducir una canción mp3 desde python con el API de SL4A. Las opciones que tiene el API de SL4A para reproducir música son las siguientes: mediaIsPlaying: Consulta si la canción se está reproduciendo en …" />
<meta name="keywords" content="Android, Python, Reproductor Música">

<meta property="og:site_name" content="Página de Seraph"/>
<meta property="og:title" content="Reproducir una canción en un Celular con Android desde python"/>
<meta property="og:description" content="Pensaba escribir primero como crear opciones a un menú pero recordé que existe la posibilidad de reproducir una canción mp3 desde python con el API de SL4A. Las opciones que tiene el API de SL4A para reproducir música son las siguientes: mediaIsPlaying: Consulta si la canción se está reproduciendo en …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ecrespo.github.io/reproducir-una-cancion-en-un-celular-con-android-desde-python.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2011-04-30 09:10:00-04:30"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://ecrespo.github.io/author/ernesto-crespo.html">
<meta property="article:section" content="Tutorial Python en Android"/>
<meta property="article:tag" content="Android"/>
<meta property="article:tag" content="Python"/>
<meta property="article:tag" content="Reproductor Música"/>
<meta property="og:image" content="//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120">

  <title>Página de Seraph &ndash; Reproducir una canción en un Celular con Android desde python</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://ecrespo.github.io">
        <img src="//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120" alt="Ernesto Crespo" title="Ernesto Crespo">
      </a>
      <h1><a href="https://ecrespo.github.io">Ernesto Crespo</a></h1>

<p>Data Science</p>
      <nav>
        <ul class="list">
          <li><a href="https://ecrespo.github.io/pages/About.html#About">Acerca</a></li>
          <li><a href="https://ecrespo.github.io/pages/Contacto.html#Contacto">Contacto</a></li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-medium" href="https://medium.com/@_seraph1" target="_blank">
            <i class="fab fa-medium">
            </i>
          </a></li>
          <li>
            <a  class="sc-linkedin" href="http://ve.linkedin.com/in/ernestocrespo" target="_blank">
            <i class="fab fa-linkedin">
            </i>
          </a></li>
          <li>
            <a  class="sc-github" href="https://github.com/ecrespo" target="_blank">
            <i class="fab fa-github">
            </i>
          </a></li>
          <li>
            <a  class="sc-google" href="https://google.com/+ErnestoCrespo" target="_blank">
            <i class="fab fa-google">
            </i>
          </a></li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/_seraph1" target="_blank">
            <i class="fab fa-twitter">
            </i>
          </a></li>
          <li>
            <a  class="sc-facebook" href="https://www.facebook.com/ernesto.crespo" target="_blank">
            <i class="fab fa-facebook">
            </i>
          </a></li>
          <li>
            <a  class="sc-gitlab" href="https://gitlab.com/ecrespo" target="_blank">
            <i class="fab fa-gitlab">
            </i>
          </a></li>
          <li>
            <a  class="sc-soundcloud" href="https://soundcloud.com/ernesto-crespo" target="_blank">
            <i class="fab fa-soundcloud">
            </i>
          </a></li>
          <li>
            <a  class="sc-rss" href="//www.seraph.to/feeds/all.atom.xml" target="_blank">
            <i class="fas fa-rss">
            </i>
          </a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://ecrespo.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://ecrespo.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="reproducir-una-cancion-en-un-celular-con-android-desde-python">Reproducir una canción en un Celular con Android desde python</h1>
    <p>
          Posted on sáb 30 abril 2011 in <a href="https://ecrespo.github.io/category/tutorial-python-en-android.html">Tutorial Python en Android</a>


    </p>
  </header>


  <div>
    <p>Pensaba escribir primero como crear opciones a un  menú pero recordé que existe la posibilidad de reproducir una canción mp3 desde python con el API de SL4A.</p>
<p>Las opciones que tiene el API de SL4A para reproducir música son las siguientes:</p>
<ul>
<li>mediaIsPlaying: Consulta si la canción se está reproduciendo en ese momento.</li>
<li>mediaPlayInfo: Retorna información de la canción.</li>
<li>mediaPlay: Se reproduce la canción.</li>
<li>mediaPlayList:</li>
<li>mediaPlayPause: Se pausa la canción.</li>
<li>mediaPlaySeek: Se reproduce la canción en un tiempo determinado.</li>
<li>mediaPlaySetLooping: Se define si se reproduce de nuevo la canción automáticamente.</li>
<li>mediaPlayStart: Inicia la reproducción del archivo</li>
<li>mediaPlayClose: Se cierra el archivo de la canción.</li>
</ul>
<p>Solamente se utilizará en este post las funciones mediaPlay y mediaPlayInfo.</p>
<p>La idea es listar los archivos mp3 en el widget de selección simple y luego reproducir la canción seleccionada.</p>
<p>Antes de reproducir la canción, se toma información de la canción, principalmente la duración de la canción, ese tiempo es luego manejado por una barra de progreso que avanza  mientras se reproduce la canción.</p>
<p>El código del programa se muestra a continuación:</p>
<div class="highlight"><pre><span></span><span class="c1">#Importar el modulo android,path, la funcion sleep,listdir y exit.</span>
<span class="kn">import</span> <span class="nn">android</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="nb">exit</span>


<span class="c1">#La ruta donde se encuentran los mp3s</span>
<span class="n">ruta</span> <span class="o">=</span> <span class="s2">&quot;/sdcard/mp3z/&quot;</span>


<span class="c1">#Se crea la instancia de android</span>
<span class="n">droid</span> <span class="o">=</span> <span class="n">android</span><span class="o">.</span><span class="n">Android</span><span class="p">()</span>
<span class="c1">#Se muestra un mensaje si se desea reproducir una cancion.si es si, se reproduce si no se sale del programa.</span>
<span class="n">droid</span><span class="o">.</span><span class="n">dialogCreateAlert</span><span class="p">(</span><span class="s2">&quot;Reproducir una cancion&quot;</span><span class="p">,</span> <span class="s2">&quot;Desea reproducir una cancion?&quot;</span><span class="p">)</span>
<span class="n">droid</span><span class="o">.</span><span class="n">dialogSetPositiveButtonText</span><span class="p">(</span><span class="s1">&#39;Si&#39;</span><span class="p">)</span>
<span class="n">droid</span><span class="o">.</span><span class="n">dialogSetNegativeButtonText</span><span class="p">(</span><span class="s1">&#39;No&#39;</span><span class="p">)</span>
<span class="n">droid</span><span class="o">.</span><span class="n">dialogShow</span><span class="p">()</span>


<span class="c1">#Se captura la respuesta.</span>
<span class="n">respuesta</span> <span class="o">=</span> <span class="n">droid</span><span class="o">.</span><span class="n">dialogGetResponse</span><span class="p">()</span>


<span class="k">if</span> <span class="n">respuesta</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;which&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;positive&quot;</span><span class="p">:</span>
    <span class="c1">#Se busca los archivos y directorios de la ruta definida.</span>
    <span class="n">archivos</span> <span class="o">=</span> <span class="n">listdir</span><span class="p">(</span><span class="n">ruta</span><span class="p">)</span>
    <span class="c1">#Se crea una lista vacia donde se agregaran los nombres de archivos mp3s</span>
    <span class="n">listado</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">#Se agregan los archivos mp3 a la lista</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">archivos</span><span class="p">:</span>
        <span class="c1">#Si es un archivo se agrega a listado, se pasa la ruta y el archivo.</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">ruta</span><span class="p">,</span><span class="n">i</span><span class="p">)):</span>
            <span class="n">listado</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="c1">#Se muestra un mensaje con la lista de canciones que se pueden reproducir.</span>
    <span class="n">droid</span><span class="o">.</span><span class="n">dialogCreateAlert</span><span class="p">(</span><span class="s2">&quot;Reproducir una cancion&quot;</span><span class="p">)</span>
    <span class="n">droid</span><span class="o">.</span><span class="n">dialogSetSingleChoiceItems</span><span class="p">(</span><span class="n">listado</span><span class="p">)</span>
    <span class="n">droid</span><span class="o">.</span><span class="n">dialogSetPositiveButtonText</span><span class="p">(</span><span class="s1">&#39;Seleccione&#39;</span><span class="p">)</span>
    <span class="n">droid</span><span class="o">.</span><span class="n">dialogSetNegativeButtonText</span><span class="p">(</span><span class="s1">&#39;Salir&#39;</span><span class="p">)</span>
    <span class="n">droid</span><span class="o">.</span><span class="n">dialogShow</span><span class="p">()</span>
    <span class="c1">#Se captura la respuesta y el item seleccionado</span>
    <span class="n">respuesta</span>  <span class="o">=</span> <span class="n">droid</span><span class="o">.</span><span class="n">dialogGetResponse</span><span class="p">()</span><span class="o">.</span><span class="n">result</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">droid</span><span class="o">.</span><span class="n">dialogGetSelectedItems</span><span class="p">()</span>
    <span class="c1">#Si la respuesta es positiva se reproduce la cancion</span>
    <span class="k">if</span>  <span class="n">respuesta</span><span class="p">[</span><span class="s1">&#39;which&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;positive&quot;</span><span class="p">:</span>
        <span class="n">droid</span><span class="o">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s2">&quot;La cancion selecionada es: </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span><span class="n">listado</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])])</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">droid</span><span class="o">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s2">&quot;Reproduciendo la cancion&quot;</span><span class="p">)</span>
        <span class="c1">#Se agrega a cancion la cancion seleccionada segun la variable item.</span>
        <span class="n">cancion</span> <span class="o">=</span> <span class="n">listado</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])]</span>
        <span class="c1">#Se reproduce la cancion pasando la ruta donde esta el archivo y el archivo.</span>
        <span class="n">droid</span><span class="o">.</span><span class="n">mediaPlay</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">ruta</span><span class="p">,</span><span class="n">cancion</span><span class="p">))</span>
        <span class="c1">#Se captura la duracion de la cancion representado en milisegundos</span>
        <span class="n">tiempo</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">droid</span><span class="o">.</span><span class="n">mediaPlayInfo</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;duration&quot;</span><span class="p">])</span>
        <span class="c1">#Se pasa la duracion de la cancion de milisegundos a segundos</span>
        <span class="n">duracion</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tiempo</span> <span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
        <span class="c1">#Se crea una barra de progreso con el titulo reproduciendo, mensaje el nombre de la cancion y la duracion.</span>
        <span class="n">droid</span><span class="o">.</span><span class="n">dialogCreateHorizontalProgress</span><span class="p">(</span><span class="s2">&quot;Reproduciendo&quot;</span><span class="p">,</span><span class="n">cancion</span><span class="p">,</span><span class="n">duracion</span><span class="p">)</span>
        <span class="c1">#Se muestra el widget.</span>
        <span class="n">droid</span><span class="o">.</span><span class="n">dialogShow</span><span class="p">()</span>
        <span class="c1">#Se incrementa el valor de la barra de progreso cada 1 seg.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">duracion</span><span class="p">):</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">droid</span><span class="o">.</span><span class="n">dialogSetCurrentProgress</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="c1">#Al finalizar la cancion se muestra un mensaje de fin de la cancion y se sale de la aplicacion.</span>
        <span class="n">droid</span><span class="o">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s2">&quot;Fin de la reproduccion de la cancion&quot;</span><span class="p">)</span>
        <span class="n">droid</span><span class="o">.</span><span class="n">dialogDismiss</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Si no se selecciono una cancion se sale del programa</span>
        <span class="n">droid</span><span class="o">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s2">&quot;No se selecciono una cancion-Se sale de la aplicacion&quot;</span><span class="p">)</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">else</span><span class="p">:</span>
    <span class="c1">#Se selecciono que no se desea reproducir una cancion</span>
    <span class="n">droid</span><span class="o">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s2">&quot;Fin del programa&quot;</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">()</span>
</pre></div>


<p>La siguiente figura muestra la ventana donde se pregunta si se desea reproducir una canción:</p>
<p><img alt="Ejecutar script " src="./images/reproductorandroid1.png"></p>
<p>La siguiente figura muestra la lista de canciones que se puede reproducir, se selecciona una y luego se le da al botón seleccione.</p>
<p><img alt="Seleccionar mp3" src="./images/reproductorandroid2.png"></p>
<p>La última figura muestra el proceso de reproducción de la canción:</p>
<p><img alt="Reproduciendo el mp3" src="./images/reproductorandroid3.png"></p>
<p>A continuación se muestra el código QR del programa:</p>
<p><img alt="Código QR del programa" src="./images/reproducir.png"></p>
<p>===</p>
<p>¡Haz tu donativo!
Si te gustó el artículo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
dirección: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el código QR desde billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ecrespo.github.io/tag/android.html">Android</a>
      <a href="https://ecrespo.github.io/tag/python.html">Python</a>
      <a href="https://ecrespo.github.io/tag/reproductor-musica.html">Reproductor Música</a>
    </p>
  </div>





<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'https://seraphto.disqus.com';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2006</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Página de Seraph ",
  "url" : "https://ecrespo.github.io",
  "image": "//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120",
  "description": " Software Libre, Ciencia de Datos y Python"
}
</script>

</body>
</html>