
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="http://localhost:8000/en/../theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="http://localhost:8000/en/../theme/pygments/monokai.min.css">


  <link rel="stylesheet" type="text/css" href="http://localhost:8000/en/../theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/en/../theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/en/../theme/font-awesome/css/solid.css">


    <link href="http://localhost:8000/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Seraph's Blog Atom">



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-131517246-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#e5e5ff">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#e5e5ff">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#e5e5ff">

<meta name="author" content="Ernesto Crespo" />
<meta name="description" content="Cuando no se pasa uno a modo paranoico se le ocurren ideas de como validar usuarios al ingresar en una sesión de escritorio vía GDM. En Debian/Ubuntu/Canaima existe los paquetes libpam-usb y pamusb-tools, estos permiten crear una llave, dicha llave se guarda en el pendrive. Luego se configura …" />
<meta name="keywords" content="Linux, Debian, Ubuntu, Canaima, libpam, gnome, usb">


<meta property="og:site_name" content="Seraph's Blog"/>
<meta property="og:title" content="Iniciar sesión de usuario autenticando vía pendrive"/>
<meta property="og:description" content="Cuando no se pasa uno a modo paranoico se le ocurren ideas de como validar usuarios al ingresar en una sesión de escritorio vía GDM. En Debian/Ubuntu/Canaima existe los paquetes libpam-usb y pamusb-tools, estos permiten crear una llave, dicha llave se guarda en el pendrive. Luego se configura …"/>
<meta property="og:locale" content="es_VE"/>
<meta property="og:url" content="http://localhost:8000/en/drafts/iniciar-sesion-de-usuario-autenticando-via-pendrive-es.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2011-07-26 09:00:00-04:30"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://localhost:8000/en/author/ernesto-crespo.html">
<meta property="article:section" content="Tutorial de Linux"/>
<meta property="article:tag" content="Linux"/>
<meta property="article:tag" content="Debian"/>
<meta property="article:tag" content="Ubuntu"/>
<meta property="article:tag" content="Canaima"/>
<meta property="article:tag" content="libpam"/>
<meta property="article:tag" content="gnome"/>
<meta property="article:tag" content="usb"/>
<meta property="og:image" content="//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120">

  <title>Seraph's Blog &ndash; Iniciar sesión de usuario autenticando vía pendrive</title>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "pub-0261001661746989",
      enable_page_level_ads: true
    });
  </script>
</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="http://localhost:8000/en">
        <img src="//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120" alt="Ernesto Crespo" title="Ernesto Crespo">
      </a>

      <h1>
        <a href="http://localhost:8000/en">Ernesto Crespo</a>
      </h1>

<p>Data Scientist </p>

      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="http://localhost:8000/en/pages/About.html#About">
                  Acerca
                </a>
              </li>
              <li>
                <a target="_self"
                   href="http://localhost:8000/en/pages/Contacto.html#Contacto">
                  Contacto
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-medium" href="https://medium.com/@_seraph1" target="_blank">
              <i class="fab fa-medium"></i>
            </a>
          </li>
          <li>
            <a  class="sc-linkedin" href="http://ve.linkedin.com/in/ernestocrespo" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-github" href="https://github.com/ecrespo" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-google" href="https://google.com/+ErnestoCrespo" target="_blank">
              <i class="fab fa-google"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/_seraph1" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
          <li>
            <a  class="sc-facebook" href="https://www.facebook.com/ernesto.crespo" target="_blank">
              <i class="fab fa-facebook"></i>
            </a>
          </li>
          <li>
            <a  class="sc-gitlab" href="https://gitlab.com/ecrespo" target="_blank">
              <i class="fab fa-gitlab"></i>
            </a>
          </li>
          <li>
            <a  class="sc-soundcloud" href="https://soundcloud.com/ernesto-crespo" target="_blank">
              <i class="fab fa-soundcloud"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="//www.seraph.to/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle ads-aside"
           data-ad-client="pub-0261001661746989"
           data-ad-slot="1234561"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
  </aside>
  <main>
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle ads-responsive"
           data-ad-client="pub-0261001661746989"
           data-ad-slot="1234562"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

    <nav>
      <a href="http://localhost:8000/en">Home</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="http://localhost:8000/feeds/all.atom.xml">Atom</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="iniciar-sesion-de-usuario-autenticando-via-pendrive">Iniciar sesión de usuario autenticando vía pendrive</h1>
    <p>
      Posted on mar 26 julio 2011 in <a href="http://localhost:8000/en/category/tutorial-de-linux.html">Tutorial de Linux</a>

        &#8226; 2 min read
    </p>
  </header>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="pub-0261001661746989"
         data-ad-slot="1234565"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

  <div>
    <p>Cuando no se pasa uno a modo paranoico se le ocurren ideas de como validar usuarios al ingresar en una sesión de escritorio vía GDM.</p>
<p>En Debian/Ubuntu/Canaima existe los paquetes libpam-usb y pamusb-tools, estos permiten crear una llave, dicha llave se guarda en el pendrive. Luego se configura pam para que se pida la llave al momento de ingresar usuario y clave en el GDM del equipo; si no se conecta el pendrive el GDM colocará un mensaje que clave invalida.</p>
<p>Para instalar estos paquetes se ejecuta aptitude:</p>
<div class="highlight"><pre><span class="code-line"><span class="code-line"><span></span><span class="n">aptitude</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">libpam</span><span class="o">-</span><span class="n">usb</span><span class="w"> </span><span class="n">pamusb</span><span class="o">-</span><span class="n">tools</span><span class="w"></span></span></span>
</pre></div>


<p>Luego se conecta el pendrive en el equipo y se agrega el dispositivo en /etc/pamusb.conf con el comando pamusb-conf:</p>
<div class="highlight"><pre><span class="code-line"><span class="code-line"><span></span>pamusb-conf --add-device /media/F060-785C/</span></span>
</pre></div>


<p>Donde /media/F060-785C/ es la ruta del pendrive.</p>
<p>Se agrega el usuario en /etc/pamusb.conf el cual iniciará sesión en el equipo:</p>
<div class="highlight"><pre><span class="code-line"><span class="code-line"><span></span>pamusb-conf --add-user ecrespo</span></span>
</pre></div>


<p>Se verifica la configuración de pamusb con el usuario agregado:</p>
<div class="highlight"><pre><span class="code-line"><span class="code-line"><span></span><span class="nv">pamusb</span><span class="o">-</span><span class="nv">check</span> <span class="nv">ecrespo</span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span> <span class="nv">Authentication</span> <span class="nv">request</span> <span class="k">for</span> <span class="nv">user</span> <span class="s2">&quot;</span><span class="s">ecrespo</span><span class="s2">&quot;</span> <span class="ss">(</span><span class="nv">pamusb</span><span class="o">-</span><span class="nv">check</span><span class="ss">)</span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span> <span class="nv">Device</span> <span class="s2">&quot;</span><span class="s">/media/F060-785C/</span><span class="s2">&quot;</span> <span class="nv">is</span> <span class="nv">connected</span> <span class="ss">(</span><span class="nv">good</span><span class="ss">)</span>.</span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span> <span class="nv">Performing</span> <span class="nv">one</span> <span class="nv">time</span> <span class="nv">pad</span> <span class="nv">verification</span>...</span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span> <span class="nv">Regenerating</span> <span class="nv">new</span> <span class="nv">pads</span>...</span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span> <span class="nv">Unable</span> <span class="nv">to</span> <span class="nv">update</span> <span class="nv">pads</span>.</span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span> <span class="nv">Access</span> <span class="nv">granted</span>.</span></span>
</pre></div>


<p>Al devolver el programa acceso garantizado ya se tiene todo listo para usar el pendrive en el momento de inicio de sesión, sólo falta modificar pam para que permita la autenticación con el pendrive.</p>
<p>Se edita el archivo /etc/pam.d/common-aut y se agrega la siguiente línea:</p>
<div class="highlight"><pre><span class="code-line"><span class="code-line"><span></span>auth sufficient pam_usb.so</span></span>
</pre></div>


<p>Con esta línea el GDM verifica el token de la llave, si se quiere que pida tanto la contraseña como el token se cambia sufficient a required.</p>
<div class="highlight"><pre><span class="code-line"><span class="code-line"><span></span>auth required pam_usb.so</span></span>
</pre></div>


<p>A partir de ahora al iniciar sesión se necesita la contraseña y el token.</p>
<p>A continuación se muestra el mensaje que envía la consola al ejecutar sudo -s :</p>
<div class="highlight"><pre><span class="code-line"><span class="code-line"><span></span><span class="o">[</span><span class="n">sudo</span><span class="o">]</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">ecrespo</span><span class="p">:</span><span class="w"> </span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span><span class="w"> </span><span class="n">pam_usb</span><span class="w"> </span><span class="n">v0</span><span class="mf">.4.2</span><span class="w"></span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="ss">&quot;ecrespo&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">sudo</span><span class="p">)</span><span class="w"></span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span><span class="w"> </span><span class="n">Device</span><span class="w"> </span><span class="ss">&quot;/media/F060-785C/&quot;</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">connected</span><span class="w"> </span><span class="p">(</span><span class="n">good</span><span class="p">).</span><span class="w"></span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span><span class="w"> </span><span class="n">Performing</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="k">pad</span><span class="w"> </span><span class="n">verification</span><span class="p">...</span><span class="w"></span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span><span class="w"> </span><span class="n">Regenerating</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">pads</span><span class="p">...</span><span class="w"></span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span><span class="w"> </span><span class="n">Unable</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">update</span><span class="w"> </span><span class="n">pads</span><span class="p">.</span><span class="w"></span></span></span>
<span class="code-line"><span class="code-line"><span class="o">*</span><span class="w"> </span><span class="n">Access</span><span class="w"> </span><span class="n">granted</span><span class="p">.</span><span class="w"></span></span></span>
</pre></div>


<p>===</p>
<p>¡Haz tu donativo!
Si te gustó el artículo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
dirección: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el código QR desde billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://localhost:8000/en/tag/linux.html">Linux</a>
      <a href="http://localhost:8000/en/tag/debian.html">Debian</a>
      <a href="http://localhost:8000/en/tag/ubuntu.html">Ubuntu</a>
      <a href="http://localhost:8000/en/tag/canaima.html">Canaima</a>
      <a href="http://localhost:8000/en/tag/libpam.html">libpam</a>
      <a href="http://localhost:8000/en/tag/gnome.html">gnome</a>
      <a href="http://localhost:8000/en/tag/usb.html">usb</a>
    </p>
  </div>


  <div class="neighbors">
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="http://localhost:8000/en/internet-de-las-cosas-es  ernet de las cosas.html">Internet de las Cosas</a></li>
    </ul>
  </div>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="pub-0261001661746989"
         data-ad-slot="1234566"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'https://seraphto.disqus.com';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy; 2022 </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Seraph's Blog ",
  "url" : "http://localhost:8000/en",
  "image": "//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120",
  "description": " Software Libre, Ciencia de Datos y Python"
}
</script>


</body>
</html>