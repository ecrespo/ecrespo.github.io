<!doctype html>
<html lang="es" itemscope itemtype="http://schema.org/Person">
<head>
            <meta charset="utf-8">
        <!-- Site Meta Data -->
        <title>Extracción de información de PDFs con python (parte 1).</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Ernesto Crespo">

        <link rel="shortcut icon" href="">

        <!-- schema.org -->
        <meta itemprop="name" content="Página de Seraph">
        <meta itemprop="image" content="">
        <meta itemprop="description" content="">

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
        <!-- Style Meta Data -->
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/style.css" type="text/css"/>
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/pygments.css" type="text/css"/>

        <!-- Feed Meta Data -->
            <link href="https://ecrespo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="Página de Seraph ATOM Feed"/>

        <!-- Twitter Feed -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="">
        <meta name="twitter:image" content="">

    <meta name="twitter:creator" content="">
    <meta name="twitter:url" content="https://ecrespo.github.io/extraccion-de-informacion-de-pdfs-con-python-parte-1.html">
    <meta name="twitter:title" content="Página de Seraph ~ Extracción de información de PDFs con python (parte 1).">
    <meta name="twitter:description" content="Existen varias herramientas en python para obtener información de PDF. En este caso visite la página de Cencoex, en la sección de Cencoex en cifras hay un enlace a un pdf a Liquidaciones a Empresas Agremiadas del Sector Salud (Ordinarias + ALADI + SUCRE). Para este primer artículo se usará pycurl para …">

    <!-- Facebook Meta Data -->
    <meta property="og:title" content="Página de Seraph ~ Extracción de información de PDFs con python (parte 1)."/>
    <meta property="og:description" content="Existen varias herramientas en python para obtener información de PDF. En este caso visite la página de Cencoex, en la sección de Cencoex en cifras hay un enlace a un pdf a Liquidaciones a Empresas Agremiadas del Sector Salud (Ordinarias + ALADI + SUCRE). Para este primer artículo se usará pycurl para …"/>
    <meta property="og:image" content=""/>
</head>

<body>
<!-- Sidebar -->
<aside>
    <!--<center><a href="https://ecrespo.github.io"><img id="avatar" src=""></a></center>-->
    <h1>Página de Seraph</h1>
    <br>


    <nav class="nav">
        <ul class="list-bare">

                <li><a class="nav__link" href="/archives.html">Archives</a></li>
                <li><a class="nav__link" href="/categories.html">Categories</a></li>
                <li><a class="nav__link" href="/tags.html">Tags</a></li>

                <li><a class="nav__link" href="https://ecrespo.github.io/pages/About.html">Acerca</a></li>
                <li><a class="nav__link" href="https://ecrespo.github.io/pages/Contacto.html">Contacto</a></li>

        </ul>
    </nav>

    <p class="social">
                <a href="https://medium.com/@_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/medium.png"></a>
                <a href="http://ve.linkedin.com/in/ernestocrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/linkedin.png"></a>
                <a href="https://github.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/github.png"></a>
                <a href="https://google.com/+ErnestoCrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/google.png"></a>
                <a href="https://twitter.com/_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/twitter.png"></a>
                <a href="https://www.facebook.com/ernesto.crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/facebook.png"></a>
                <a href="https://gitlab.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/gitlab.png"></a>
                <a href="https://soundcloud.com/ernesto-crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/soundcloud.png"></a>
                <a href="//www.seraph.to/feeds/all.atom.xml" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
            <a href="https://ecrespo.github.io/feeds/all.atom.xml" rel="alternate">
                <img src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
    </p>

        <h2>Categories</h2>
        <ul class="navbar">
                <li><a
                        href="https://ecrespo.github.io/category/accesibilidad.html">Accesibilidad</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncio.html">Anuncio</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncios.html">Anuncios</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/aplicacion-android.html">Aplicación Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/asterisk-debian-linux.html">Asterisk, Debian, Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla.html">Charla</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla-python.html">Charla Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-linux-mac-book.html">Debian, Linux, Mac Book</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-maemo-nokia-n810-python.html">Debian, maemo, Nokia N810, Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/demostracion-aplicacion-para-android.html">Demostración Aplicación para Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/desarrollomovil.html">Desarrollo,Movil</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/evento.html">Evento</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/general.html">General</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linux.html">Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdebian.html">Linux,Debian</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdesarrollo.html">Linux,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxempaquetado.html">Linux,Empaquetado</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxofimaticadesarrollo.html">Linux,Ofimatica,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/movil-nokia.html">Movil, Nokia</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810.html">Nokia N810</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810-debian-maemo.html">Nokia N810 Debian Maemo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/posts.html">posts</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/resumen-2010.html">Resumen 2010</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/sistemas-operativos.html">Sistemas Operativos</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial.html">Tutorial</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-android.html">Tutorial Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-arduino.html">Tutorial de Arduino</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-data-science.html">Tutorial de Data Science</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-docker.html">Tutorial de Docker</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-integracion-continua.html">Tutorial de integración continua</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-linux.html">Tutorial de Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python.html">Tutorial de Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-en-android.html">Tutorial de Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-linux.html">Tutorial de Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-pyqt.html">Tutorial de Python y PyQt</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-debian-bsd-y-python.html">Tutorial Debian BSD y Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux.html">Tutorial Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux-y-python.html">Tutorial Linux y Python</a></li>
                <li class="active"><a
                        href="https://ecrespo.github.io/category/tutorial-python.html">Tutorial Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-en-android.html">Tutorial Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-y-linux.html">Tutorial Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorialdesarrollo.html">Tutorial,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/xml-rpcpython.html">XML-RPC,Python</a></li>
        </ul>


</aside>

<!-- Content -->
<article>
    <section id="content">
        <article>
            <h2 class="post_title post_detail"><a href="https://ecrespo.github.io/extraccion-de-informacion-de-pdfs-con-python-parte-1.html" rel="bookmark"
                                                  title="Permalink to Extracción de información de PDFs con python (parte 1).">Extracción de información de PDFs con python (parte 1).</a></h2>
            <div class="entry-content blog-post">
                <p>Existen varias herramientas en python para obtener información de PDF.
En este caso visite la página de <a href="www.cencoex.gob.ve">Cencoex</a>, en la sección de Cencoex en cifras hay un enlace a un pdf a <a href="http://www.cencoex.gob.ve/images/stories/pdfs/estadisticas/Salud.pdf">Liquidaciones a Empresas Agremiadas del Sector Salud (Ordinarias + ALADI + SUCRE)</a>.</p>
<p>Para este primer artículo se usará <a href="http://pycurl.io/">pycurl</a> para bajar el pdf y <a href="http://eternal-todo.com/tools/peepdf-pdf-analysis-tool">peepdf</a> para analizarlo. Para descargar peepdf se puede hacer desde el repositorio del proyecto en <a href="https://github.com/jesparza/peepdf">github</a>.</p>
<p>En el caso de <code>pycurl</code> se instala por <code>pip</code> o por <code>apt-get</code> en Debian.</p>
<p>Se baja <code>peepdf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="err">git clone https://github.com/jesparza/peepdf.git</span>
</code></pre></div>

<p>Para bajar el archivo se ejecuta el código a continuación, el cual baja el archivo pdf y lo salva como <code>salud.pdf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pycurl</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;salud.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">pycurl</span><span class="o">.</span><span class="n">Curl</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="s1">&#39;http://www.cencoex.gob.ve/images/stories/pdfs/estadisticas/Salud.pdf&#39;</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">setopt</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">WRITEDATA</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<p>En el directorio de la aplicación se ejecuta (opción <code>-f</code> para el archivo y <code>-i</code> en modo interactivo:</p>
<div class="highlight"><pre><span></span><code><span class="o">./</span><span class="n">peepdf</span><span class="o">.</span><span class="n">py</span>  <span class="o">-</span><span class="n">f</span> <span class="o">../</span><span class="n">salud</span><span class="o">.</span><span class="n">pdf</span> <span class="o">-</span><span class="n">i</span>
</code></pre></div>

<p>Y devuelve:</p>
<div class="highlight"><pre><span></span><code><span class="n">File</span><span class="p">:</span> <span class="n">salud</span><span class="o">.</span><span class="n">pdf</span>
<span class="n">MD5</span><span class="p">:</span> <span class="n">e639fca504182dc5cb383cc455d30c21</span>
<span class="n">SHA1</span><span class="p">:</span> <span class="mi">2</span><span class="n">c29f4a20e4e0b6a3c10decbfacced991e59ad79</span>
<span class="n">SHA256</span><span class="p">:</span> <span class="mi">9</span><span class="n">a4d3d48f060d1fa29fe9cb5e7a435643586e9871e62254839daf3fd87e45506</span>
<span class="n">Size</span><span class="p">:</span> <span class="mi">57611</span> <span class="nb">bytes</span>
<span class="n">Version</span><span class="p">:</span> <span class="mf">1.3</span>
<span class="n">Binary</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Linearized</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">Encrypted</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">Updates</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Objects</span><span class="p">:</span> <span class="mi">34</span>
<span class="n">Streams</span><span class="p">:</span> <span class="mi">7</span>
<span class="n">Comments</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Errors</span><span class="p">:</span> <span class="mi">0</span>

<span class="n">Version</span> <span class="mi">0</span><span class="p">:</span>
 <span class="n">Catalog</span><span class="p">:</span> <span class="mi">1</span>
 <span class="n">Info</span><span class="p">:</span> <span class="mi">2</span>
 <span class="n">Objects</span> <span class="p">(</span><span class="mi">34</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">]</span>
 <span class="n">Streams</span> <span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">27</span><span class="p">]</span>
  <span class="n">Encoded</span> <span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">27</span><span class="p">]</span>
</code></pre></div>

<p>El comando tree devuelve la estructura lógica del archivo:</p>
<div class="highlight"><pre><span></span><code><span class="n">PPDF</span><span class="o">&gt;</span> <span class="n">tree</span>

<span class="o">/</span><span class="n">Catalog</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 <span class="o">/</span><span class="n">Pages</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
  <span class="o">/</span><span class="n">Page</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
   <span class="o">/</span><span class="n">Pages</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
   <span class="n">stream</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">integer</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">Unknown</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">/</span><span class="n">Catalog</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R10</span> <span class="p">(</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">stream</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R7</span> <span class="p">(</span><span class="mi">11</span><span class="p">)</span>
    <span class="o">/</span><span class="n">ExtGState</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R8</span> <span class="p">(</span><span class="mi">13</span><span class="p">)</span>
    <span class="o">/</span><span class="n">Font</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
     <span class="o">/</span><span class="n">Encoding</span> <span class="p">(</span><span class="mi">34</span><span class="p">)</span>
     <span class="o">/</span><span class="n">FontDescriptor</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span>
      <span class="n">stream</span> <span class="p">(</span><span class="mi">32</span><span class="p">)</span>
     <span class="n">stream</span> <span class="p">(</span><span class="mi">33</span><span class="p">)</span>
  <span class="o">/</span><span class="n">Page</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>
   <span class="o">/</span><span class="n">Pages</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
   <span class="n">stream</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">integer</span> <span class="p">(</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">Unknown</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">/</span><span class="n">Catalog</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R10</span> <span class="p">(</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">stream</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R7</span> <span class="p">(</span><span class="mi">17</span><span class="p">)</span>
    <span class="o">/</span><span class="n">ExtGState</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R8</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="o">/</span><span class="n">Font</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
  <span class="o">/</span><span class="n">Page</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>
   <span class="o">/</span><span class="n">Pages</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
   <span class="n">stream</span> <span class="p">(</span><span class="mi">21</span><span class="p">)</span>
    <span class="n">integer</span> <span class="p">(</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">Unknown</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">/</span><span class="n">Catalog</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R10</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">stream</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R7</span> <span class="p">(</span><span class="mi">23</span><span class="p">)</span>
    <span class="o">/</span><span class="n">ExtGState</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R8</span> <span class="p">(</span><span class="mi">25</span><span class="p">)</span>
    <span class="o">/</span><span class="n">Font</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
  <span class="o">/</span><span class="n">Page</span> <span class="p">(</span><span class="mi">26</span><span class="p">)</span>
   <span class="o">/</span><span class="n">Pages</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
   <span class="n">stream</span> <span class="p">(</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">integer</span> <span class="p">(</span><span class="mi">28</span><span class="p">)</span>
    <span class="n">Unknown</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">/</span><span class="n">Catalog</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R10</span> <span class="p">(</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">stream</span> <span class="p">(</span><span class="mi">10</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R7</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
    <span class="o">/</span><span class="n">ExtGState</span> <span class="p">(</span><span class="mi">7</span><span class="p">)</span>
   <span class="o">/</span><span class="n">R8</span> <span class="p">(</span><span class="mi">31</span><span class="p">)</span>
    <span class="o">/</span><span class="n">Font</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">/</span><span class="n">Info</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>

<p>Para ver la estructura física se usa el comando <code>offsets</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">PPDF</span><span class="o">&gt;</span> <span class="n">offsets</span>

       <span class="mi">0</span> <span class="n">Header</span>
      <span class="mi">15</span>
        <span class="n">Object</span>  <span class="mi">5</span> <span class="p">(</span><span class="mi">8865</span><span class="p">)</span>
    <span class="mi">8879</span>
    <span class="mi">8881</span>
        <span class="n">Object</span>  <span class="mi">6</span> <span class="p">(</span><span class="mi">19</span><span class="p">)</span>
    <span class="mi">8899</span>
    <span class="mi">8901</span>
        <span class="n">Object</span>  <span class="mi">15</span> <span class="p">(</span><span class="mi">9005</span><span class="p">)</span>
   <span class="mi">17905</span>
   <span class="mi">17907</span>
        <span class="n">Object</span>  <span class="mi">16</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>
   <span class="mi">17926</span>
   <span class="mi">17928</span>
        <span class="n">Object</span>  <span class="mi">21</span> <span class="p">(</span><span class="mi">8618</span><span class="p">)</span>
   <span class="mi">26545</span>
   <span class="mi">26547</span>
        <span class="n">Object</span>  <span class="mi">22</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>
   <span class="mi">26566</span>
   <span class="mi">26568</span>
        <span class="n">Object</span>  <span class="mi">27</span> <span class="p">(</span><span class="mi">6554</span><span class="p">)</span>
   <span class="mi">33121</span>
   <span class="mi">33123</span>
        <span class="n">Object</span>  <span class="mi">28</span> <span class="p">(</span><span class="mi">20</span><span class="p">)</span>
   <span class="mi">33142</span>
   <span class="mi">33144</span>
        <span class="n">Object</span>  <span class="mi">4</span> <span class="p">(</span><span class="mi">189</span><span class="p">)</span>
   <span class="mi">33332</span>
   <span class="mi">33334</span>
        <span class="n">Object</span>  <span class="mi">14</span> <span class="p">(</span><span class="mi">191</span><span class="p">)</span>
   <span class="mi">33524</span>
   <span class="mi">33526</span>
        <span class="n">Object</span>  <span class="mi">20</span> <span class="p">(</span><span class="mi">191</span><span class="p">)</span>
   <span class="mi">33716</span>
   <span class="mi">33718</span>
        <span class="n">Object</span>  <span class="mi">26</span> <span class="p">(</span><span class="mi">191</span><span class="p">)</span>
   <span class="mi">33908</span>
   <span class="mi">33910</span>
        <span class="n">Object</span>  <span class="mi">3</span> <span class="p">(</span><span class="mi">88</span><span class="p">)</span>
   <span class="mi">33997</span>
   <span class="mi">33999</span>
        <span class="n">Object</span>  <span class="mi">1</span> <span class="p">(</span><span class="mi">47</span><span class="p">)</span>
   <span class="mi">34045</span>
   <span class="mi">34047</span>
        <span class="n">Object</span>  <span class="mi">7</span> <span class="p">(</span><span class="mi">40</span><span class="p">)</span>
   <span class="mi">34086</span>
   <span class="mi">34088</span>
        <span class="n">Object</span>  <span class="mi">11</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
   <span class="mi">34116</span>
   <span class="mi">34118</span>
        <span class="n">Object</span>  <span class="mi">12</span> <span class="p">(</span><span class="mi">31</span><span class="p">)</span>
   <span class="mi">34148</span>
   <span class="mi">34150</span>
        <span class="n">Object</span>  <span class="mi">10</span> <span class="p">(</span><span class="mi">4140</span><span class="p">)</span>
   <span class="mi">38289</span>
   <span class="mi">38291</span>
        <span class="n">Object</span>  <span class="mi">13</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
   <span class="mi">38319</span>
   <span class="mi">38321</span>
        <span class="n">Object</span>  <span class="mi">17</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
   <span class="mi">38349</span>
   <span class="mi">38351</span>
        <span class="n">Object</span>  <span class="mi">18</span> <span class="p">(</span><span class="mi">31</span><span class="p">)</span>
   <span class="mi">38381</span>
   <span class="mi">38383</span>
        <span class="n">Object</span>  <span class="mi">19</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
   <span class="mi">38411</span>
   <span class="mi">38413</span>
        <span class="n">Object</span>  <span class="mi">23</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
   <span class="mi">38441</span>
   <span class="mi">38443</span>
        <span class="n">Object</span>  <span class="mi">24</span> <span class="p">(</span><span class="mi">31</span><span class="p">)</span>
   <span class="mi">38473</span>
   <span class="mi">38475</span>
        <span class="n">Object</span>  <span class="mi">25</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
   <span class="mi">38503</span>
   <span class="mi">38505</span>
        <span class="n">Object</span>  <span class="mi">29</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
   <span class="mi">38533</span>
   <span class="mi">38535</span>
        <span class="n">Object</span>  <span class="mi">30</span> <span class="p">(</span><span class="mi">31</span><span class="p">)</span>
   <span class="mi">38565</span>
   <span class="mi">38567</span>
        <span class="n">Object</span>  <span class="mi">31</span> <span class="p">(</span><span class="mi">29</span><span class="p">)</span>
   <span class="mi">38595</span>
   <span class="mi">38597</span>
        <span class="n">Object</span>  <span class="mi">33</span> <span class="p">(</span><span class="mi">614</span><span class="p">)</span>
   <span class="mi">39210</span>
   <span class="mi">39212</span>
        <span class="n">Object</span>  <span class="mi">8</span> <span class="p">(</span><span class="mi">436</span><span class="p">)</span>
   <span class="mi">39647</span>
   <span class="mi">39649</span>
        <span class="n">Object</span>  <span class="mi">34</span> <span class="p">(</span><span class="mi">408</span><span class="p">)</span>
   <span class="mi">40056</span>
   <span class="mi">40058</span>
        <span class="n">Object</span>  <span class="mi">9</span> <span class="p">(</span><span class="mi">204</span><span class="p">)</span>
   <span class="mi">40261</span>
   <span class="mi">40263</span>
        <span class="n">Object</span>  <span class="mi">32</span> <span class="p">(</span><span class="mi">16249</span><span class="p">)</span>
   <span class="mi">56511</span>
   <span class="mi">56513</span>
        <span class="n">Object</span>  <span class="mi">2</span> <span class="p">(</span><span class="mi">243</span><span class="p">)</span>
   <span class="mi">56755</span>
   <span class="mi">56757</span>
        <span class="n">Xref</span> <span class="n">Section</span> <span class="p">(</span><span class="mi">709</span><span class="p">)</span>
   <span class="mi">57465</span>
   <span class="mi">57467</span>
        <span class="n">Trailer</span> <span class="p">(</span><span class="mi">138</span><span class="p">)</span>
   <span class="mi">57604</span>
   <span class="mi">57605</span> <span class="n">EOF</span>
</code></pre></div>

<p>Para ver el metadato del pdf se ejecuta metadata:</p>
<div class="highlight"><pre><span></span><code><span class="n">PPDF</span><span class="o">&gt;</span> <span class="n">metadata</span>

<span class="n">Info</span> <span class="n">Object</span> <span class="ow">in</span> <span class="n">version</span> <span class="mi">0</span><span class="p">:</span>

<span class="o">&lt;&lt;</span> <span class="o">/</span><span class="n">ModDate</span> <span class="n">D</span><span class="p">:</span><span class="mi">20140908210848</span><span class="o">+</span><span class="mi">04</span><span class="s1">&#39;-30&#39;</span>
<span class="o">/</span><span class="n">CreationDate</span> <span class="n">D</span><span class="p">:</span><span class="mi">20140908210848</span><span class="o">+</span><span class="mi">04</span><span class="s1">&#39;-30&#39;</span>
<span class="o">/</span><span class="n">Producer</span> <span class="n">Nitro</span> <span class="n">PDF</span> <span class="n">PrimoPDF</span>
<span class="o">/</span><span class="n">Title</span> <span class="n">LIQUIDACIONES</span> <span class="n">DEL</span> <span class="mi">1</span> <span class="n">ENERO</span> <span class="n">AL</span> <span class="mi">5</span> <span class="n">DE</span> <span class="n">SEPTIEMBRE</span> <span class="mf">2014.</span><span class="n">xls</span>
<span class="o">/</span><span class="n">Creator</span> <span class="n">PrimoPDF</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">primopdf</span><span class="o">.</span><span class="n">com</span>
<span class="o">/</span><span class="n">Author</span> <span class="n">lrojas</span> <span class="o">&gt;&gt;</span>
</code></pre></div>

<p>La fecha de creación del archivo es 09-08-2014 y la hora es 21:08:48  hora de Venezuela. El título del archivo Liquidaciones del 1 enero al 5 de septiembre de 2014, ah, es un archivo xls de excel. Y usaron primopdf para generar el pdf, por último el autor del pdf es lrojas.</p>
<p>Si se quiere revisar el objeto 2:</p>
<div class="highlight"><pre><span></span><code><span class="n">PPDF</span><span class="o">&gt;</span> <span class="nb">object</span> <span class="mi">2</span>

<span class="o">&lt;&lt;</span> <span class="o">/</span><span class="n">ModDate</span> <span class="n">D</span><span class="p">:</span><span class="mi">20140908210848</span><span class="o">+</span><span class="mi">04</span><span class="s1">&#39;-30&#39;</span>
<span class="o">/</span><span class="n">CreationDate</span> <span class="n">D</span><span class="p">:</span><span class="mi">20140908210848</span><span class="o">+</span><span class="mi">04</span><span class="s1">&#39;-30&#39;</span>
<span class="o">/</span><span class="n">Producer</span> <span class="n">Nitro</span> <span class="n">PDF</span> <span class="n">PrimoPDF</span>
<span class="o">/</span><span class="n">Title</span> <span class="n">LIQUIDACIONES</span> <span class="n">DEL</span> <span class="mi">1</span> <span class="n">ENERO</span> <span class="n">AL</span> <span class="mi">5</span> <span class="n">DE</span> <span class="n">SEPTIEMBRE</span> <span class="mf">2014.</span><span class="n">xls</span>
<span class="o">/</span><span class="n">Creator</span> <span class="n">PrimoPDF</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">primopdf</span><span class="o">.</span><span class="n">com</span>
<span class="o">/</span><span class="n">Author</span> <span class="n">lrojas</span> <span class="o">&gt;&gt;</span>
</code></pre></div>

<p>Es el que contiene la información de los metadatos.</p>
<p>Revisando el objeto 15 se obtiene:</p>
<div class="highlight"><pre><span></span><code><span class="err">432 1739.33 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 1642.33 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 1545.33 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 1448.33 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 1351.33 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 1254.33 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 1157.33 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 1060.33 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 963.332 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 866.332 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 769.332 3991 6 re</span>
<span class="err">f</span>
<span class="err">432 672.332 3991 6 re</span>
</code></pre></div>

<p>O usando <code>rawstream</code>:</p>
<div class="highlight"><pre><span></span><code><span class="err">rawstream 15</span>
<span class="err">50 9f fa 71 0f 29 76 8a bc 44 3e dd c6 15 84 9e   öP..q.)v..D&gt;.....ö</span>
<span class="err">4c 89 76 f6 75 8c 3d 23 65 11 fb 65 48 d1 0e a1   öL.v.u.=#e..eH...ö</span>
<span class="err">37 f6 08 d3 b6 f8 d2 17 15 4a 76 29 b0 04 86 e1   ö7........Jv)....ö</span>
<span class="err">b4 9e 9b 3a 34 e7 d1 ce 91 9a c9 c0 91 9e cc 6c   ö...:4..........lö</span>
<span class="err">4a 5d 24 67 c7 aa 21 fe 2c ea e6 ea 9e 8d 95 33   öJÅ$g..!.,......3ö</span>
<span class="err">61 e5 55 2c 13 3c cd 61 21 d1 26 03 47 ba 32 b3   öa.U,.&lt;.a!.&amp;.G.2.ö</span>
<span class="err">09 da cc ce 8e da e4 61 a1 85 34 d6 ba 00 63 5c   ö.......a..4...cÖö</span>
<span class="err">08 f1 63 34 7a 90 44 cb 79 4d 95 50 58 6c e7 55   ö..c4z.D.yM.PXl.Uö</span>
<span class="err">74 d4 da fb 44 4c 8a 48 a8 ae 41 42 b1 e5 44 a8   öt...DL.H..AB..D.ö</span>
<span class="err">e9 bb 42 bb 47 28 3b cd 5e 22 0f 5d 3b 42 e8 d9   ö..B.G(;.Ü&quot;.Å;B..ö</span>
<span class="err">e4 68 93 af 5f ec 99 50 8b d8 7f 03 08 05 8b 04   ö.h.._..P......ö</span>
<span class="err">f5 a3 48 d5 bc 7b 7d 97 33 80 d8 c6 f6 85 57 90   ö..H..äå.3.....W.ö</span>
<span class="err">4b 6a 8c 50 15 17 e4 e2 3a ca ce 7e 55 46 e4 5a   öKj.P....:..üUF.Zö</span>
<span class="err">d4 d9 d5 eb 7d 70 a0 fb d6 a0 98 7d 3e 8f d9 72   ö....åp.....å&gt;..rö</span>
<span class="err">12 6d 08 55 71 41 2e 79 12 93 b3 9f 36 d4 72 5a   ö.m.UqA.y....6.rZö</span>
<span class="err">68 a3 40 78 6b 9a 72 79 8c e9 6e 67 6c b9 cb ce   öh.@xk.ry..ngl...ö</span>
<span class="err">9a 4b 4d ec f8 02 e7 f3 3e fa f8 f8 cd 2f 6e 7e   ö.KM.....&gt;..../nüö</span>
<span class="err">79 d3 c5 a0 96 4f 37 9d f1 46 3b 8e ea 1b 4d 13   öy....O7..F;...M.ö</span>
<span class="err">7a fd 8d c9 ae fb 3e 4d 16 4c 7d e1 e9 63 a1 bc   öz.....&gt;M.Lå..c..ö</span>
<span class="err">eb 47 b5 bc 1d a2 5a de 0c ad 5a 5e 0f 83 5a 1e   ö.G....Z...ZÜ..Z.ö</span>
<span class="err">c7 a0 96 d3 21 d8 ab 72 3a 16 77 5d 9e 4f a7 3c   ö....!..r:.wÅ.O.&lt;ö</span>
<span class="err">2f 2f 07 c1 ad ca e9 64 a7 55 39 9d eb b2 2a a7   ö//.....d.U9...*.ö</span>
<span class="err">d3 1c 56 e5 b4 01 fb aa 9c 36 37 5e 95 d3 fe 9c   ö..V......67Ü....ö</span>
<span class="err">ab 72 da b9 6e 55 4e fb 48 ad ca 69 57 96 f3 f2   ö.r..nUN.H..iW...ö</span>
<span class="err">b2 af c0 aa 9c d6 e9 ae ca 69 85 dd aa 9c 96 b5   ö.........i......ö</span>
<span class="err">ac ca 29 b9 7c 55 4e f9 9b ab 72 ca c2 5a 95 53   ö..).öUN...r..Z.Sö</span>
<span class="err">8e c2 aa 9c a6 b4 56 e5 34 5a 7b 5e 5e 06 75 ce   ö......V.4ZäÜÜ.u.ö</span>
<span class="err">cb 4b 1f ec bc bc b4 8d ce cb 0b 79 b0 fc 47 37   ö.K.........y..G7ö</span>
<span class="err">ff 07 29 f1 43 c1                                 ö..).C.ö</span>
</code></pre></div>

<p>Uno de los problemas de analizar pdf generados en la APN en Venezuela es que no lo generan a partir de la información que manejan directamente de las bases de datos, si no que usan una hoja de cálculo en este caso en windows y la de Microsoft Office, y generan el pdf con herramientas para windows.</p>
<p>¿Será autentica la información que tiene el pdf luego de manipulación con varias herramientas?</p>
<p>En siguientes post seguiré probando distintas herramientas en Python para ver si logro hacer un pdfscraping decente del pdf de Cencoex.</p>
<h2></h2>
<p>¡Haz tu donativo!
Si te gustó el artículo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
dirección: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el código QR desde la billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"></p>
            </div>
            <div class="post_list">
                <span>By </span>
                <a href="https://ecrespo.github.io/author/ernesto-crespo.html">@Ernesto Crespo</a>
                <span> in </span>
                <span class="post_category"><a href="https://ecrespo.github.io/category/tutorial-python.html" rel="bookmark"
                                               title="Permalink to Tutorial Python">[ Tutorial Python ]</a></span>
                <span class="post_date">sáb 29 agosto 2015</span>
                <div><span>Tags : </span>
                            <span><a href="https://ecrespo.github.io/tag/debian.html">#Debian, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/general.html">#General, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/python.html">#Python, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/pdf-scraping.html">#pdf scraping, </a></span>
                </div>

                <div class="entry-social">
                    <span class="twitter"><a target="_blank" rel="nofollow"
                                             onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;"
                                             title="Twitter"
                                             href="https://twitter.com/share?url=https://ecrespo.github.io/extraccion-de-informacion-de-pdfs-con-python-parte-1.html&text=Extracción de información de PDFs con python (parte 1).&via="><img
                            src="https://ecrespo.github.io/theme/images/icons/twitter-s.png"></a></span>

                    <span class="gplus"><a target="_blank" title="Google +"
                                           href="https://plus.google.com/share?url=https://ecrespo.github.io/extraccion-de-informacion-de-pdfs-con-python-parte-1.html&hl=fr"
                                           rel="nofollow"
                                           onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/google-s.png"></a></span>

                    <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow"
                                              onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;"
                                              href="https://www.facebook.com/sharer.php?u=https://ecrespo.github.io/extraccion-de-informacion-de-pdfs-con-python-parte-1.html&t=Extracción de información de PDFs con python (parte 1)."><img
                            src="https://ecrespo.github.io/theme/images/icons/facebook-s.png"></a></span>

                    <a target="_blank" title="Linkedin"
                       href="https://www.linkedin.com/shareArticle?mini=true&url=https://ecrespo.github.io/extraccion-de-informacion-de-pdfs-con-python-parte-1.html&title=Extracción de información de PDFs con python (parte 1)."
                       rel="nofollow"
                       onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/linkedin-s.png"></a>

                    <span class="mail"><a
                            href="mailto:?subject=Extracción de información de PDFs con python (parte 1).&amp;body=Viens découvrir un article à propos de [Extracción de información de PDFs con python (parte 1).] sur le site de Ernesto Crespo. https://ecrespo.github.io/extraccion-de-informacion-de-pdfs-con-python-parte-1.html"
                            title="Share by Email" target="_blank"><img
                            src="https://ecrespo.github.io/theme/images/icons/mail-s.png"></a></span>
                </div>
            </div>
                <div class="comments">
                    <h2>Comments !</h2>
                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_identifier = "extraccion-de-informacion-de-pdfs-con-python-parte-1.html";
                        (function () {
                            var dsq = document.createElement('script');
                            dsq.type = 'text/javascript';
                            dsq.async = true;
                            dsq.src = 'https://https://seraphto.disqus.com.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] ||
                            document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                </div>
        </article>
    </section>
</article>

<!-- Footer -->
    <footer>
        <p>
            Blog powered by <a href="http://getpelican.com/">Pelican</a>,
            which takes great advantage of <a href="http://python.org">Python</a>.
            Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a
                href="https://parbhatpuri.com/">@parbhat</a>.
        </p>
    </footer>

    <!-- Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-131517246-1']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>

</body>
</html>