
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://ecrespo.github.io/theme/font-awesome/css/solid.css">


    <link href="https://ecrespo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Página de Seraph Atom">



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-131517246-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333333">

<meta name="author" content="Ernesto Crespo" />
<meta name="description" content="Este artículo se basa en el artículo de HowtoForge sobre el mismo tema. La idea es cifrar el directorio home del usuario,se monte el directorio cifrado automáticamente al arrancar el equipo. Es necesario tener un respaldo de la carpeta del usuario para evitar perdida de datos si olvida la …" />
<meta name="keywords" content="Linux, Debian, Ubuntu, Canaima, Seguridad, eCryptfs">

<meta property="og:site_name" content="Página de Seraph"/>
<meta property="og:title" content="Como cifrar directorios/particiones con eCryptfs"/>
<meta property="og:description" content="Este artículo se basa en el artículo de HowtoForge sobre el mismo tema. La idea es cifrar el directorio home del usuario,se monte el directorio cifrado automáticamente al arrancar el equipo. Es necesario tener un respaldo de la carpeta del usuario para evitar perdida de datos si olvida la …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ecrespo.github.io/como-cifrar-directoriosparticiones-con-ecryptfs.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2011-08-21 09:00:00-04:30"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://ecrespo.github.io/author/ernesto-crespo.html">
<meta property="article:section" content="Tutorial de Linux"/>
<meta property="article:tag" content="Linux"/>
<meta property="article:tag" content="Debian"/>
<meta property="article:tag" content="Ubuntu"/>
<meta property="article:tag" content="Canaima"/>
<meta property="article:tag" content="Seguridad"/>
<meta property="article:tag" content="eCryptfs"/>
<meta property="og:image" content="//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120">

  <title>Página de Seraph &ndash; Como cifrar directorios/particiones con eCryptfs</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://ecrespo.github.io">
        <img src="//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120" alt="Ernesto Crespo" title="Ernesto Crespo">
      </a>
      <h1><a href="https://ecrespo.github.io">Ernesto Crespo</a></h1>

<p>Data Scientist </p>
      <nav>
        <ul class="list">
          <li><a href="https://ecrespo.github.io/pages/About.html#About">Acerca</a></li>
          <li><a href="https://ecrespo.github.io/pages/Contacto.html#Contacto">Contacto</a></li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-medium" href="https://medium.com/@_seraph1" target="_blank">
            <i class="fab fa-medium">
            </i>
          </a></li>
          <li>
            <a  class="sc-linkedin" href="http://ve.linkedin.com/in/ernestocrespo" target="_blank">
            <i class="fab fa-linkedin">
            </i>
          </a></li>
          <li>
            <a  class="sc-github" href="https://github.com/ecrespo" target="_blank">
            <i class="fab fa-github">
            </i>
          </a></li>
          <li>
            <a  class="sc-google" href="https://google.com/+ErnestoCrespo" target="_blank">
            <i class="fab fa-google">
            </i>
          </a></li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/_seraph1" target="_blank">
            <i class="fab fa-twitter">
            </i>
          </a></li>
          <li>
            <a  class="sc-facebook" href="https://www.facebook.com/ernesto.crespo" target="_blank">
            <i class="fab fa-facebook">
            </i>
          </a></li>
          <li>
            <a  class="sc-gitlab" href="https://gitlab.com/ecrespo" target="_blank">
            <i class="fab fa-gitlab">
            </i>
          </a></li>
          <li>
            <a  class="sc-soundcloud" href="https://soundcloud.com/ernesto-crespo" target="_blank">
            <i class="fab fa-soundcloud">
            </i>
          </a></li>
          <li>
            <a  class="sc-rss" href="//www.seraph.to/feeds/all.atom.xml" target="_blank">
            <i class="fas fa-rss">
            </i>
          </a></li>
      </ul>
    </div>



  </aside>
  <main>

    <nav>
      <a href="https://ecrespo.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://ecrespo.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="como-cifrar-directoriosparticiones-con-ecryptfs">Como cifrar directorios/particiones con eCryptfs</h1>
    <p>
          Posted on dom 21 agosto 2011 in <a href="https://ecrespo.github.io/category/tutorial-de-linux.html">Tutorial de Linux</a>


        &#8226; 3 min read
    </p>
  </header>


  <div>
    <p>Este art&iacute;culo se basa en el art&iacute;culo de HowtoForge sobre el mismo <a href="http://www.howtoforge.net/how-to-encrypt-directories-partitions-with-ecryptfs-on-debian-squeeze">tema</a>.</p>
<p>La idea es cifrar el directorio home del usuario,se monte el directorio cifrado autom&aacute;ticamente al arrancar el equipo.</p>
<p>Es necesario tener un respaldo de la carpeta del usuario para evitar perdida de datos si olvida la clave.</p>
<ol>
<li>Instalar eCryptfs:</li>
</ol>
<p>Se ejecuta:</p>
<div class="highlight"><pre><span></span>aptitude install ecryptfs-utils
</pre></div>
<ol>
<li>Cifrar un directorio.</li>
</ol>
<p>Respaldar los archivos y directorios del home del usuario:</p>
<div class="highlight"><pre><span></span>cp -pfr /home/ecrespo /tmp/
</pre></div>
<p>Cifrar el directorio /home/ecrespo/ al montar el sistema de archivos ecryptfs:</p>
<p>Se selecciona aes, 16, no se habilita frase plana, no se habilita cifrado del nombre del archivo, as&iacute; que con estas opciones s&oacute;lo hay que presionar enter a la informaci&oacute;n que solicite al montar la partici&oacute;n cifrada.</p>
<div class="highlight"><pre><span></span><span class="nt">mount</span> <span class="nt">-t</span> <span class="nt">ecryptfs</span> <span class="o">/</span><span class="nt">home</span><span class="o">/</span><span class="nt">ecrespo</span> <span class="o">/</span><span class="nt">home</span><span class="o">/</span><span class="nt">ecrespo</span>

<span class="nt">Passphrase</span><span class="o">:</span>
<span class="nt">Select</span> <span class="nt">cipher</span><span class="o">:</span>
 <span class="nt">1</span><span class="o">)</span> <span class="nt">aes</span><span class="o">:</span> <span class="nt">blocksize</span> <span class="o">=</span> <span class="nt">16</span><span class="o">;</span> <span class="nt">min</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">16</span><span class="o">;</span> <span class="nt">max</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">32</span> <span class="o">(</span><span class="nt">not</span> <span class="nt">loaded</span><span class="o">)</span>
 <span class="nt">2</span><span class="o">)</span> <span class="nt">blowfish</span><span class="o">:</span> <span class="nt">blocksize</span> <span class="o">=</span> <span class="nt">16</span><span class="o">;</span> <span class="nt">min</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">16</span><span class="o">;</span> <span class="nt">max</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">56</span> <span class="o">(</span><span class="nt">not</span> <span class="nt">loaded</span><span class="o">)</span>
 <span class="nt">3</span><span class="o">)</span> <span class="nt">des3_ede</span><span class="o">:</span> <span class="nt">blocksize</span> <span class="o">=</span> <span class="nt">8</span><span class="o">;</span> <span class="nt">min</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">24</span><span class="o">;</span> <span class="nt">max</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">24</span> <span class="o">(</span><span class="nt">not</span> <span class="nt">loaded</span><span class="o">)</span>
 <span class="nt">4</span><span class="o">)</span> <span class="nt">twofish</span><span class="o">:</span> <span class="nt">blocksize</span> <span class="o">=</span> <span class="nt">16</span><span class="o">;</span> <span class="nt">min</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">16</span><span class="o">;</span> <span class="nt">max</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">32</span> <span class="o">(</span><span class="nt">not</span> <span class="nt">loaded</span><span class="o">)</span>
 <span class="nt">5</span><span class="o">)</span> <span class="nt">cast6</span><span class="o">:</span> <span class="nt">blocksize</span> <span class="o">=</span> <span class="nt">16</span><span class="o">;</span> <span class="nt">min</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">16</span><span class="o">;</span> <span class="nt">max</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">32</span> <span class="o">(</span><span class="nt">not</span> <span class="nt">loaded</span><span class="o">)</span>
 <span class="nt">6</span><span class="o">)</span> <span class="nt">cast5</span><span class="o">:</span> <span class="nt">blocksize</span> <span class="o">=</span> <span class="nt">8</span><span class="o">;</span> <span class="nt">min</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">5</span><span class="o">;</span> <span class="nt">max</span> <span class="nt">keysize</span> <span class="o">=</span> <span class="nt">16</span> <span class="o">(</span><span class="nt">not</span> <span class="nt">loaded</span><span class="o">)</span>
<span class="nt">Selection</span> <span class="cp">[</span><span class="nx">aes</span><span class="cp">]</span><span class="o">:</span>
<span class="nt">Select</span> <span class="nt">key</span> <span class="nt">bytes</span><span class="o">:</span>
 <span class="nt">1</span><span class="o">)</span> <span class="nt">16</span>
 <span class="nt">2</span><span class="o">)</span> <span class="nt">32</span>
 <span class="nt">3</span><span class="o">)</span> <span class="nt">24</span>
<span class="nt">Selection</span> <span class="cp">[</span><span class="mi">16</span><span class="cp">]</span><span class="o">:</span>
<span class="nt">Enable</span> <span class="nt">plaintext</span> <span class="nt">passthrough</span> <span class="o">(</span><span class="nt">y</span><span class="o">/</span><span class="nt">n</span><span class="o">)</span> <span class="cp">[</span><span class="nx">n</span><span class="cp">]</span><span class="o">:</span> <span class="nt">Enter</span>
<span class="nt">Enable</span> <span class="nt">filename</span> <span class="nt">encryption</span> <span class="o">(</span><span class="nt">y</span><span class="o">/</span><span class="nt">n</span><span class="o">)</span> <span class="cp">[</span><span class="nx">n</span><span class="cp">]</span><span class="o">:</span> <span class="nt">Enter</span>
<span class="nt">Attempting</span> <span class="nt">to</span> <span class="nt">mount</span> <span class="nt">with</span> <span class="nt">the</span> <span class="nt">following</span> <span class="nt">options</span><span class="o">:</span>
  <span class="nt">ecryptfs_unlink_sigs</span>
  <span class="nt">ecryptfs_key_bytes</span><span class="o">=</span><span class="nt">16</span>
  <span class="nt">ecryptfs_cipher</span><span class="o">=</span><span class="nt">aes</span>
  <span class="nt">ecryptfs_sig</span><span class="o">=</span><span class="nt">162827f20fdadf4e</span>
<span class="nt">Mounted</span> <span class="nt">eCryptfs</span>
</pre></div>
<ol>
<li>Verificar que la partici&oacute;n se ha montado.</li>
</ol>
<p>El comando mount s&oacute;lo devuelve las particiones que se encuentran montadas en el Linux.</p>
<div class="highlight"><pre><span></span>mount /home/ecrespo on /home/ecrespo type ecryptfs (rw,ecryptfs_sig=162827f20fdadf4e,ecryptfs_cipher=aes,ecryptfs_key_bytes=16,ecryptfs_unlink_sigs)
</pre></div>
<ol>
<li>Recuperar el respaldo y borrar el respaldo del directorio /tmp/</li>
</ol>
<div class="highlight"><pre><span></span>cp -pfr /tmp/ecrespo /home/
rm -fr /tmp/ecrespo
</pre></div>
<ol>
<li>Verificar el funcionamiento del cifrado de archivos.</li>
</ol>
<p>Para prop&oacute;sitos de prueba se copia un archivo de /etc/ al home del usuario.
Mostrar la informaci&oacute;n que contiene el archivo hostname en /etc/</p>
<div class="highlight"><pre><span></span>cat /etc/hostname 
canaima-popular
</pre></div>
<p>Copiar el archivo hostname al home del usuario:</p>
<div class="highlight"><pre><span></span>cp /etc/hostname /home/ecrespo/
</pre></div>
<p>Mientras la partici&oacute;n cifrada se encuentra montada se puede visualizar los archivos:</p>
<div class="highlight"><pre><span></span>cat /home/ecrespo/hostname 
canaima-popular
</pre></div>
<p>Desmontar la partici&oacute;n.</p>
<div class="highlight"><pre><span></span>umount /home/ecrespo/
</pre></div>
<p>Verificar que el archivo est&aacute; cifrado:</p>
<div class="highlight"><pre><span></span>cat /home/ecrespo/hostname
4��ˉ�s|| � "3DUfw`�6���D �̬�����{� _CONSOLE ('��N�pD���-� \ٛn�Ś/��TD��xҝD[:�$] �wq�V��
�n /�k�a:�H.�{ USj�@u)�c ������T� �� �m�иや� � Z�&amp;��0�Q��B�� /��q�e��E��li�"dx�tDs���k����h�J��20��&amp;T�?R�x� �W�$�
                                                                                                                   �$�@ �&amp;
                                                                                                                           ��� �G� /�.L���1d�� j����{cYRꄙZ`��t 8�4ԬZ~ ,)H
eb �� f ��?��
          �_' ��K&amp;�d)����{y�z����ֆ�2x��h�� &amp;j���tuq��a�JeJ�� ���\"~
                                                                   ��5`� V RCB`��������PU�&amp;������X�
                                                                                                    9Ԥ[� 4O.� �� ̔�;/ �����#j V`Sf^��&lt;�uB8 �ЭIx�4PR�� dml��`&amp;c �
! ҟ&amp;`�~�U?u�� �����쵮 @�)�8�Q U��杞M�e��="�}�V# ��&gt;������ �&gt;�F�� R�#ZgI���^J�� ,��0ݼR�rO�f��AxS��3�\�M���o�D �u�Av)�qq%�(F�/���%tL��w�U�k6~c��` &ldquo;=�4N��E�= #� � a7�����v�(V�p�HlR�Y5����#^���K �~ :h��Z�Q�J�{�FC�N;*� 0Bő*���=�
�ՙ��R�mќet ���7B�_�Dz.[�6&gt;�ĸؓ�� �Nc��#��NR��@� 4 �/���M?Om �|;/�Oe9�6��&amp;6D*U�A�e��� �V
�ZM�&lt;ɝ��"�0��0�W&Yuml;L�H�,r
                        �&gt;��f��4�$�wA�rѫ� �0H�����CP�i��&amp;���!b���-#
$ލ;�X!y�� ~� I5e��V|Y�\� �H^&pound;�7�0�Z��{�}"!��͡�� 6�M�!LNȆXvF         )� ��G�Nuɍ� � ӧ��s���t ���t��o&amp;� C������W�#��Cpk�&gt;&lt;&bdquo;
</pre></div>
<ol>
<li>Montar autom&aacute;ticamente  la partici&oacute;n o directorio.</li>
</ol>
<p>Conecte un pendrive y ejecute el comando fdisk -l donde aparecer&aacute; la partici&oacute;n del pendrive:</p>
<div class="highlight"><pre><span></span>fdisk -l
 Disk /dev/sdb: 16.0 GB, 16011542528 bytes
32 heads, 63 sectors/track, 15512 cylinders, 31272544 sectores en total
Units = sectores of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Identificador del disco: 0x59a4123d

Disposit. Inicio    Comienzo      Fin      Bloques  Id  Sistema
/dev/sdb1   *          63    31272191    15636064+   b  W95 FAT32
</pre></div>
<p>Montar el pendrive:</p>
<div class="highlight"><pre><span></span>mkdir /mnt/usb
mount /dev/sdb1 /mnt/usb
</pre></div>
<p>Al ejecutar mount s&oacute;lo mostrar&aacute; las particiones montadas en el equipo:</p>
<div class="highlight"><pre><span></span>mount /dev/sdb1 on /mnt/usb type vfat (rw)
</pre></div>
<p>A diferencia del art&iacute;culo original el pendrive y la partici&oacute;n cifrada no se monta automaticamente.</p>
<p>===</p>
<p>&iexcl;Haz tu donativo!
Si te gust&oacute; el art&iacute;culo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
direcci&oacute;n: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el c&oacute;digo QR desde billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"/></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ecrespo.github.io/tag/linux.html">Linux</a>
      <a href="https://ecrespo.github.io/tag/debian.html">Debian</a>
      <a href="https://ecrespo.github.io/tag/ubuntu.html">Ubuntu</a>
      <a href="https://ecrespo.github.io/tag/canaima.html">Canaima</a>
      <a href="https://ecrespo.github.io/tag/seguridad.html">Seguridad</a>
      <a href="https://ecrespo.github.io/tag/ecryptfs.html">eCryptfs</a>
    </p>
  </div>



  <div class="related-posts">
    <h4>    You might enjoy
</h4>
    <ul class="related-posts">
      <li><a href="https://ecrespo.github.io/compartir-repositorios-de-mercurial-con-mercurial-server.html">Compartir repositorios de Mercurial con mercurial-server</a></li>
      <li><a href="https://ecrespo.github.io/usar-dnsmasq-como-servidor-dns-cache-y-local.html">Usar dnsmasq como servidor DNS cache y local</a></li>
      <li><a href="https://ecrespo.github.io/gestionar-los-archivos-de-configuracion-en-etc-con-etckeeper-y-mercurial.html">Gestionar los archivos de configuración en /etc con etckeeper y mercurial</a></li>
      <li><a href="https://ecrespo.github.io/iniciar-sesion-de-usuario-autenticando-via-pendrive.html">Iniciar sesión de usuario autenticando vía pendrive</a></li>
      <li><a href="https://ecrespo.github.io/como-crear-un-metapaquete-metapaquete-con-archivos-de-configuracion.html">Como crear un metapaquete (metapaquete con archivos de configuración)</a></li>
    </ul>
  </div>


<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'https://seraphto.disqus.com';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>&copy;  2006</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Página de Seraph ",
  "url" : "https://ecrespo.github.io",
  "image": "//s.gravatar.com/avatar/7fab2070e149e57fe99da94d7ccbad6b?s=120",
  "description": " Software Libre, Ciencia de Datos y Python"
}
</script>

</body>
</html>