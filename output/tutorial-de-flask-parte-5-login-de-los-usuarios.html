<!doctype html>
<html lang="es" itemscope itemtype="http://schema.org/Person">
<head>
            <meta charset="utf-8">
        <!-- Site Meta Data -->
        <title>Tutorial de Flask parte 5 (login de los usuarios)</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Ernesto Crespo">

        <link rel="shortcut icon" href="">

        <!-- schema.org -->
        <meta itemprop="name" content="Página de Seraph">
        <meta itemprop="image" content="">
        <meta itemprop="description" content="">

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
        <!-- Style Meta Data -->
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/style.css" type="text/css"/>
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/pygments.css" type="text/css"/>

        <!-- Feed Meta Data -->
            <link href="https://ecrespo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="Página de Seraph ATOM Feed"/>

        <!-- Twitter Feed -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="">
        <meta name="twitter:image" content="">

    <meta name="twitter:creator" content="">
    <meta name="twitter:url" content="https://ecrespo.github.io/tutorial-de-flask-parte-5-login-de-los-usuarios.html">
    <meta name="twitter:title" content="Página de Seraph ~ Tutorial de Flask parte 5 (login de los usuarios)">
    <meta name="twitter:description" content="Continuando con la serie de tutoriales sobre flask, en este caso se usará lo visto en la parte de base de datos para usarlo para iniciar sesión por parte de los usuarios. Los artículos anteriores son: Tutorial de Flask parte 1. Tutorial de Flask parte 2 (plantilla html). Tutorial de …">

    <!-- Facebook Meta Data -->
    <meta property="og:title" content="Página de Seraph ~ Tutorial de Flask parte 5 (login de los usuarios)"/>
    <meta property="og:description" content="Continuando con la serie de tutoriales sobre flask, en este caso se usará lo visto en la parte de base de datos para usarlo para iniciar sesión por parte de los usuarios. Los artículos anteriores son: Tutorial de Flask parte 1. Tutorial de Flask parte 2 (plantilla html). Tutorial de …"/>
    <meta property="og:image" content=""/>
</head>

<body>
<!-- Sidebar -->
<aside>
    <!--<center><a href="https://ecrespo.github.io"><img id="avatar" src=""></a></center>-->
    <h1>Página de Seraph</h1>
    <br>


    <nav class="nav">
        <ul class="list-bare">

                <li><a class="nav__link" href="/archives.html">Archives</a></li>
                <li><a class="nav__link" href="/categories.html">Categories</a></li>
                <li><a class="nav__link" href="/tags.html">Tags</a></li>

                <li><a class="nav__link" href="https://ecrespo.github.io/pages/About.html">Acerca</a></li>
                <li><a class="nav__link" href="https://ecrespo.github.io/pages/Contacto.html">Contacto</a></li>

        </ul>
    </nav>

    <p class="social">
                <a href="https://medium.com/@_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/medium.png"></a>
                <a href="http://ve.linkedin.com/in/ernestocrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/linkedin.png"></a>
                <a href="https://github.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/github.png"></a>
                <a href="https://google.com/+ErnestoCrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/google.png"></a>
                <a href="https://twitter.com/_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/twitter.png"></a>
                <a href="https://www.facebook.com/ernesto.crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/facebook.png"></a>
                <a href="https://gitlab.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/gitlab.png"></a>
                <a href="https://soundcloud.com/ernesto-crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/soundcloud.png"></a>
                <a href="//www.seraph.to/feeds/all.atom.xml" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
            <a href="https://ecrespo.github.io/feeds/all.atom.xml" rel="alternate">
                <img src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
    </p>

        <h2>Categories</h2>
        <ul class="navbar">
                <li><a
                        href="https://ecrespo.github.io/category/accesibilidad.html">Accesibilidad</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncio.html">Anuncio</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncios.html">Anuncios</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/aplicacion-android.html">Aplicación Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/asterisk-debian-linux.html">Asterisk, Debian, Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla.html">Charla</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla-python.html">Charla Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-linux-mac-book.html">Debian, Linux, Mac Book</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-maemo-nokia-n810-python.html">Debian, maemo, Nokia N810, Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/demostracion-aplicacion-para-android.html">Demostración Aplicación para Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/desarrollomovil.html">Desarrollo,Movil</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/evento.html">Evento</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/general.html">General</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linux.html">Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdebian.html">Linux,Debian</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdesarrollo.html">Linux,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxempaquetado.html">Linux,Empaquetado</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxofimaticadesarrollo.html">Linux,Ofimatica,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/movil-nokia.html">Movil, Nokia</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810.html">Nokia N810</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810-debian-maemo.html">Nokia N810 Debian Maemo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/posts.html">posts</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/resumen-2010.html">Resumen 2010</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/sistemas-operativos.html">Sistemas Operativos</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial.html">Tutorial</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-android.html">Tutorial Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-arduino.html">Tutorial de Arduino</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-data-science.html">Tutorial de Data Science</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-docker.html">Tutorial de Docker</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-integracion-continua.html">Tutorial de integración continua</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-linux.html">Tutorial de Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python.html">Tutorial de Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-en-android.html">Tutorial de Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-linux.html">Tutorial de Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-pyqt.html">Tutorial de Python y PyQt</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-debian-bsd-y-python.html">Tutorial Debian BSD y Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux.html">Tutorial Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux-y-python.html">Tutorial Linux y Python</a></li>
                <li class="active"><a
                        href="https://ecrespo.github.io/category/tutorial-python.html">Tutorial Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-en-android.html">Tutorial Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-y-linux.html">Tutorial Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorialdesarrollo.html">Tutorial,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/xml-rpcpython.html">XML-RPC,Python</a></li>
        </ul>


</aside>

<!-- Content -->
<article>
    <section id="content">
        <article>
            <h2 class="post_title post_detail"><a href="https://ecrespo.github.io/tutorial-de-flask-parte-5-login-de-los-usuarios.html" rel="bookmark"
                                                  title="Permalink to Tutorial de Flask parte 5 (login de los usuarios)">Tutorial de Flask parte 5 (login de los usuarios)</a></h2>
            <div class="entry-content blog-post">
                <p>Continuando con la serie de tutoriales sobre flask, en este caso se usará lo visto en la parte de base de datos para usarlo para iniciar sesión por parte de los usuarios.</p>
<p>Los artículos anteriores son:</p>
<ol>
<li>
<p><a href="https://www.seraph.to/tutorial-de-flask-parte-1.html#tutorial-de-flask-parte-1">Tutorial de Flask parte 1.</a></p>
</li>
<li>
<p><a href="https://www.seraph.to/tutorial-de-flask-parte-2-plantillas-html.html#tutorial-de-flask-parte-2-plantillas-html">Tutorial de Flask parte 2 (plantilla html).</a></p>
</li>
<li>
<p><a href="https://www.seraph.to/tutorial-de-flask-parte-3-formulario-web.html#tutorial-de-flask-parte-3-formulario-web">Tutorial de Flask parte 3 (formulario web).</a></p>
</li>
<li>
<p><a href="https://www.seraph.to/tutorial-de-flask-parte-4-base-de-datos-sqlite3.html">Tutorial de Flask parte 4 (Base de datos).</a></p>
</li>
</ol>
<p>Este artículo se basa en el artículo en Inglés de <a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins">The Flask Mega tutorial, Part V: User Logins</a>.</p>
<h4>Compatibilidad con python3</h4>
<p>Para que <code>openid</code> tenga soporte para python3 se hizo una actualización al archivo Dockerfile donde en vez de usar el <code>openid</code> de pip se baja la versión del repositorio github:</p>
<div class="highlight"><pre><span></span><code><span class="n">FROM</span> <span class="n">python</span>


<span class="n">WORKDIR</span> <span class="o">/</span><span class="n">code</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">flask</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">flask</span><span class="o">-</span><span class="n">login</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">git</span><span class="o">+</span><span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mitsuhiko</span><span class="o">/</span><span class="n">flask</span><span class="o">-</span><span class="n">openid</span><span class="o">.</span><span class="n">git</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">flask</span><span class="o">-</span><span class="n">mail</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">flask</span><span class="o">-</span><span class="n">sqlalchemy</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">sqlalchemy</span><span class="o">-</span><span class="n">migrate</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">flask</span><span class="o">-</span><span class="n">whooshalchemy</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">flask</span><span class="o">-</span><span class="n">wtf</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">flask</span><span class="o">-</span><span class="n">babel</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">guess_language</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">flipflop</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">coverage</span>


<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span>  <span class="n">redis</span>


<span class="n">EXPOSE</span> <span class="mi">5000</span>





<span class="n">ADD</span> <span class="o">.</span> <span class="o">/</span><span class="n">code</span>


<span class="n">CMD</span> <span class="n">python</span> <span class="n">run</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>

<p>La estructura de archivos y directorios del proyecto para este artículo es la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="err">tutorial-flask</span>
<span class="err">├── app</span>
<span class="err">│   ├── forms.py</span>
<span class="err">│   ├── __init__.py</span>
<span class="err">│   ├── models.py</span>
<span class="err">│   ├── __pycache__</span>
<span class="err">│   ├── templates</span>
<span class="err">│   │   ├── base.html</span>
<span class="err">│   │   ├── edit.html</span>
<span class="err">│   │   ├── index.html</span>
<span class="err">│   │   ├── login.html</span>
<span class="err">│   │   ├── post.html</span>
<span class="err">│   │   └── user.html</span>
<span class="err">│   └── views.py</span>
<span class="err">├── app.db</span>
<span class="err">├── config.py</span>
<span class="err">├── db_create.py</span>
<span class="err">├── db_downgrade.py</span>
<span class="err">├── db_migrate.py</span>
<span class="err">├── db_repository</span>
<span class="err">│   ├── __init__.py</span>
<span class="err">│   ├── manage.py</span>
<span class="err">│   ├── migrate.cfg</span>
<span class="err">│   ├── __pycache__</span>
<span class="err">│   ├── README</span>
<span class="err">│   └── versions</span>
<span class="err">│       ├── 001_migration.py</span>
<span class="err">│       ├── 002_migration.py</span>
<span class="err">│       ├── __init__.py</span>
<span class="err">│       └── __pycache__</span>
<span class="err">├── db_upgrade.py</span>
<span class="err">├── docker-compose.yml</span>
<span class="err">├── Dockerfile</span>
<span class="err">├── __pycache__</span>
<span class="err">├── README.md</span>
<span class="err">├── run.py</span>
<span class="err">└── tmp</span>
</code></pre></div>

<h4>Revisión de usuario en models.py</h4>
<p>El archivo <code>models.py</code> contiene cambios en la clase User, esta actualización hace que sea amigable para usar <code>flask-login</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#de app se importa db</span>



<span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">db</span>



<span class="c1">#Se crea la tabla User que hereda de db.Model</span>


<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>


    <span class="c1">#Se crea la columna id como clave primaria e integer</span>


    <span class="nb">id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1">#Se crea la columna nickname como string de tamagn 64, como unico.</span>


    <span class="n">usuario</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="mi">64</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1">#Columna correo, de 120 de tamagno del string y unico.</span>


    <span class="n">correo</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1">#Posts. que tiene relacion con la clase Post (tabla post),</span>


    <span class="n">posts</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">relationship</span><span class="p">(</span><span class="s1">&#39;Post&#39;</span><span class="p">,</span> <span class="n">backref</span><span class="o">=</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="s1">&#39;dynamic&#39;</span><span class="p">)</span>





<span class="c1">#Se usa el decorador property, se consulta si esta atenticado</span>


    <span class="nd">@property</span>


    <span class="k">def</span> <span class="nf">is_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="k">return</span> <span class="kc">True</span>





<span class="c1">#Se usa el decorador property y se consulta si esta activo</span>


    <span class="nd">@property</span>


    <span class="k">def</span> <span class="nf">is_active</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="k">return</span> <span class="kc">True</span>





<span class="c1">#Se usa el decorador property, se consulta si es anonimo el usuario</span>


    <span class="nd">@property</span>


    <span class="k">def</span> <span class="nf">is_anonymous</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="k">return</span> <span class="kc">False</span>





<span class="c1">#Se tra el id del usuario</span>


    <span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="k">try</span><span class="p">:</span>


            <span class="k">return</span> <span class="n">unicode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>  <span class="c1"># python 2</span>


        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>


            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>  <span class="c1"># python 3</span>








    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="k">return</span> <span class="s1">&#39;&lt;User </span><span class="si">%r</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usuario</span><span class="p">)</span>





<span class="c1">#Tabla Post que hereda de model</span>


<span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>


    <span class="c1">#Se crea el id del post como entero y clave primaria</span>


    <span class="nb">id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="c1">#Se crea la columna body como string de 140 caracteres</span>


    <span class="n">cuerpo</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="mi">140</span><span class="p">))</span>


    <span class="c1">#Se define la marca de tiempo.</span>


    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">DateTime</span><span class="p">)</span>


    <span class="c1">#Se define el id del usuario, es una clave foranea de la tabla usuario</span>


    <span class="c1">#Columna id.</span>


    <span class="n">user_id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&#39;user.id&#39;</span><span class="p">))</span>





    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="k">return</span> <span class="s1">&#39;&lt;Post </span><span class="si">%r</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cuerpo</span><span class="p">)</span>
</code></pre></div>

<h4>Archivo views.py</h4>
<p>El archivo views.py maneja ahora el inicio de sesión y el fin del mismo. A continuación el contenido del archivo:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se importa render_template, flash,redirect, session,url_for, request y g</span>


<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">flash</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">g</span>


<span class="c1">#Se importa login_user,logout_user,current_user y login_required</span>


<span class="kn">from</span> <span class="nn">flask.ext.login</span> <span class="kn">import</span> <span class="n">login_user</span><span class="p">,</span> <span class="n">logout_user</span><span class="p">,</span> <span class="n">current_user</span><span class="p">,</span> \


    <span class="n">login_required</span>





<span class="c1">#Se importa la aplicacion app, db, lm y oid</span>


<span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">app</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">lm</span><span class="p">,</span> <span class="n">oid</span>


<span class="c1">#De forms.py se importa LoginForm</span>


<span class="kn">from</span> <span class="nn">.forms</span> <span class="kn">import</span> <span class="n">LoginForm</span>


<span class="c1">#Se importa User de models</span>


<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">User</span>





<span class="c1">#Se retorna  el usuario a partir el id de la base de datos</span>


<span class="c1">#la funcion se usara por parte de flask-login</span>


<span class="nd">@lm</span><span class="o">.</span><span class="n">user_loader</span>


<span class="k">def</span> <span class="nf">load_user</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>


    <span class="k">return</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>





<span class="c1">#Se define g.user a partir del usuario actual.</span>


<span class="c1">#Esta funcion corre cada vez que una solicitud se realiza a</span>


<span class="c1">#fin de saber si el usuario hizo login y es el usuario actual</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">before_request</span>


<span class="k">def</span> <span class="nf">before_request</span><span class="p">():</span>


    <span class="n">g</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">current_user</span>








<span class="c1">#Se define la pagina index por defecto y se requiere que haga login el usuario</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/index&#39;</span><span class="p">)</span>


<span class="nd">@login_required</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>


    <span class="c1">#Ahora no se usa un usuario por defecto, se comenta esa linea</span>


    <span class="c1">#Ahora se toma el usuario g.user el cual es el usuario actual</span>


    <span class="n">user</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">user</span>


    <span class="c1">#user = {&#39;usuario&#39;: &#39;Ernesto&#39;}</span>


    <span class="n">posts</span> <span class="o">=</span> <span class="p">[</span>


      <span class="p">{</span>


          <span class="s1">&#39;autor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;usuario&#39;</span><span class="p">:</span> <span class="s1">&#39;John&#39;</span><span class="p">},</span>


          <span class="s1">&#39;asunto&#39;</span><span class="p">:</span> <span class="s1">&#39;Un gran dia en Edimburgo!&#39;</span>


      <span class="p">},</span>


      <span class="p">{</span>


          <span class="s1">&#39;autor&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;usuario&#39;</span><span class="p">:</span> <span class="s1">&#39;Jane&#39;</span><span class="p">},</span>


          <span class="s1">&#39;asunto&#39;</span><span class="p">:</span> <span class="s1">&#39;Civil War, una gran pelicula!&#39;</span>


      <span class="p">}</span>


   <span class="p">]</span>


   <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span>


                         <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Inicio&#39;</span><span class="p">,</span>


                         <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>


                         <span class="n">posts</span><span class="o">=</span><span class="n">posts</span><span class="p">)</span>








<span class="c1">#Se define login con url /login con metodos GET y POST</span>


<span class="c1">#Se define el manejador de login.</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>


<span class="nd">@oid</span><span class="o">.</span><span class="n">loginhandler</span>


<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>


    <span class="c1">#Se consulta si el usuario existe, y si esta autenticado</span>


    <span class="c1">#Se redrcciona a la pagina index</span>


    <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">g</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">:</span>


        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>


    <span class="c1">#Se crea una instancia de LoginForm</span>


    <span class="n">form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">()</span>


    <span class="c1">#Se consulta si validate existe</span>


    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>


        <span class="c1">#Se maneja la sesion a partir del formulario con la variable recuerdame</span>


        <span class="n">session</span><span class="p">[</span><span class="s1">&#39;recuerdame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">recuerdame</span><span class="o">.</span><span class="n">data</span>


        <span class="c1">#Se returna el inicio de login y correo.</span>


        <span class="k">return</span> <span class="n">oid</span><span class="o">.</span><span class="n">try_login</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">openid</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ask_for</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;usuario&#39;</span><span class="p">,</span> <span class="s1">&#39;correo&#39;</span><span class="p">])</span>


    <span class="c1">#Se renderiza la plantilla de login.</span>


    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span>


                         <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Inicio sesion&#39;</span><span class="p">,</span>


                         <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span>


                         <span class="n">providers</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;PROVEEDORES_OPENID&#39;</span><span class="p">])</span>





<span class="c1">#Se define after_login para la llamada de flask-login</span>


<span class="nd">@oid</span><span class="o">.</span><span class="n">after_login</span>


<span class="k">def</span> <span class="nf">after_login</span><span class="p">(</span><span class="n">resp</span><span class="p">):</span>


    <span class="c1">#Si no existe el campo correo o esta vacio</span>


    <span class="c1">#Se devuelve un mensaje de login invalido y se redirecciona</span>


    <span class="c1">#a la pagina de login</span>


    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">correo</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">resp</span><span class="o">.</span><span class="n">correo</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>


        <span class="n">flash</span><span class="p">(</span><span class="s1">&#39;Login invalido, intente de nuevo.&#39;</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">))</span>


    <span class="c1">#Se trae los datos del usuario de la base de datos</span>


    <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="n">resp</span><span class="o">.</span><span class="n">correo</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>


    <span class="c1">#SI el usuario no existe</span>


    <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>


        <span class="c1">#Se trae el usuario de la resp</span>


        <span class="n">usuario</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">usuario</span>


        <span class="c1">#si usuario no existe o esta en blanco</span>


        <span class="c1">#Se toma el nombre del usuario del correo</span>


        <span class="k">if</span> <span class="n">usuario</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">usuario</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>


            <span class="n">usuario</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">correo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


        <span class="c1">#Se agrega el usuario y correo a la base de datos.</span>


        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">usuario</span><span class="o">=</span><span class="n">usuario</span><span class="p">,</span> <span class="n">correo</span><span class="o">=</span><span class="n">resp</span><span class="o">.</span><span class="n">correo</span><span class="p">)</span>


        <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>


        <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


    <span class="c1">#Se define la variable recuerdame como falsa</span>


    <span class="n">recuerdame</span> <span class="o">=</span> <span class="kc">False</span>


    <span class="c1">#Si la variable recuerdame esta en el manejo de session</span>


    <span class="k">if</span> <span class="s1">&#39;recuerdame&#39;</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>


        <span class="c1">#Se asigna el valor que maneja recuerdame en la sesion</span>


        <span class="n">recuerdame</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;recuerdame&#39;</span><span class="p">]</span>


        <span class="n">session</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;recuerdame&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


    <span class="c1">#Se inicia login, pasando el usuario y la variable recuerdame</span>


    <span class="c1">#Se redirecciona de pagina</span>


    <span class="n">login_user</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">remember</span><span class="o">=</span><span class="n">recuerdame</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;next&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>





<span class="c1">#Se define el fin de la sesion cuando se ve la pagina logout</span>


<span class="c1">#Se redirecciona a la pagina index pero primero se finaliza la session</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>


    <span class="n">logout_user</span><span class="p">()</span>


    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>
</code></pre></div>

<p>A continuación se muestra el archivo <code>__init__.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se impostan os, Flask, sqlalchemy,  LoginManager, OpenID y basedir.</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="kn">from</span> <span class="nn">flask.ext.sqlalchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemy</span>

<span class="kn">from</span> <span class="nn">flask.ext.login</span> <span class="kn">import</span> <span class="n">LoginManager</span>

<span class="kn">from</span> <span class="nn">flask.ext.openid</span> <span class="kn">import</span> <span class="n">OpenID</span>

<span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">basedir</span>



<span class="c1">#Se crea la instancia de Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1">#Se carga la configuracion de config.py</span>

<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">)</span>

<span class="c1">#Se carga la info de la base de datos</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>

<span class="c1">#Se maneja login. con la app.</span>

<span class="n">lm</span> <span class="o">=</span> <span class="n">LoginManager</span><span class="p">()</span>

<span class="n">lm</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>

<span class="n">lm</span><span class="o">.</span><span class="n">login_view</span> <span class="o">=</span> <span class="s1">&#39;login&#39;</span>

<span class="c1">#Se define la carga de la info de OPenID</span>

<span class="n">oid</span> <span class="o">=</span> <span class="n">OpenID</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">))</span>



<span class="c1">#Se importa views y models de app</span>

<span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">views</span><span class="p">,</span> <span class="n">models</span>
</code></pre></div>

<h4>Archivo base.html</h4>
<p>Este archivo ahora maneja el manejo de sesión que se hizo en <code>views.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;html&gt;</span>


  <span class="nt">&lt;head&gt;</span>


    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">title</span> <span class="cp">%}</span>


    <span class="nt">&lt;title&gt;</span><span class="cp">{{</span> <span class="nv">title</span> <span class="cp">}}</span> - microblog<span class="nt">&lt;/title&gt;</span>


    <span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>


    <span class="nt">&lt;title&gt;</span>microblog<span class="nt">&lt;/title&gt;</span>


    <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>


  <span class="nt">&lt;/head&gt;</span>


  <span class="nt">&lt;body&gt;</span>


    <span class="nt">&lt;div&gt;</span>Microblog:


        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;index&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span>


        <span class="cp">{%</span> <span class="k">if</span> <span class="nv">g.user.is_authenticated</span> <span class="cp">%}</span>


        | <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s1">&#39;logout&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/a&gt;</span>


        <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>


    <span class="nt">&lt;/div&gt;</span>


    <span class="nt">&lt;hr&gt;</span>


    <span class="cp">{%</span> <span class="k">with</span> <span class="nv">messages</span> <span class="o">=</span> <span class="nv">get_flashed_messages</span><span class="o">()</span> <span class="cp">%}</span>


    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">messages</span> <span class="cp">%}</span>


    <span class="nt">&lt;ul&gt;</span>


    <span class="cp">{%</span> <span class="k">for</span> <span class="nv">message</span> <span class="k">in</span> <span class="nv">messages</span> <span class="cp">%}</span>


        <span class="nt">&lt;li&gt;</span><span class="cp">{{</span> <span class="nv">message</span> <span class="cp">}}</span> <span class="nt">&lt;/li&gt;</span>


    <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>


    <span class="nt">&lt;/ul&gt;</span>


    <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>


    <span class="cp">{%</span> <span class="k">endwith</span> <span class="cp">%}</span>


    <span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>


  <span class="nt">&lt;/body&gt;</span>


<span class="nt">&lt;/html&gt;</span>
</code></pre></div>

<p>Se construye la imagen Docker:</p>
<div class="highlight"><pre><span></span><code><span class="err">docker-compose build</span>
<span class="err">docker-compose up</span>
</code></pre></div>

<p>Al iniciar la aplicación se tiene la siguiente salida:</p>
<div class="highlight"><pre><span></span><code><span class="err">Recreating tutorialflask_tutorial_1</span>
<span class="err">Attaching to tutorialflask_tutorial_1</span>
<span class="err">tutorial_1 |  * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</span>
<span class="err">tutorial_1 |  * Restarting with stat</span>
<span class="err">tutorial_1 |  * Debugger is active!</span>
<span class="err">tutorial_1 |  * Debugger pin code: 733-227-386</span>
</code></pre></div>

<p>El código fuente en gitlab tiene los siguientes cambios:</p>
<ul>
<li>Manejo del código y la página en Inglés (ya que en artículo futuro se usará internacionalización).  </li>
<li>Es necesario deshabilitar las notificaiones de track de sqlalchemy en el archivo config.py:
SQLALCHEMY_TRACK_MODIFICATIONS = False</li>
<li>Se cambian módulos deprecados por otros actualizados, los módulos atualizados son:  <ul>
<li>flask_login</li>
<li>flask_openid</li>
<li>flask_sqlalchemy</li>
</ul>
</li>
</ul>
<p>El repositorio lo pueden ver <a href="https://gitlab.com/ecrespo/tutorial-flask/tree/articulo5">acá</a>.</p>
<p>Al abrir el navegador en http://localhost:5000 se tiene la siguiente figura:</p>
<p><img alt="" src="./images/tutorialdeflask5-1.png"></p>
<p>Al llenar el formulario se tiene la siguiente figura (el mensaje que pide iniciar sesión para acceder a la página se eliminó):</p>
<p><img alt="" src="./images/tutorialdeflask5-2.png"></p>
<p>Para hacer logout se abre el siguiente enlace http://localhost:5000/logout , lo cual cierra la sesión regresa a la página de inicio.</p>
<p>Los mensajes de la aplicación son los siguientes:</p>
<div class="highlight"><pre><span></span><code><span class="err">tutorial_1 | 172.17.0.1 - - [25/Sep/2016 01:13:39] &quot;GET / HTTP/1.1&quot; 302 -</span>
<span class="err">tutorial_1 | 172.17.0.1 - - [25/Sep/2016 01:13:39] &quot;GET /login?next=%2F HTTP/1.1&quot; 200 -</span>
<span class="err">tutorial_1 | 172.17.0.1 - - [25/Sep/2016 01:15:48] &quot;POST /login?next=%2F HTTP/1.1&quot; 302 -</span>
<span class="err">tutorial_1 | 172.17.0.1 - - [25/Sep/2016 01:15:48] &quot;GET /login?next=/ HTTP/1.1&quot; 200 -</span>
<span class="err">tutorial_1 | 172.17.0.1 - - [25/Sep/2016 01:18:23] &quot;GET /logout HTTP/1.1&quot; 302 -</span>
<span class="err">tutorial_1 | 172.17.0.1 - - [25/Sep/2016 01:18:23] &quot;GET /index HTTP/1.1&quot; 302 -</span>
<span class="err">tutorial_1 | 172.17.0.1 - - [25/Sep/2016 01:18:23] &quot;GET /login?next=%2Findex HTTP/1.1&quot; 200 -</span>
</code></pre></div>

<p>Se nota los redireccionamientos de la página index a la de login y la de logout a la index y luego a login.</p>
<p>Para seguir correctamente el tutorial se recomienda bajar el código fuente del repositorio.</p>
<h2></h2>
<p>¡Haz tu donativo!
Si te gustó el artículo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
dirección: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el código QR desde la billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"></p>
            </div>
            <div class="post_list">
                <span>By </span>
                <a href="https://ecrespo.github.io/author/ernesto-crespo.html">@Ernesto Crespo</a>
                <span> in </span>
                <span class="post_category"><a href="https://ecrespo.github.io/category/tutorial-python.html" rel="bookmark"
                                               title="Permalink to Tutorial Python">[ Tutorial Python ]</a></span>
                <span class="post_date">sáb 24 septiembre 2016</span>
                <div><span>Tags : </span>
                            <span><a href="https://ecrespo.github.io/tag/python.html">#Python, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/flask.html">#Flask, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/docker.html">#Docker, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/sqlite3.html">#Sqlite3, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/sqlalchemy.html">#SQLAlchemy, </a></span>
                </div>

                <div class="entry-social">
                    <span class="twitter"><a target="_blank" rel="nofollow"
                                             onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;"
                                             title="Twitter"
                                             href="https://twitter.com/share?url=https://ecrespo.github.io/tutorial-de-flask-parte-5-login-de-los-usuarios.html&text=Tutorial de Flask parte 5 (login de los usuarios)&via="><img
                            src="https://ecrespo.github.io/theme/images/icons/twitter-s.png"></a></span>

                    <span class="gplus"><a target="_blank" title="Google +"
                                           href="https://plus.google.com/share?url=https://ecrespo.github.io/tutorial-de-flask-parte-5-login-de-los-usuarios.html&hl=fr"
                                           rel="nofollow"
                                           onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/google-s.png"></a></span>

                    <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow"
                                              onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;"
                                              href="https://www.facebook.com/sharer.php?u=https://ecrespo.github.io/tutorial-de-flask-parte-5-login-de-los-usuarios.html&t=Tutorial de Flask parte 5 (login de los usuarios)"><img
                            src="https://ecrespo.github.io/theme/images/icons/facebook-s.png"></a></span>

                    <a target="_blank" title="Linkedin"
                       href="https://www.linkedin.com/shareArticle?mini=true&url=https://ecrespo.github.io/tutorial-de-flask-parte-5-login-de-los-usuarios.html&title=Tutorial de Flask parte 5 (login de los usuarios)"
                       rel="nofollow"
                       onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/linkedin-s.png"></a>

                    <span class="mail"><a
                            href="mailto:?subject=Tutorial de Flask parte 5 (login de los usuarios)&amp;body=Viens découvrir un article à propos de [Tutorial de Flask parte 5 (login de los usuarios)] sur le site de Ernesto Crespo. https://ecrespo.github.io/tutorial-de-flask-parte-5-login-de-los-usuarios.html"
                            title="Share by Email" target="_blank"><img
                            src="https://ecrespo.github.io/theme/images/icons/mail-s.png"></a></span>
                </div>
            </div>
                <div class="comments">
                    <h2>Comments !</h2>
                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_identifier = "tutorial-de-flask-parte-5-login-de-los-usuarios.html";
                        (function () {
                            var dsq = document.createElement('script');
                            dsq.type = 'text/javascript';
                            dsq.async = true;
                            dsq.src = 'https://https://seraphto.disqus.com.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] ||
                            document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                </div>
        </article>
    </section>
</article>

<!-- Footer -->
    <footer>
        <p>
            Blog powered by <a href="http://getpelican.com/">Pelican</a>,
            which takes great advantage of <a href="http://python.org">Python</a>.
            Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a
                href="https://parbhatpuri.com/">@parbhat</a>.
        </p>
    </footer>

    <!-- Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-131517246-1']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>

</body>
</html>