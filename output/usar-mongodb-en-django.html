<!doctype html>
<html lang="es" itemscope itemtype="http://schema.org/Person">
<head>
            <meta charset="utf-8">
        <!-- Site Meta Data -->
        <title>Usar mongodb en Django</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Ernesto Crespo">

        <link rel="shortcut icon" href="">

        <!-- schema.org -->
        <meta itemprop="name" content="Página de Seraph">
        <meta itemprop="image" content="">
        <meta itemprop="description" content="">

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
        <!-- Style Meta Data -->
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/style.css" type="text/css"/>
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/pygments.css" type="text/css"/>

        <!-- Feed Meta Data -->
            <link href="https://ecrespo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="Página de Seraph ATOM Feed"/>

        <!-- Twitter Feed -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="">
        <meta name="twitter:image" content="">

    <meta name="twitter:creator" content="">
    <meta name="twitter:url" content="https://ecrespo.github.io/usar-mongodb-en-django.html">
    <meta name="twitter:title" content="Página de Seraph ~ Usar mongodb en Django">
    <meta name="twitter:description" content="En artículos anteriores se ha tocado el tema de mongodb y el tema de Django. En este caso se tocará el tema de crear un blog con Django usando mongodb, este artículo se basa en un artículo en Inglés del sitio Developers Work de IBM . En este caso se tendrá …">

    <!-- Facebook Meta Data -->
    <meta property="og:title" content="Página de Seraph ~ Usar mongodb en Django"/>
    <meta property="og:description" content="En artículos anteriores se ha tocado el tema de mongodb y el tema de Django. En este caso se tocará el tema de crear un blog con Django usando mongodb, este artículo se basa en un artículo en Inglés del sitio Developers Work de IBM . En este caso se tendrá …"/>
    <meta property="og:image" content=""/>
</head>

<body>
<!-- Sidebar -->
<aside>
    <!--<center><a href="https://ecrespo.github.io"><img id="avatar" src=""></a></center>-->
    <h1>Página de Seraph</h1>
    <br>


    <nav class="nav">
        <ul class="list-bare">

                <li><a class="nav__link" href="/archives.html">Archives</a></li>
                <li><a class="nav__link" href="/categories.html">Categories</a></li>
                <li><a class="nav__link" href="/tags.html">Tags</a></li>

                <li><a class="nav__link" href="https://ecrespo.github.io/pages/About.html">Acerca</a></li>
                <li><a class="nav__link" href="https://ecrespo.github.io/pages/Contacto.html">Contacto</a></li>

        </ul>
    </nav>

    <p class="social">
                <a href="https://medium.com/@_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/medium.png"></a>
                <a href="http://ve.linkedin.com/in/ernestocrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/linkedin.png"></a>
                <a href="https://github.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/github.png"></a>
                <a href="https://google.com/+ErnestoCrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/google.png"></a>
                <a href="https://twitter.com/_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/twitter.png"></a>
                <a href="https://www.facebook.com/ernesto.crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/facebook.png"></a>
                <a href="https://gitlab.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/gitlab.png"></a>
                <a href="https://soundcloud.com/ernesto-crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/soundcloud.png"></a>
                <a href="//www.seraph.to/feeds/all.atom.xml" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
            <a href="https://ecrespo.github.io/feeds/all.atom.xml" rel="alternate">
                <img src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
    </p>

        <h2>Categories</h2>
        <ul class="navbar">
                <li><a
                        href="https://ecrespo.github.io/category/accesibilidad.html">Accesibilidad</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncio.html">Anuncio</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncios.html">Anuncios</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/aplicacion-android.html">Aplicación Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/asterisk-debian-linux.html">Asterisk, Debian, Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla.html">Charla</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla-python.html">Charla Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-linux-mac-book.html">Debian, Linux, Mac Book</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-maemo-nokia-n810-python.html">Debian, maemo, Nokia N810, Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/demostracion-aplicacion-para-android.html">Demostración Aplicación para Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/desarrollomovil.html">Desarrollo,Movil</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/evento.html">Evento</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/general.html">General</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linux.html">Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdebian.html">Linux,Debian</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdesarrollo.html">Linux,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxempaquetado.html">Linux,Empaquetado</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxofimaticadesarrollo.html">Linux,Ofimatica,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/movil-nokia.html">Movil, Nokia</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810.html">Nokia N810</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810-debian-maemo.html">Nokia N810 Debian Maemo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/posts.html">posts</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/resumen-2010.html">Resumen 2010</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/sistemas-operativos.html">Sistemas Operativos</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial.html">Tutorial</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-android.html">Tutorial Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-arduino.html">Tutorial de Arduino</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-data-science.html">Tutorial de Data Science</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-docker.html">Tutorial de Docker</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-integracion-continua.html">Tutorial de integración continua</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-linux.html">Tutorial de Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python.html">Tutorial de Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-en-android.html">Tutorial de Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-linux.html">Tutorial de Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-pyqt.html">Tutorial de Python y PyQt</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-debian-bsd-y-python.html">Tutorial Debian BSD y Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux.html">Tutorial Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux-y-python.html">Tutorial Linux y Python</a></li>
                <li class="active"><a
                        href="https://ecrespo.github.io/category/tutorial-python.html">Tutorial Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-en-android.html">Tutorial Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-y-linux.html">Tutorial Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorialdesarrollo.html">Tutorial,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/xml-rpcpython.html">XML-RPC,Python</a></li>
        </ul>


</aside>

<!-- Content -->
<article>
    <section id="content">
        <article>
            <h2 class="post_title post_detail"><a href="https://ecrespo.github.io/usar-mongodb-en-django.html" rel="bookmark"
                                                  title="Permalink to Usar mongodb en Django">Usar mongodb en Django</a></h2>
            <div class="entry-content blog-post">
                <p>En artículos anteriores se ha tocado el tema de <a href="https://www.seraph.to/tag/mongodb.html">mongodb</a> y el tema de <a href="https://www.seraph.to/tag/django.html">Django</a>.</p>
<p>En este caso se tocará el tema de crear un blog con Django usando mongodb, este artículo se basa en un artículo en Inglés del sitio <a href="https://developer.ibm.com/tutorials/os-django-mongo/">Developers Work de IBM</a> .</p>
<p>En este caso se tendrá un formulario para crear post, actualizarlos y borrarlos. Se usará la plantilla de material design para Django explicado en el artículo <a href="https://www.seraph.to/darle-estilo-material-design-a-django-parte-1-el-admin.html#darle-estilo-material-design-a-django-parte-1-el-admin">anterior</a>.</p>
<p>Para poder desarrollar la aplicación en Django y con mongodb se tiene que instalar <code>Django</code>, <code>mongodb</code> y <code>mongoengine</code> a continuación se muestra la instalación a lo Debian:</p>
<div class="highlight"><pre><span></span><code><span class="err">apt-get install python-mongoengine mongodb-server mongodb-clients mongodb python3-pymongo python3-pymongo-ext python-django python3-django</span>
</code></pre></div>

<p>Lo primero que se tiene que hacer es crear el proyecto blog.</p>
<div class="highlight"><pre><span></span><code><span class="n">django</span><span class="o">-</span><span class="n">admin</span> <span class="n">startproject</span> <span class="n">blog</span>
</code></pre></div>

<p>Esto crea directorios y archivos como se muestra a continuación:</p>
<div class="highlight"><pre><span></span><code><span class="err">blog</span>
<span class="err">├── blog</span>
<span class="err">│   ├── __init__.py</span>
<span class="err">│   ├── settings.py</span>
<span class="err">│   ├── urls.py</span>
<span class="err">│   └── wsgi.py</span>
<span class="err">└── manage.py</span>
</code></pre></div>

<p>Ahora se crea la aplicación posts:</p>
<div class="highlight"><pre><span></span><code><span class="err">django-admin startapp posts</span>
</code></pre></div>

<p>Ahora se tiene la siguiente estructura de directorios y archivos:</p>
<div class="highlight"><pre><span></span><code><span class="err">blog</span>
<span class="err">├── blog</span>
<span class="err">│   ├── __init__.py</span>
<span class="err">│   ├── __init__.pyc</span>
<span class="err">│   ├── settings.py</span>
<span class="err">│   ├── settings.pyc</span>
<span class="err">│   ├── urls.py</span>
<span class="err">│   └── wsgi.py</span>
<span class="err">├── manage.py</span>
<span class="err">└── posts</span>
<span class="err">    ├── admin.py</span>
<span class="err">    ├── __init__.py</span>
<span class="err">    ├── migrations</span>
<span class="err">    │   └── __init__.py</span>
<span class="err">    ├── models.py</span>
<span class="err">    ├── tests.py</span>
<span class="err">    └── views.py</span>
</code></pre></div>

<p>Modificar el archivo <code>blog/blog/settings.py</code> para que refleje el uso de <code>mongodb</code> y la aplicación.</p>
<p>Es necesario agregar en las primeras líneas del <code>settings.py</code> el nombre de la base de datos para <code>mongodb</code>:</p>
<div class="highlight"><pre><span></span><code><span class="err">DBNAME = &#39;blongo&#39;</span>
</code></pre></div>

<p>Agregar en las aplicaciones posts y el soporte a material-design que se explico en artículo <a href="http://blog.crespo.org.ve/2015/04/darle-estilo-material-desing-django.html">anterior</a>.</p>
<div class="highlight"><pre><span></span><code><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;material&#39;</span><span class="p">,</span>
    <span class="s1">&#39;material.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
    <span class="s1">&#39;posts&#39;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<p>Se modifica también el <code>settings.py</code> para que procese el directorio donde estarán las plantillas:</p>
<div class="highlight"><pre><span></span><code><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DIRS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span> <span class="p">)],</span>
        <span class="s1">&#39;APP_DIRS&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;context_processors&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s1">&#39;django.template.context_processors.debug&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.template.context_processors.request&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.contrib.auth.context_processors.auth&#39;</span><span class="p">,</span>
                <span class="s1">&#39;django.contrib.messages.context_processors.messages&#39;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">]</span>
</code></pre></div>

<p>Se crean los directorios <code>templates</code> y <code>media</code>:</p>
<div class="highlight"><pre><span></span><code><span class="err">mkdir -p {templates,static}</span>
</code></pre></div>

<p>Y en media se crean los directorios <code>css</code>, <code>images</code> y <code>js</code>:</p>
<div class="highlight"><pre><span></span><code><span class="err">mkdir -p static/{css,images,js}</span>
</code></pre></div>

<p>Ahora la estructura de directorios queda de la siguiente manera:</p>
<div class="highlight"><pre><span></span><code><span class="n">blog</span>
<span class="err">├──</span> <span class="n">blog</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">pyc</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">settings</span><span class="o">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">settings</span><span class="o">.</span><span class="n">pyc</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">urls</span><span class="o">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">wsgi</span><span class="o">.</span><span class="n">py</span>
<span class="err">├──</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span>
<span class="err">├──</span> <span class="n">posts</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">admin</span><span class="o">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">migrations</span>
<span class="err">│</span>   <span class="err">│</span>   <span class="err">└──</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">models</span><span class="o">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">tests</span><span class="o">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">views</span><span class="o">.</span><span class="n">py</span>
<span class="err">├──</span> <span class="n">static</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">css</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">images</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">js</span>
<span class="err">└──</span> <span class="n">templates</span>
</code></pre></div>

<p>En el directorio <code>posts</code> se modifica el archivo <code>models.py</code> con el siguiente contenido:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se importa models</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="c1">#Se importa mongoengine quien es el que facilita la conexión a mongodb</span>
<span class="kn">from</span> <span class="nn">mongoengine</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">#Se trae el nombre de la base de datos de mongodb de settings.py</span>
<span class="kn">from</span> <span class="nn">blog.settings</span> <span class="kn">import</span> <span class="n">DBNAME</span>

<span class="c1">#Se conecta a la base de datos</span>
<span class="n">connect</span><span class="p">(</span><span class="n">DBNAME</span><span class="p">)</span>


<span class="c1">#Se crea la tabla Posts (documento), con title, content y la fecha de publicación y/o actualización</span>
<span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">Document</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">StringField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">StringField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">last_update</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p>Se modifica el archivo <code>blog/posts/views.py</code> con el siguiente contenido (ahí se publica el formulario, la lista de posts, se actualiza cada post y se puede borrar cada post):</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span><span class="p">,</span> <span class="n">render_to_response</span>
<span class="kn">from</span> <span class="nn">django.template</span> <span class="kn">import</span> <span class="n">RequestContext</span>

<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">Post</span>

<span class="kn">import</span> <span class="nn">datetime</span>

<span class="c1">#Se define index donde recibe como argumento request</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1">#SI el metodo es un post, se toma los datos del formulario y se guarda en</span>
    <span class="c1">#mongodb</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
       <span class="c1"># nuevo post</span>
       <span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
       <span class="n">content</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span>

       <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
       <span class="n">post</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
       <span class="n">post</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
       <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
   <span class="c1">#Si el metodo es get entonces se está cargando la página inicialmente, así que se publican</span>
   <span class="c1">#los posts</span>
    <span class="c1"># se obtiene todos los posts de la base de datos</span>
    <span class="n">posts</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span>
    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Posts&#39;</span><span class="p">:</span> <span class="n">posts</span><span class="p">},</span><span class="n">context_instance</span><span class="o">=</span><span class="n">RequestContext</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>


<span class="c1">#Actualizar un post</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1">#Captura el id del post</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;request.&quot;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">+</span> <span class="s2">&quot;[&#39;id&#39;]&quot;</span><span class="p">)</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#Si el metodo es post, se está actualizando la información del formulario</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>

        <span class="c1"># se actualiza los valores y se salva en mongodb</span>
        <span class="n">post</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
        <span class="n">post</span><span class="o">.</span><span class="n">last_update</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">post</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span>
        <span class="n">post</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;index.html&#39;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Posts&#39;</span><span class="p">:</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="p">}</span>
    <span class="c1">#Si el metodo es GET se muestra la página incial update.html</span>
    <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;update.html&#39;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;post&#39;</span><span class="p">:</span><span class="n">post</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">context_instance</span><span class="o">=</span><span class="n">RequestContext</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>

<span class="c1">#Para borrar un posts</span>
<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1">#Se toma el id del post</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;request.&quot;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">+</span> <span class="s2">&quot;[&#39;id&#39;]&quot;</span><span class="p">)</span>
    <span class="c1">#Se pregunta si es POST, se le pasa el id del posts y se borra, se va a la página index.html</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">post</span> <span class="o">=</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">post</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;index.html&#39;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Posts&#39;</span><span class="p">:</span> <span class="n">Post</span><span class="o">.</span><span class="n">objects</span><span class="p">}</span>
    <span class="c1">#Si es un metodo get entonces se muestra la página delete.html</span>
    <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;delete.html&#39;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="nb">id</span> <span class="p">}</span>

    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">context_instance</span><span class="o">=</span><span class="n">RequestContext</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</code></pre></div>

<p>Ahora se mostrarán las imágenes de los archivos <code>base.html</code>, <code>index.html</code>, <code>update.html</code> y <code>delete.html</code>.</p>
<p>En el archivo <code>base.html</code> se agregarán las siguientes dos líneas las cuales permiten que se use el estilo y javascript a lo material design:</p>
<div class="highlight"><pre><span></span><code><span class="err">{% include &#39;material/includes/material_css.html&#39; %}</span>
<span class="err">{% include &#39;material/includes/material_js.html&#39; %}</span>
</code></pre></div>

<p><img alt="" src="./images/usarmongodbendjango-1.png"></p>
<p>Los archivos <code>index.html</code>, <code>update.html</code> y <code>delete.html</code> tendrán 2 líneas, en una heredan el contenido  del archivo <code>base.html</code> y en la otra línea se carga material_form (material design):</p>
<div class="highlight"><pre><span></span><code><span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;base.html&#39;</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">load</span> <span class="nv">material_form</span> <span class="cp">%}</span><span class="x">  </span>
</code></pre></div>

<p>En el caso que se tenga un formulario se debe colocar después del token <code>csrf</code> la siguiente línea:</p>
<div class="highlight"><pre><span></span><code><span class="err">{% form form=form %}{% endform %}</span>
</code></pre></div>

<p>Ya con eso se manejan los formularios con el estilo material design.</p>
<p>A continuación se muestra la imagen del archivo <code>index.html</code>:</p>
<p><img alt="" src="./images/usarmongodbendjango-2.png"></p>
<p>A continuación se muestra la imagen del archivo <code>update.html</code>:</p>
<p><img alt="" src="./images/usarmongodbendjango-3.png"></p>
<p>A continuación se muestra la imagen del archivo <code>delete.html</code>:</p>
<p><img alt="" src="./images/usarmongodbendjango-4.png"></p>
<p>Para que esto funcione falta modificar el archivo <code>blog/blog/urls.py</code> con los urls del index, update y delete:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="s1">&#39;posts.views.index&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^update/&#39;</span><span class="p">,</span> <span class="s1">&#39;posts.views.update&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^delete/&#39;</span><span class="p">,</span> <span class="s1">&#39;posts.views.delete&#39;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>

<p>Se crea la base de datos administrativa con el comando <code>migrate</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">./</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span>
<span class="n">Operations</span> <span class="n">to</span> <span class="n">perform</span><span class="p">:</span>
  <span class="n">Synchronize</span> <span class="n">unmigrated</span> <span class="n">apps</span><span class="p">:</span> <span class="n">staticfiles</span><span class="p">,</span> <span class="n">posts</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">messages</span><span class="p">,</span> <span class="n">material_admin</span>
  <span class="n">Apply</span> <span class="nb">all</span> <span class="n">migrations</span><span class="p">:</span> <span class="n">admin</span><span class="p">,</span> <span class="n">contenttypes</span><span class="p">,</span> <span class="n">auth</span><span class="p">,</span> <span class="n">sessions</span>
<span class="n">Synchronizing</span> <span class="n">apps</span> <span class="n">without</span> <span class="n">migrations</span><span class="p">:</span>
  <span class="n">Creating</span> <span class="n">tables</span><span class="o">...</span>
    <span class="n">Running</span> <span class="n">deferred</span> <span class="n">SQL</span><span class="o">...</span>
  <span class="n">Installing</span> <span class="n">custom</span> <span class="n">SQL</span><span class="o">...</span>
<span class="n">Running</span> <span class="n">migrations</span><span class="p">:</span>
  <span class="n">Rendering</span> <span class="n">model</span> <span class="n">states</span><span class="o">...</span> <span class="n">DONE</span>
  <span class="n">Applying</span> <span class="n">contenttypes</span><span class="o">.</span><span class="mi">0001</span><span class="n">_initial</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">auth</span><span class="o">.</span><span class="mi">0001</span><span class="n">_initial</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">admin</span><span class="o">.</span><span class="mi">0001</span><span class="n">_initial</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">contenttypes</span><span class="o">.</span><span class="mi">0002</span><span class="n">_remove_content_type_name</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">auth</span><span class="o">.</span><span class="mi">0002</span><span class="n">_alter_permission_name_max_length</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">auth</span><span class="o">.</span><span class="mi">0003</span><span class="n">_alter_user_email_max_length</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">auth</span><span class="o">.</span><span class="mi">0004</span><span class="n">_alter_user_username_opts</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">auth</span><span class="o">.</span><span class="mi">0005</span><span class="n">_alter_user_last_login_null</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">auth</span><span class="o">.</span><span class="mi">0006</span><span class="n">_require_contenttypes_0002</span><span class="o">...</span> <span class="n">OK</span>
  <span class="n">Applying</span> <span class="n">sessions</span><span class="o">.</span><span class="mi">0001</span><span class="n">_initial</span><span class="o">...</span> <span class="n">OK</span>
</code></pre></div>

<p>Se crea la cuenta administrativa:</p>
<div class="highlight"><pre><span></span><code><span class="o">./</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">createsuperuser</span>
<span class="n">Username</span> <span class="p">(</span><span class="n">leave</span> <span class="n">blank</span> <span class="n">to</span> <span class="n">use</span> <span class="s1">&#39;ecrespo&#39;</span><span class="p">):</span> <span class="n">ernesto</span>
<span class="n">Email</span> <span class="n">address</span><span class="p">:</span> <span class="n">ecrespo</span><span class="nd">@xxxx</span><span class="o">.</span><span class="n">xxx</span>
<span class="n">Password</span><span class="p">:</span>
<span class="n">Password</span> <span class="p">(</span><span class="n">again</span><span class="p">):</span>
<span class="n">Superuser</span> <span class="n">created</span> <span class="n">successfully</span><span class="o">.</span>
</code></pre></div>

<p>Se ejecuta el servidor de django:</p>
<div class="highlight"><pre><span></span><code><span class="o">./</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">runserver</span>
<span class="n">Performing</span> <span class="n">system</span> <span class="n">checks</span><span class="o">...</span>

<span class="n">System</span> <span class="n">check</span> <span class="n">identified</span> <span class="n">no</span> <span class="n">issues</span> <span class="p">(</span><span class="mi">0</span> <span class="n">silenced</span><span class="p">)</span><span class="o">.</span>
<span class="n">May</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2015</span> <span class="o">-</span> <span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">27</span>
<span class="n">Django</span> <span class="n">version</span> <span class="mf">1.8</span><span class="p">,</span> <span class="n">using</span> <span class="n">settings</span> <span class="s1">&#39;blog.settings&#39;</span>
<span class="n">Starting</span> <span class="n">development</span> <span class="n">server</span> <span class="n">at</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span>
<span class="n">Quit</span> <span class="n">the</span> <span class="n">server</span> <span class="k">with</span> <span class="n">CONTROL</span><span class="o">-</span><span class="n">C</span><span class="o">.</span>
</code></pre></div>

<p>A continuación se muestra una imagen de la aplicación mientras se llena el formulario:</p>
<p><img alt="" src="./images/usarmongodbendjango-4.png"></p>
<p>Por último se muestra el post que se acaba de publicar:</p>
<p><img alt="" src="./images/usarmongodbendjango-5.png"></p>
<p>Para más información pueden revisar los siguientes enlaces:</p>
<ul>
<li><a href="http://api.mongodb.org/python/1.6/tools.html">http://api.mongodb.org/python/1.6/tools.html</a></li>
<li><a href="http://www.peterbe.com/plog/using-mongodb-in-your-django-app/django-mongodb-html5-slides/html5.html#slide1">http://www.peterbe.com/plog/using-mongodb-in-your-django-app/django-mongodb-html5-slides/html5.html#slide1</a></li>
<li><a href="http://staltz.com/djangoconfi-mongoengine/#/">http://staltz.com/djangoconfi-mongoengine/#/</a></li>
<li><a href="https://django-mongodb-engine.readthedocs.org/en/latest/tutorial.html">https://django-mongodb-engine.readthedocs.org/en/latest/tutorial.html</a></li>
<li><a href="https://github.com/vpulim/mango">https://github.com/vpulim/mango</a></li>
<li><a href="https://www.safaribooksonline.com/library/view/mongodb-and-python/9781449312817/ch04s03.html">https://www.safaribooksonline.com/library/view/mongodb-and-python/9781449312817/ch04s03.html</a></li>
</ul>
<h2></h2>
<p>¡Haz tu donativo!
Si te gustó el artículo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
dirección: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el código QR desde la billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"></p>
            </div>
            <div class="post_list">
                <span>By </span>
                <a href="https://ecrespo.github.io/author/ernesto-crespo.html">@Ernesto Crespo</a>
                <span> in </span>
                <span class="post_category"><a href="https://ecrespo.github.io/category/tutorial-python.html" rel="bookmark"
                                               title="Permalink to Tutorial Python">[ Tutorial Python ]</a></span>
                <span class="post_date">jue 14 mayo 2015</span>
                <div><span>Tags : </span>
                            <span><a href="https://ecrespo.github.io/tag/canaima.html">#Canaima, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/debian.html">#Debian, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/python.html">#Python, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/ubuntu.html">#Ubuntu, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/mongodb.html">#Mongodb, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/django.html">#Django, </a></span>
                </div>

                <div class="entry-social">
                    <span class="twitter"><a target="_blank" rel="nofollow"
                                             onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;"
                                             title="Twitter"
                                             href="https://twitter.com/share?url=https://ecrespo.github.io/usar-mongodb-en-django.html&text=Usar mongodb en Django&via="><img
                            src="https://ecrespo.github.io/theme/images/icons/twitter-s.png"></a></span>

                    <span class="gplus"><a target="_blank" title="Google +"
                                           href="https://plus.google.com/share?url=https://ecrespo.github.io/usar-mongodb-en-django.html&hl=fr"
                                           rel="nofollow"
                                           onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/google-s.png"></a></span>

                    <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow"
                                              onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;"
                                              href="https://www.facebook.com/sharer.php?u=https://ecrespo.github.io/usar-mongodb-en-django.html&t=Usar mongodb en Django"><img
                            src="https://ecrespo.github.io/theme/images/icons/facebook-s.png"></a></span>

                    <a target="_blank" title="Linkedin"
                       href="https://www.linkedin.com/shareArticle?mini=true&url=https://ecrespo.github.io/usar-mongodb-en-django.html&title=Usar mongodb en Django"
                       rel="nofollow"
                       onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/linkedin-s.png"></a>

                    <span class="mail"><a
                            href="mailto:?subject=Usar mongodb en Django&amp;body=Viens découvrir un article à propos de [Usar mongodb en Django] sur le site de Ernesto Crespo. https://ecrespo.github.io/usar-mongodb-en-django.html"
                            title="Share by Email" target="_blank"><img
                            src="https://ecrespo.github.io/theme/images/icons/mail-s.png"></a></span>
                </div>
            </div>
                <div class="comments">
                    <h2>Comments !</h2>
                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_identifier = "usar-mongodb-en-django.html";
                        (function () {
                            var dsq = document.createElement('script');
                            dsq.type = 'text/javascript';
                            dsq.async = true;
                            dsq.src = 'https://https://seraphto.disqus.com.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] ||
                            document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                </div>
        </article>
    </section>
</article>

<!-- Footer -->
    <footer>
        <p>
            Blog powered by <a href="http://getpelican.com/">Pelican</a>,
            which takes great advantage of <a href="http://python.org">Python</a>.
            Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a
                href="https://parbhatpuri.com/">@parbhat</a>.
        </p>
    </footer>

    <!-- Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-131517246-1']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>

</body>
</html>