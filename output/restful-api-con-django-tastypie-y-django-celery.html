<!doctype html>
<html lang="es" itemscope itemtype="http://schema.org/Person">
<head>
            <meta charset="utf-8">
        <!-- Site Meta Data -->
        <title>Restful API con Django-tastypie y Django-Celery</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Ernesto Crespo">

        <link rel="shortcut icon" href="">

        <!-- schema.org -->
        <meta itemprop="name" content="Página de Seraph">
        <meta itemprop="image" content="">
        <meta itemprop="description" content="">

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
        <!-- Style Meta Data -->
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/style.css" type="text/css"/>
        <link rel="stylesheet" href="https://ecrespo.github.io/theme/css/pygments.css" type="text/css"/>

        <!-- Feed Meta Data -->
            <link href="https://ecrespo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="Página de Seraph ATOM Feed"/>

        <!-- Twitter Feed -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="">
        <meta name="twitter:image" content="">

    <meta name="twitter:creator" content="">
    <meta name="twitter:url" content="https://ecrespo.github.io/restful-api-con-django-tastypie-y-django-celery.html">
    <meta name="twitter:title" content="Página de Seraph ~ Restful API con Django-tastypie y Django-Celery">
    <meta name="twitter:description" content="Continuando con los artículos sobre django, en este caso se usará django-celery para envío de mensajes a un servidor kannel (servidor sms) y django-tastypie para mostrar el resultado por medio de API rest full con json. En los dos artículos anteriores Manejo de colas de RabbitMQ en django con django-celery …">

    <!-- Facebook Meta Data -->
    <meta property="og:title" content="Página de Seraph ~ Restful API con Django-tastypie y Django-Celery"/>
    <meta property="og:description" content="Continuando con los artículos sobre django, en este caso se usará django-celery para envío de mensajes a un servidor kannel (servidor sms) y django-tastypie para mostrar el resultado por medio de API rest full con json. En los dos artículos anteriores Manejo de colas de RabbitMQ en django con django-celery …"/>
    <meta property="og:image" content=""/>
</head>

<body>
<!-- Sidebar -->
<aside>
    <!--<center><a href="https://ecrespo.github.io"><img id="avatar" src=""></a></center>-->
    <h1>Página de Seraph</h1>
    <br>


    <nav class="nav">
        <ul class="list-bare">

                <li><a class="nav__link" href="/archives.html">Archives</a></li>
                <li><a class="nav__link" href="/categories.html">Categories</a></li>
                <li><a class="nav__link" href="/tags.html">Tags</a></li>

                <li><a class="nav__link" href="https://ecrespo.github.io/pages/About.html">Acerca</a></li>
                <li><a class="nav__link" href="https://ecrespo.github.io/pages/Contacto.html">Contacto</a></li>

        </ul>
    </nav>

    <p class="social">
                <a href="https://medium.com/@_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/medium.png"></a>
                <a href="http://ve.linkedin.com/in/ernestocrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/linkedin.png"></a>
                <a href="https://github.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/github.png"></a>
                <a href="https://google.com/+ErnestoCrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/google.png"></a>
                <a href="https://twitter.com/_seraph1" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/twitter.png"></a>
                <a href="https://www.facebook.com/ernesto.crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/facebook.png"></a>
                <a href="https://gitlab.com/ecrespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/gitlab.png"></a>
                <a href="https://soundcloud.com/ernesto-crespo" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/soundcloud.png"></a>
                <a href="//www.seraph.to/feeds/all.atom.xml" target="_blank"><img
                        src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
            <a href="https://ecrespo.github.io/feeds/all.atom.xml" rel="alternate">
                <img src="https://ecrespo.github.io/theme/images/icons/rss.png"></a>
    </p>

        <h2>Categories</h2>
        <ul class="navbar">
                <li><a
                        href="https://ecrespo.github.io/category/accesibilidad.html">Accesibilidad</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncio.html">Anuncio</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/anuncios.html">Anuncios</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/aplicacion-android.html">Aplicación Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/asterisk-debian-linux.html">Asterisk, Debian, Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla.html">Charla</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/charla-python.html">Charla Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-linux-mac-book.html">Debian, Linux, Mac Book</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/debian-maemo-nokia-n810-python.html">Debian, maemo, Nokia N810, Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/demostracion-aplicacion-para-android.html">Demostración Aplicación para Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/desarrollomovil.html">Desarrollo,Movil</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/evento.html">Evento</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/general.html">General</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linux.html">Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdebian.html">Linux,Debian</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxdesarrollo.html">Linux,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxempaquetado.html">Linux,Empaquetado</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/linuxofimaticadesarrollo.html">Linux,Ofimatica,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/movil-nokia.html">Movil, Nokia</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810.html">Nokia N810</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/nokia-n810-debian-maemo.html">Nokia N810 Debian Maemo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/posts.html">posts</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/resumen-2010.html">Resumen 2010</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/sistemas-operativos.html">Sistemas Operativos</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial.html">Tutorial</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-android.html">Tutorial Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-arduino.html">Tutorial de Arduino</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-data-science.html">Tutorial de Data Science</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-docker.html">Tutorial de Docker</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-integracion-continua.html">Tutorial de integración continua</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-linux.html">Tutorial de Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python.html">Tutorial de Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-en-android.html">Tutorial de Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-linux.html">Tutorial de Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-de-python-y-pyqt.html">Tutorial de Python y PyQt</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-debian-bsd-y-python.html">Tutorial Debian BSD y Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux.html">Tutorial Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-linux-y-python.html">Tutorial Linux y Python</a></li>
                <li class="active"><a
                        href="https://ecrespo.github.io/category/tutorial-python.html">Tutorial Python</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-en-android.html">Tutorial Python en Android</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorial-python-y-linux.html">Tutorial Python y Linux</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/tutorialdesarrollo.html">Tutorial,Desarrollo</a></li>
                <li><a
                        href="https://ecrespo.github.io/category/xml-rpcpython.html">XML-RPC,Python</a></li>
        </ul>


</aside>

<!-- Content -->
<article>
    <section id="content">
        <article>
            <h2 class="post_title post_detail"><a href="https://ecrespo.github.io/restful-api-con-django-tastypie-y-django-celery.html" rel="bookmark"
                                                  title="Permalink to Restful API con Django-tastypie y Django-Celery">Restful API con Django-tastypie y Django-Celery</a></h2>
            <div class="entry-content blog-post">
                <p>Continuando con los artículos sobre django, en este caso se usará <code>django-celery</code> para envío de mensajes a un servidor kannel (servidor sms) y django-tastypie para mostrar el resultado por medio de API rest full con json.
En los dos artículos anteriores <a href="https://www.seraph.to/manejo-de-colas-de-rabbitmq-en-django-con-django-celery.html#manejo-de-colas-de-rabbitmq-en-django-con-django-celery">Manejo de colas de RabbitMQ en django con django-celery</a> y 
<a href="https://www.seraph.to/restful-api-con-django-tastypie.html#restful-api-con-django-tastypie">Restfult API con django tastypie</a> se tiene la base de este artículo. Este artículo se basa en el ejemplo de la mensajería sms del artículo de <a href="http://blog.crespo.org.ve/2014/05/restful-api-con-django-tastypie.html">Restfult API con django tastypie</a> (todo el proceso de creación del proyecto y de la aplicación sms fue explicada en ese artículo).</p>
<p>La idea ahora es poder mostrar los sms listados por evento, no es necesario estar creando una tabla que herede de las otras dos, esto será posible gracias a tastypie en una consulta del json.</p>
<p>Se usará como base de datos sqlite3. A continuación se muestra el archivo <code>settings.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Archivo settings.py:</span>
<span class="c1">#Configuración de la base de datos sqlite3</span>
<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span> <span class="c1"># Add &#39;postgresql_psycopg2&#39;, &#39;mysql&#39;, &#39;sqlite3&#39; or &#39;oracle&#39;.</span>
        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;sms.db&#39;</span><span class="p">,</span>                      <span class="c1"># Or path to database file if using sqlite3.</span>
        <span class="s1">&#39;USER&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>                      <span class="c1"># Not used with sqlite3.</span>
        <span class="s1">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>                  <span class="c1"># Not used with sqlite3.</span>
        <span class="s1">&#39;HOST&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>                      <span class="c1"># Set to empty string for localhost. Not used with sqlite3.</span>
        <span class="s1">&#39;PORT&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>                      <span class="c1"># Set to empty string for default. Not used with sqlite3.</span>
    <span class="p">}</span>
<span class="p">}</span>





<span class="c1">#Zona horaria y localización</span>


<span class="n">TIME_ZONE</span> <span class="o">=</span> <span class="s1">&#39;America/Caracas&#39;</span>

<span class="n">LANGUAGE_CODE</span> <span class="o">=</span> <span class="s1">&#39;es-ve&#39;</span> 

<span class="c1">#Aplicaciones instaladas (djcelery,pasarela.apps.sms,tastypie y south)</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sites&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
    <span class="c1"># Uncomment the next line to enable the admin:</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;djcelery&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pasarela.apps.sms&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tastypie&#39;</span><span class="p">,</span>
    <span class="s1">&#39;south&#39;</span><span class="p">,</span>
    <span class="c1"># Uncomment the next line to enable admin documentation:</span>
    <span class="c1"># &#39;django.contrib.admindocs&#39;,</span>
<span class="p">)</span>


<span class="c1">#Conexión al servidor kannel </span>
<span class="n">direccion</span> <span class="o">=</span> <span class="s2">&quot;127.0.0.1&quot;</span>
<span class="n">portsms</span> <span class="o">=</span> <span class="s2">&quot;13013&quot;</span>
<span class="n">portadmin</span>  <span class="o">=</span> <span class="s2">&quot;13000&quot;</span>
<span class="n">usuario</span> <span class="o">=</span> <span class="s2">&quot;kannel&quot;</span>
<span class="n">clave</span> <span class="o">=</span> <span class="s2">&quot;kannel&quot;</span>
<span class="o">----------------------</span>
</code></pre></div>

<p>El archivo <code>pasarela/apps/sms/models.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Archivo pasarela/apps/sms/models.py</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="c1">#Se crea la tabla Evento que contiene los campos evento (número del evento), el estatus del mismo (si se #termino el evento o no y si no termino fue por falla o no.</span>
<span class="k">class</span> <span class="nc">Evento</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">evento</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">estatus</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="n">evento</span> <span class="o">=</span> <span class="s2">&quot;Evento: </span><span class="si">%s</span><span class="s2">, Estatus: </span><span class="si">%s</span><span class="s2"> , Falla: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evento</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">estatus</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">falla</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">evento</span>

<span class="c1">#Se crea la tabla HistoricoSMS donde se tiene un campo</span>
<span class="c1">#foreignkey de la tablla evento, el mensaje, el número de celular, el estatus si se envío o no o si fallo.</span>
<span class="k">class</span> <span class="nc">HistoricoSMS</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">evento</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Evento</span><span class="p">)</span>
    <span class="n">mensaje</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">numcel</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">estatus</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mensaje</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span>  <span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evento</span><span class="o">.</span><span class="n">evento</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">numcel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">estatus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mensaje</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">falla</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mensaje</span>
<span class="o">--------------------</span>
</code></pre></div>

<p>Archivo <code>pasarela/apps/sms/admin.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Archivo pasarela/apps/sms/admin.py</span>
<span class="c1">#En este archivo se define que las tablas Evento e HistoricoSMS se puedan visualizar desde la #administración de django.</span>
<span class="kn">from</span> <span class="nn">django.contrib</span>  <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">pasarela.apps.sms.models</span> <span class="kn">import</span> <span class="n">HistoricoSMS</span><span class="p">,</span><span class="n">Evento</span>


<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">HistoricoSMS</span><span class="p">)</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Evento</span><span class="p">)</span>
</code></pre></div>

<p>Archivo <code>pasarela/apps/sms/api.py</code> (archivo para crear el api restful de django-tastypie), en este caso tiene varias modificaciones con respecto al artículo anterior sobre tastypie, ahora se agrega la variable filtering(más información sobre filtering en el siguiente <a href="https://django-tastypie.readthedocs.io/en/latest/resources.html">enlace</a>) que es un diccionario en cada recurso:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Se importa de tastypie.resources ModelResource, ALL y ALL_WITH_RELATIONS</span>
<span class="kn">from</span> <span class="nn">tastypie.resources</span> <span class="kn">import</span> <span class="n">ModelResource</span><span class="p">,</span> <span class="n">ALL</span><span class="p">,</span> <span class="n">ALL_WITH_RELATIONS</span>
<span class="c1">#Se importa del modelo HistoricoSMS y Evento</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">HistoricoSMS</span><span class="p">,</span><span class="n">Evento</span>
<span class="c1">#Se importa fields de tastypie</span>
<span class="kn">from</span> <span class="nn">tastypie</span> <span class="kn">import</span> <span class="n">fields</span>


<span class="k">class</span> <span class="nc">EventoResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">queryset</span> <span class="o">=</span><span class="n">Evento</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;evento&#39;</span>
<span class="c1">#Se muestra todos los eventos</span>
        <span class="n">filtering</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;evento&#39;</span><span class="p">:</span> <span class="n">ALL</span><span class="p">,</span>
        <span class="p">}</span>


<span class="k">class</span> <span class="nc">SMSResource</span><span class="p">(</span><span class="n">ModelResource</span><span class="p">):</span>
    <span class="n">evento</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">EventoResource</span><span class="p">,</span> <span class="s1">&#39;evento&#39;</span><span class="p">)</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">HistoricoSMS</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">resource_name</span> <span class="o">=</span> <span class="s1">&#39;sms&#39;</span>
<span class="c1">#De evento se muestra todo con relación a el. de estatus se muestra exactamente lo que se necesita,</span>
<span class="c1">#acá también se puede usar para las consultas: [&#39;exact&#39;, &#39;range&#39;, &#39;gt&#39;, &#39;gte&#39;, &#39;lt&#39;, &#39;lte&#39;].</span>
        <span class="n">filtering</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;evento&#39;</span><span class="p">:</span> <span class="n">ALL_WITH_RELATIONS</span><span class="p">,</span>
            <span class="s1">&#39;estatus&#39;</span><span class="p">:[</span><span class="s1">&#39;exact&#39;</span><span class="p">],</span>
        <span class="p">}</span>
<span class="o">------------------------</span>
</code></pre></div>

<p>El archivo que permite manejar las tareas de celery <code>pasarela/apps/sms/tasks.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Archivo pasarela/apps/sms/tasks.py</span>
<span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">Celery</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">&#39;tasks&#39;</span><span class="p">,</span> <span class="n">broker</span><span class="o">=</span><span class="s1">&#39;amqp://&#39;</span><span class="p">,</span><span class="n">backend</span><span class="o">=</span><span class="s1">&#39;amqp&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">urlencode</span>
<span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">pasarela.apps.sms.models</span> <span class="kn">import</span> <span class="n">HistoricoSMS</span><span class="p">,</span><span class="n">Evento</span>



<span class="c1">#Conexión al servidor kannel (está configuración se puede pasar al archivo settings.py y usarla desde allí</span>
<span class="n">direccion</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">direccion</span>
<span class="n">portsms</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">portsms</span>
<span class="n">portadmin</span>  <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">portadmin</span>
<span class="n">usuario</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">usuario</span>
<span class="n">clave</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">clave</span>

<span class="c1">#Se define una tarea para celery por medio del decorador @task, se recibe un json para luego sea</span>
<span class="c1"># procesado.</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<span class="k">def</span> <span class="nf">RecNums</span><span class="p">(</span><span class="n">datos</span><span class="p">):</span>
    <span class="c1">#Se toma el json y se convierte en un diccionario</span>
    <span class="n">diccionario</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
    <span class="c1">#Se instancia la clave Evento(tabla Evento).</span>
    <span class="n">evento</span> <span class="o">=</span> <span class="n">Evento</span><span class="p">()</span>
    <span class="c1">#Se asigna cada variable del diccionario para trabajarlos directamente</span>
    <span class="k">for</span> <span class="n">clave</span> <span class="ow">in</span> <span class="n">diccionario</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">clave</span> <span class="o">==</span> <span class="s1">&#39;mensaje&#39;</span><span class="p">:</span>
            <span class="n">mensaje</span> <span class="o">=</span> <span class="n">diccionario</span><span class="p">[</span><span class="n">clave</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">clave</span> <span class="o">==</span> <span class="s1">&#39;numeros&#39;</span><span class="p">:</span>
            <span class="n">numeros</span> <span class="o">=</span> <span class="n">diccionario</span><span class="p">[</span><span class="n">clave</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">clave</span> <span class="o">==</span> <span class="s1">&#39;cantnumeros&#39;</span><span class="p">:</span>
            <span class="n">cantnum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">diccionario</span><span class="p">[</span><span class="n">clave</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">clave</span> <span class="o">==</span> <span class="s1">&#39;evento&#39;</span><span class="p">:</span>
            <span class="n">eventoid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">diccionario</span><span class="p">[</span><span class="n">clave</span><span class="p">])</span>
    <span class="c1">#Se crea una lista para agregar todos los números de celular a dicha lista</span>
    <span class="n">lista</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">numeros</span><span class="p">:</span> <span class="n">lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
    <span class="c1">#A evento.evento se le asigna el id del evento.</span>
    <span class="n">evento</span><span class="o">.</span><span class="n">evento</span> <span class="o">=</span> <span class="n">eventoid</span>
    <span class="c1">#Si la lista es distinta a la variable cantnum se envía un mensaje de error, si no se procesa la lista</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">)</span> <span class="o">==</span> <span class="n">cantnum</span><span class="p">:</span>
        <span class="c1">#Se envía al proceso Enviar (de celery) cada mensaje con su número celular, esperando un segundo </span>
        <span class="c1">#para procesar el siguiente.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lista</span><span class="p">)):</span>
            <span class="c1">#Se Envía el mensaje pasando el evento, el número celular de la lista y el mensaje</span>
            <span class="n">resultado</span> <span class="o">=</span> <span class="n">Enviar</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">evento</span><span class="p">,</span><span class="n">lista</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mensaje</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">#Se asigna True al estatus del evento al terminar de procesar los mensajes.</span>
        <span class="n">evento</span><span class="o">.</span><span class="n">estatus</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1">#Se salva los valores en la tabla Evento.</span>
        <span class="n">evento</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;Se enviaron: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">cantnum</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">evento</span><span class="o">.</span><span class="n">estatus</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">evento</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;Error en la recepcion de los datos&quot;</span>


<span class="c1">#Se crea la tarea de celery Enviar donde recibe el número del evento, el número de celular y la cantidad de </span>
<span class="c1">#intentos para enviar el sms el valor por defecto es 5.</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<span class="k">def</span> <span class="nf">Enviar</span><span class="p">(</span><span class="n">evento</span><span class="p">,</span><span class="n">numcel</span><span class="p">,</span><span class="n">mensaje</span><span class="p">,</span><span class="n">intentos</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="c1">#Se instancia la clase HistoricoSMS que maneja dicha table de models.py</span>
    <span class="n">historico</span> <span class="o">=</span> <span class="n">HistoricoSMS</span><span class="p">()</span>
    <span class="c1">#Se le da forma de códificación url al mensaje para eliminar los espacios en blanco del mismo.</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">({</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">mensaje</span><span class="p">})</span>
    <span class="c1">#se define la variable Url donde se tiene el url del servidor kannel donde se le pasa al texto</span>
    <span class="c1">#el usuario, la clave, el número celular y el mensaje a enviar.</span>
    <span class="n">Url</span> <span class="o">=</span> <span class="s2">&quot;http://</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">/cgi-bin/sendsms?username=</span><span class="si">%s</span><span class="s2">&amp;password=</span><span class="si">%s</span><span class="s2">&amp;to=</span><span class="si">%s</span><span class="s2">&amp;text=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">direccion</span><span class="p">,</span><span class="n">portsms</span><span class="p">,</span><span class="n">usuario</span><span class="p">,</span><span class="n">clave</span><span class="p">,</span><span class="n">numcel</span><span class="p">,</span><span class="n">form</span><span class="p">)</span>
    <span class="c1">#Se maneja una excepción si hay un error de comunicación http.</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="c1">#Se abre el Url</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">Url</span><span class="p">,</span><span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="c1">#Se asigna los valores numcel, mensaje y evento al objeto historico.</span>
        <span class="n">historico</span><span class="o">.</span><span class="n">numcel</span> <span class="o">=</span> <span class="n">numcel</span>
        <span class="n">historico</span><span class="o">.</span><span class="n">mensaje</span> <span class="o">=</span> <span class="n">mensaje</span>
        <span class="n">historico</span><span class="o">.</span><span class="n">evento</span> <span class="o">=</span> <span class="n">evento</span>
        <span class="c1">#Se lee el resultado de abrir el url, si se tiene el mensaje  de encolado para enviar más tarde</span>
        <span class="c1">#se asigna el estatus False y se salva devolviendo el mensaje de no enviado </span>
        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">&lt;&gt;</span> <span class="s1">&#39;3: Queued for later delivery&#39;</span><span class="p">:</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">estatus</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span> <span class="s1">&#39;Mensaje no enviado a: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="n">numcel</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#Se envío el mensaje se coloca el estatus en True y se salva en la tabla</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">estatus</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="c1">#Se devuelve el mensaje de mensaje enviado.</span>
            <span class="k">return</span> <span class="s1">&#39;Mensaje enviado a: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="n">numcel</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span><span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">),</span><span class="n">exc</span><span class="p">:</span>
    <span class="c1">#Si hay una excepción de error http se reintenta el envío llamando de forma </span>
    <span class="c1">#concurrente a esta misma función reduciendo el valor de los intentos, </span>
    <span class="c1">#cuando llegue a cero el número de intentos se devuelve un mensaje de no enviado </span>
        <span class="k">if</span> <span class="n">intentos</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Enviar</span><span class="p">(</span><span class="n">evento</span><span class="p">,</span><span class="n">numcel</span><span class="p">,</span><span class="n">mensaje</span><span class="p">,</span><span class="n">intentos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#Se salva los valores en la tabla y devuelve el mensaje de sms no enviado</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">numcel</span> <span class="o">=</span> <span class="n">numcel</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">mensaje</span> <span class="o">=</span> <span class="n">mensaje</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">evento</span> <span class="o">=</span> <span class="n">evento</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">estatus</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">historico</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="k">return</span><span class="s1">&#39;No hay conexion al kannel por puerto o IP, el numero que no se procesaron es: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="n">numcel</span>
<span class="o">----------------------------</span>
</code></pre></div>

<p>A continuación se muestra el contenido del archivo pasarela/urls.py el cual contiene el acceso al API como se explico en el artículo anterior y ahora tiene el acceso a la función que permite recibir los datos para enviar (estos datos se pasan por un json):</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Archivo pasarela/urls.py</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">djcelery</span> <span class="kn">import</span> <span class="n">views</span> <span class="k">as</span> <span class="n">celery_views</span>
<span class="kn">from</span> <span class="nn">pasarela.apps.sms</span> <span class="kn">import</span> <span class="n">tasks</span>

<span class="c1"># Uncomment the next two lines to enable the admin:</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="n">admin</span><span class="o">.</span><span class="n">autodiscover</span><span class="p">()</span>

<span class="c1">#Se importa Api de tastypie.api</span>
<span class="kn">from</span> <span class="nn">tastypie.api</span> <span class="kn">import</span> <span class="n">Api</span>
<span class="kn">from</span> <span class="nn">apps.sms.api</span> <span class="kn">import</span> <span class="n">SMSResource</span><span class="p">,</span><span class="n">EventoResource</span>

<span class="n">v1_api</span> <span class="o">=</span> <span class="n">Api</span><span class="p">(</span><span class="n">api_name</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">)</span>
<span class="c1">#Se registra los recursos en la instancia del api.</span>
<span class="n">v1_api</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">SMSResource</span><span class="p">())</span>
<span class="n">v1_api</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">EventoResource</span><span class="p">())</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="c1"># Uncomment the next line to enable the admin:</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
    <span class="c1">#Acceso al API</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^api/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">v1_api</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
    <span class="c1">#se define enviar que usa la vista de tareas de celery para ejecutar tasks.RecNums</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^enviar/&#39;</span><span class="p">,</span> <span class="n">celery_views</span><span class="o">.</span><span class="n">task_view</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">RecNums</span><span class="p">)),</span>
    <span class="c1">#Consulta a celery si la tarea se ejecuto sin problemas</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;task_id&gt;[\w\d\-]+)/done/?$&#39;</span><span class="p">,</span> <span class="n">celery_views</span><span class="o">.</span><span class="n">is_task_successful</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;celery-is_task_successful&quot;</span><span class="p">),</span>
    <span class="c1">#Consulta de celery para ver el estatus de la tarea</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;task_id&gt;[\w\d\-]+)/status/?$&#39;</span><span class="p">,</span> <span class="n">celery_views</span><span class="o">.</span><span class="n">task_status</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;celery-task_status&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="o">-----------------------</span>
</code></pre></div>

<p>La base de datos se sincroniza como se explicó en los artículos anteriores, ahora toca ejecutar en modo pruba django-celery, django como tal y abrir un interprete de comandos para django.</p>
<p>Ejecución de django-celery con dos colas de rabbitMQ y en modo info:</p>
<div class="highlight"><pre><span></span><code><span class="err">python manage.py celeryd -E -l info -c 2</span>
</code></pre></div>

<p>A continuación captura de pantalla de la ejecución:</p>
<p><img alt="" src="./images/restfulapicondjangotastypieydjangocelery-1.png"></p>
<p>Note que se tienen 2 tareas en el <code>celery</code>:
- pasarela.apps.sms.tasks.Enviar
- pasarela.apps.sms.tasks.RecNums
Ahora se ejecuta django en el 127.0.0.1 y puerto 8080:
python manage.py runserver 127.0.0.1:8080
A continuación una captura de pantalla de la ejecución del comando:</p>
<p><img alt="" src="./images/restfulapicondjangotastypieydjangocelery-2.png"></p>
<p>Y por último se ejecuta el comando para tener un shell interfactivo de django:
python manage.py shell
A continuación la captura de pantalla: </p>
<p><img alt="" src="./images/restfulapicondjangotastypieydjangocelery-3.png"></p>
<p>Ahora se ejecutará en el shell una prueba que simula la recepción por parte de la tarea del json que recibe de una aplicación externa para enviar los sms:
Hay que acotar que los números de celular de la prueba no corresponden a números  reales o de proveedores de teléfonía celular.</p>
<p><img alt="" src="./images/restfulapicondjangotastypieydjangocelery-4.png"></p>
<p>Ahora para complementar la idea de consulta API restful por json del artículo anterior la idea es listar los números celulares que se enviaron del evento 6, en este caso se usará el programa curl:
curl http://127.0.0.1:8080/api/v1/sms/?evento=6
El resultado es:</p>
<div class="highlight"><pre><span></span><code><span class="err">{&quot;meta&quot;: {&quot;limit&quot;: 20, &quot;next&quot;: null, &quot;offset&quot;: 0, &quot;previous&quot;: null, &quot;total_count&quot;: 5}, &quot;objects&quot;: [{&quot;estatus&quot;:true, &quot;evento&quot;: &quot;/api/v1/evento/6/&quot;, &quot;id&quot;: &quot;21&quot;, &quot;mensaje&quot;: &quot;Esta es una prueba de sms&quot;, &quot;numcel&quot;: &quot;14225673531&quot;, &quot;resource_uri&quot;: &quot;/api/v1/sms/21/&quot;}, {&quot;estatus&quot;:true, &quot;evento&quot;: &quot;/api/v1/evento/6/&quot;,&quot;id&quot;: &quot;22&quot;, &quot;mensaje&quot;: &quot;Esta es una prueba de sms&quot;, &quot;numcel&quot;: &quot;142165673531&quot;, &quot;resource_uri&quot;: &quot;/api/v1/sms/22/&quot;}, {&quot;estatus&quot;: true, &quot;evento&quot;: &quot;/api/v1/evento/6/&quot;,&quot;id&quot;: &quot;23&quot;, &quot;mensaje&quot;: &quot;Esta es una prueba de sms&quot;, &quot;numcel&quot;: &quot;14265673531&quot;, &quot;resource_uri&quot;: &quot;/api/v1/sms/23/&quot;}, {&quot;estatus&quot;: true, &quot;evento&quot;: &quot;/api/v1/evento/6/&quot;, &quot;id&quot;: &quot;24&quot;, &quot;mensaje&quot;: &quot;Esta es una prueba de sms&quot;, &quot;numcel&quot;: &quot;14145673531&quot;, &quot;resource_uri&quot;: &quot;/api/v1/sms/24/&quot;}, {&quot;estatus&quot;: true, &quot;evento&quot;: &quot;/api/v1/evento/6/&quot;,&quot;id&quot;: &quot;25&quot;, &quot;mensaje&quot;: &quot;Esta es una prueba de sms&quot;, &quot;numcel&quot;: &quot;14245673531&quot;, &quot;resource_uri&quot;: &quot;/api/v1/sms/25/&quot;}]}</span>
</code></pre></div>

<p>Por último se muestra la captura de pantalla de lo que se genera en el <code>djcelery</code>:</p>
<p><img alt="" src="./images/restfulapicondjangotastypieydjangocelery-5.png"></p>
<p>En el próximo artículo se mostrará el acceso a las tareas de <code>celery</code> desde el URL definido en <code>urls.py</code>.</p>
<h2></h2>
<p>¡Haz tu donativo!
Si te gustó el artículo puedes realizar un donativo con Bitcoin (BTC)
usando la billetera digital de tu preferencia a la siguiente
dirección: 17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV</p>
<p>O Escaneando el código QR desde la billetera:</p>
<p><img alt="17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV" src="./images/17MtNybhdkA9GV3UNS6BTwPcuhjXoPrSzV.png"></p>
            </div>
            <div class="post_list">
                <span>By </span>
                <a href="https://ecrespo.github.io/author/ernesto-crespo.html">@Ernesto Crespo</a>
                <span> in </span>
                <span class="post_category"><a href="https://ecrespo.github.io/category/tutorial-python.html" rel="bookmark"
                                               title="Permalink to Tutorial Python">[ Tutorial Python ]</a></span>
                <span class="post_date">sáb 19 julio 2014</span>
                <div><span>Tags : </span>
                            <span><a href="https://ecrespo.github.io/tag/canaima.html">#Canaima, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/debian.html">#Debian, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/general.html">#General, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/linux.html">#Linux, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/python.html">#Python, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/ubuntu.html">#Ubuntu, </a></span>
                            <span><a href="https://ecrespo.github.io/tag/django.html">#Django, </a></span>
                </div>

                <div class="entry-social">
                    <span class="twitter"><a target="_blank" rel="nofollow"
                                             onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;"
                                             title="Twitter"
                                             href="https://twitter.com/share?url=https://ecrespo.github.io/restful-api-con-django-tastypie-y-django-celery.html&text=Restful API con Django-tastypie y Django-Celery&via="><img
                            src="https://ecrespo.github.io/theme/images/icons/twitter-s.png"></a></span>

                    <span class="gplus"><a target="_blank" title="Google +"
                                           href="https://plus.google.com/share?url=https://ecrespo.github.io/restful-api-con-django-tastypie-y-django-celery.html&hl=fr"
                                           rel="nofollow"
                                           onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/google-s.png"></a></span>

                    <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow"
                                              onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;"
                                              href="https://www.facebook.com/sharer.php?u=https://ecrespo.github.io/restful-api-con-django-tastypie-y-django-celery.html&t=Restful API con Django-tastypie y Django-Celery"><img
                            src="https://ecrespo.github.io/theme/images/icons/facebook-s.png"></a></span>

                    <a target="_blank" title="Linkedin"
                       href="https://www.linkedin.com/shareArticle?mini=true&url=https://ecrespo.github.io/restful-api-con-django-tastypie-y-django-celery.html&title=Restful API con Django-tastypie y Django-Celery"
                       rel="nofollow"
                       onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="https://ecrespo.github.io/theme/images/icons/linkedin-s.png"></a>

                    <span class="mail"><a
                            href="mailto:?subject=Restful API con Django-tastypie y Django-Celery&amp;body=Viens découvrir un article à propos de [Restful API con Django-tastypie y Django-Celery] sur le site de Ernesto Crespo. https://ecrespo.github.io/restful-api-con-django-tastypie-y-django-celery.html"
                            title="Share by Email" target="_blank"><img
                            src="https://ecrespo.github.io/theme/images/icons/mail-s.png"></a></span>
                </div>
            </div>
                <div class="comments">
                    <h2>Comments !</h2>
                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_identifier = "restful-api-con-django-tastypie-y-django-celery.html";
                        (function () {
                            var dsq = document.createElement('script');
                            dsq.type = 'text/javascript';
                            dsq.async = true;
                            dsq.src = 'https://https://seraphto.disqus.com.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] ||
                            document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                </div>
        </article>
    </section>
</article>

<!-- Footer -->
    <footer>
        <p>
            Blog powered by <a href="http://getpelican.com/">Pelican</a>,
            which takes great advantage of <a href="http://python.org">Python</a>.
            Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a
                href="https://parbhatpuri.com/">@parbhat</a>.
        </p>
    </footer>

    <!-- Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-131517246-1']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>

</body>
</html>